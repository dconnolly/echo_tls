PROTOCOL generated_models/privacy_client_ech_SCENARIO3.pv
Biprocess 0 (that is, the initial process):
{1}let tls_h: hash_alg = id_hash(StrongHash,1) in
{2}let tls_a: aead_alg = id_aead(StrongAE,1) in
{3}let tls_g: group = id_g(StrongDH,1) in
{4}let ech_h: hash_alg = id_hash(StrongHash,2) in
{5}let ech_a: aead_alg = id_aead(StrongAE,2) in
{6}let ech_g: group = id_g(StrongDH,2) in
(
    {7}!
    {8}in(ch_client_CFIN, (id_client: idProc,cr: bytes32,sr: bytes32,h_alg: hash_alg,a_alg: aead_alg,psk: preSharedKey,s_pkey: pubkey,c_pkey: pubkey,master_secret: bitstring,chk: aead_key,shk: aead_key,cfin: mac_key,sfin: mac_key,cur_log: bitstring));
    {9}let l: label = tls13_client_application_traffic_secret in
    {10}let h: bitstring = catch-fail(hash(h_alg,cur_log)) in
    {11}let v: bool = not-caught-fail(h) in
    {12}let x: bitstring = (if v then (l,h) else caught-fail) in
    {13}let client_ats: bitstring = catch-fail((if v then hmac(h_alg,master_secret,x) else fail-any)) in
    {14}let v_1: bool = not-caught-fail(client_ats) in
    {15}let l_1: label = (if v_1 then tls13_server_application_traffic_secret else caught-fail) in
    {16}let h_1: bitstring = (if v_1 then catch-fail(hash(h_alg,cur_log)) else caught-fail) in
    {17}let v_2: bool = not-caught-fail(h_1) in
    {18}let x_1: bitstring = (if v_2 then (l_1,h_1) else caught-fail) in
    {19}let server_ats: bitstring = (if v_1 then catch-fail((if v_2 then hmac(h_alg,master_secret,x_1) else fail-any)) else caught-fail) in
    {20}let v_3: bool = not-caught-fail(server_ats) in
    {21}let l_2: label = (if v_3 then tls13_exporter_master_secret else caught-fail) in
    {22}let h_2: bitstring = (if v_3 then catch-fail(hash(h_alg,cur_log)) else caught-fail) in
    {23}let v_4: bool = not-caught-fail(h_2) in
    {24}let x_2: bitstring = (if v_4 then (l_2,h_2) else caught-fail) in
    {25}let ems: bitstring = (if v_3 then catch-fail((if v_4 then hmac(h_alg,master_secret,x_2) else fail-any)) else caught-fail) in
    {26}let v_5: bool = not-caught-fail(ems) in
    {27}let l_3: label = (if v_5 then tls13_key else caught-fail) in
    {28}let h_3: bitstring = (if v_5 then zero else caught-fail) in
    {29}let x_3: bitstring = (if v_5 then (l_3,h_3) else caught-fail) in
    {30}let client_wkad: bitstring = (if v_5 then catch-fail(hmac(h_alg,client_ats,x_3)) else caught-fail) in
    {31}let v_6: bool = not-caught-fail(client_wkad) in
    {32}let l_4: label = (if v_6 then tls13_key else caught-fail) in
    {33}let h_4: bitstring = (if v_6 then zero else caught-fail) in
    {34}let x_4: bitstring = (if v_6 then (l_4,h_4) else caught-fail) in
    {35}let server_wkad: bitstring = (if v_6 then catch-fail(hmac(h_alg,server_ats,x_4)) else caught-fail) in
    {36}let v_7: bool = not-caught-fail(server_wkad) in
    {37}let (cak: aead_key,sak: aead_key,ems_1: bitstring) = (if v_1 then (if v_3 then (if v_5 then (if v_6 then (if v_7 then (client_wkad,server_wkad,ems) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
    {38}let client_hash_msg: bitstring = hmac(h_alg,cfin,cur_log) in
    {39}let client_finished_msg: msg = FIN(client_hash_msg) in
    {40}let cur_log': bitstring = (cur_log,client_finished_msg) in
    {41}let l_5: label = tls13_resumption_master_secret in
    {42}let h_5: bitstring = catch-fail(hash(h_alg,cur_log')) in
    {43}let v_8: bool = not-caught-fail(h_5) in
    {44}let x_5: bitstring = (if v_8 then (l_5,h_5) else caught-fail) in
    {45}let rms: bitstring = (if v_8 then hmac(h_alg,master_secret,x_5) else fail-any) in
    {46}let enc_client_finished_msg: bitstring = aead_enc(a_alg,chk,zero,zero,client_finished_msg) in
    {47}out(io, enc_client_finished_msg);
    {48}event SanityClientCFIN(id_client,cr,sr,psk,master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,ems_1,rms,cur_log')
) | (
    {49}!
    {50}in(ch_client_FIN, (id_client_1: idProc,cr_1: bytes32,sr_1: bytes32,h_alg_1: hash_alg,a_alg_1: aead_alg,c_dom: domain,psk_1: preSharedKey,cert_req: bool,s_pkey_1: pubkey,master_secret_1: bitstring,chk_1: aead_key,shk_1: aead_key,cfin_1: mac_key,sfin_1: mac_key,cur_log_1: bitstring));
    {51}new st[]: bitstring;
    {52}event PreciseMess(ch_client_FIN,id_client_1,st,master_secret_1);
    {53}in(io, enc_finished_msg: bitstring);
    {54}let finished_msg: msg = aead_dec(a_alg_1,shk_1,zero,zero,enc_finished_msg) in
    (
        {55}let FIN(hash_msg: bitstring) = finished_msg in
        (
            {56}if (hash_msg = hmac(h_alg_1,sfin_1,cur_log_1)) then
            {57}let cur_log2: bitstring = (cur_log_1,finished_msg) in
            {58}if cert_req then
            (
                {70}get long_term_keys(c_dom': domain,sk: privkey,c_pkey_1: pubkey,crt: certificate) in
                {59}event Selected_lgt(c_dom',c_dom,sk,c_pkey_1,crt);
                {60}let certificate_msg: msg = CRT(zero,crt) in
                {61}let encrypted_certificate_msg: bitstring = aead_enc(a_alg_1,chk_1,zero,zero,certificate_msg) in
                {62}out(io, encrypted_certificate_msg);
                {63}let cur_log2_1: bitstring = (cur_log2,certificate_msg) in
                {64}let signed_log: bitstring = sign(sk,hash(h_alg_1,cur_log2_1)) in
                {65}let certificate_verify_msg: msg = CV(signed_log) in
                {66}let encrypted_certificate_verify_msg: bitstring = aead_enc(a_alg_1,chk_1,zero,zero,certificate_verify_msg) in
                {67}out(io, encrypted_certificate_verify_msg);
                {68}let cur_log3: bitstring = (cur_log2_1,certificate_verify_msg) in
                {69}out(ch_client_CFIN, (id_client_1,cr_1,sr_1,h_alg_1,a_alg_1,NoPSK,s_pkey_1,c_pkey_1,master_secret_1,chk_1,shk_1,cfin_1,sfin_1,cur_log3))
            )
            else
                {71}out(ch_client_CFIN, (id_client_1,cr_1,sr_1,h_alg_1,a_alg_1,psk_1,s_pkey_1,NoPubKey,master_secret_1,chk_1,shk_1,cfin_1,sfin_1,cur_log2))
        )
        else
            {72}out(io, unexpected_message)
    )
    else
        {73}out(io, bad_record_mac)
) | (
    {74}!
    {75}in(ch_client_CRT, (id_client_2: idProc,cr_2: bytes32,sr_2: bytes32,h_alg_2: hash_alg,a_alg_2: aead_alg,c_dom_1: domain,s_dom: domain,psk_2: preSharedKey,cert_req_1: bool,master_secret_2: bitstring,chk_2: aead_key,shk_2: aead_key,cfin_2: mac_key,sfin_2: mac_key,cur_log_2: bitstring,certificate_msg_1: msg));
    {76}let CRT(=zero,crt_1: certificate) = certificate_msg_1 in
    {77}let cur_log2_2: bitstring = (cur_log_2,certificate_msg_1) in
    {78}in(io, enc_crt_verif_msg: bitstring);
    {79}let certificate_verify_msg_1: msg = aead_dec(a_alg_2,shk_2,zero,zero,enc_crt_verif_msg) in
    {80}let CV(signed_log_1: bitstring) = certificate_verify_msg_1 in
    {81}if (verify(get_pkey(crt_1),hash(h_alg_2,cur_log2_2),signed_log_1) && ((get_domain(crt_1) = s_dom) && verify_cert(crt_1))) then
    {82}let s_pkey_2: pubkey = get_pkey(crt_1) in
    {83}let cur_log3_1: bitstring = (cur_log2_2,certificate_verify_msg_1) in
    {84}out(ch_client_FIN, (id_client_2,cr_2,sr_2,h_alg_2,a_alg_2,c_dom_1,psk_2,cert_req_1,s_pkey_2,master_secret_2,chk_2,shk_2,cfin_2,sfin_2,cur_log3_1))
) | (
    {85}!
    {86}in(ch_client_after_EE, (id_client_3: idProc,cr_3: bytes32,sr_3: bytes32,h_alg_3: hash_alg,a_alg_3: aead_alg,c_dom_2: domain,s_dom_1: domain,psk_3: preSharedKey,master_secret_3: bitstring,chk_3: aead_key,shk_3: aead_key,cfin_3: mac_key,sfin_3: mac_key,cur_log_3: bitstring));
    {87}new st_1[]: bitstring;
    {88}event PreciseMess(ch_client_after_EE,id_client_3,st_1,master_secret_3);
    {89}if (psk_3 = NoPSK) then
    (
        {90}in(io, enc_msg: bitstring);
        {91}let msg': msg = aead_dec(a_alg_3,shk_3,zero,zero,enc_msg) in
        {92}let CRTR(=zero) = msg' in
        (
            {93}let cur_log2_3: bitstring = (cur_log_3,msg') in
            {94}in(io, enc_crt_msg: bitstring);
            {95}let certificate_msg_2: msg = aead_dec(a_alg_3,shk_3,zero,zero,enc_crt_msg) in
            {96}out(ch_client_CRT, (id_client_3,cr_3,sr_3,h_alg_3,a_alg_3,c_dom_2,s_dom_1,psk_3,true,master_secret_3,chk_3,shk_3,cfin_3,sfin_3,cur_log2_3,certificate_msg_2))
        )
        else
            {97}let CRT(=zero,crt_2: certificate) = msg' in
                {98}out(ch_client_CRT, (id_client_3,cr_3,sr_3,h_alg_3,a_alg_3,c_dom_2,s_dom_1,psk_3,false,master_secret_3,chk_3,shk_3,cfin_3,sfin_3,cur_log_3,msg'))
            else
                {99}out(io, unexpected_message)
    )
    else
        {100}out(ch_client_FIN, (id_client_3,cr_3,sr_3,h_alg_3,a_alg_3,c_dom_2,psk_3,false,NoPubKey,master_secret_3,chk_3,shk_3,cfin_3,sfin_3,cur_log_3))
) | (
    {101}!
    {102}in(ch_server_CFIN, (id_server: idProc,cr_4: bytes32,sr_4: bytes32,h_alg_4: hash_alg,a_alg_4: aead_alg,psk_4: preSharedKey,s_pkey_3: pubkey,c_pkey_2: pubkey,master_secret_4: bitstring,chk_4: aead_key,shk_4: aead_key,cfin_4: mac_key,sfin_4: mac_key,cur_log_4: bitstring));
    {103}in(io, enc_fin: bitstring);
    {104}let fin_msg: msg = aead_dec(a_alg_4,chk_4,zero,zero,enc_fin) in
    {105}let FIN(hash_msg_1: bitstring) = fin_msg in
    {106}if (hash_msg_1 = hmac(h_alg_4,cfin_4,cur_log_4)) then
    {107}let l_6: label = tls13_client_application_traffic_secret in
    {108}let h_6: bitstring = catch-fail(hash(h_alg_4,cur_log_4)) in
    {109}let v_9: bool = not-caught-fail(h_6) in
    {110}let x_6: bitstring = (if v_9 then (l_6,h_6) else caught-fail) in
    {111}let client_ats_1: bitstring = catch-fail((if v_9 then hmac(h_alg_4,master_secret_4,x_6) else fail-any)) in
    {112}let v_10: bool = not-caught-fail(client_ats_1) in
    {113}let l_7: label = (if v_10 then tls13_server_application_traffic_secret else caught-fail) in
    {114}let h_7: bitstring = (if v_10 then catch-fail(hash(h_alg_4,cur_log_4)) else caught-fail) in
    {115}let v_11: bool = not-caught-fail(h_7) in
    {116}let x_7: bitstring = (if v_11 then (l_7,h_7) else caught-fail) in
    {117}let server_ats_1: bitstring = (if v_10 then catch-fail((if v_11 then hmac(h_alg_4,master_secret_4,x_7) else fail-any)) else caught-fail) in
    {118}let v_12: bool = not-caught-fail(server_ats_1) in
    {119}let l_8: label = (if v_12 then tls13_exporter_master_secret else caught-fail) in
    {120}let h_8: bitstring = (if v_12 then catch-fail(hash(h_alg_4,cur_log_4)) else caught-fail) in
    {121}let v_13: bool = not-caught-fail(h_8) in
    {122}let x_8: bitstring = (if v_13 then (l_8,h_8) else caught-fail) in
    {123}let ems_2: bitstring = (if v_12 then catch-fail((if v_13 then hmac(h_alg_4,master_secret_4,x_8) else fail-any)) else caught-fail) in
    {124}let v_14: bool = not-caught-fail(ems_2) in
    {125}let l_9: label = (if v_14 then tls13_key else caught-fail) in
    {126}let h_9: bitstring = (if v_14 then zero else caught-fail) in
    {127}let x_9: bitstring = (if v_14 then (l_9,h_9) else caught-fail) in
    {128}let client_wkad_1: bitstring = (if v_14 then catch-fail(hmac(h_alg_4,client_ats_1,x_9)) else caught-fail) in
    {129}let v_15: bool = not-caught-fail(client_wkad_1) in
    {130}let l_10: label = (if v_15 then tls13_key else caught-fail) in
    {131}let h_10: bitstring = (if v_15 then zero else caught-fail) in
    {132}let x_10: bitstring = (if v_15 then (l_10,h_10) else caught-fail) in
    {133}let server_wkad_1: bitstring = (if v_15 then catch-fail(hmac(h_alg_4,server_ats_1,x_10)) else caught-fail) in
    {134}let v_16: bool = not-caught-fail(server_wkad_1) in
    {135}let (cak_1: aead_key,sak_1: aead_key,ems_3: bitstring) = (if v_10 then (if v_12 then (if v_14 then (if v_15 then (if v_16 then (client_wkad_1,server_wkad_1,ems_2) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
    {136}let cur_log_CFIN: bitstring = (cur_log_4,fin_msg) in
    {137}let l_11: label = tls13_resumption_master_secret in
    {138}let h_11: bitstring = catch-fail(hash(h_alg_4,cur_log_CFIN)) in
    {139}let v_17: bool = not-caught-fail(h_11) in
    {140}let x_11: bitstring = (if v_17 then (l_11,h_11) else caught-fail) in
    {141}let rms_1: bitstring = (if v_17 then hmac(h_alg_4,master_secret_4,x_11) else fail-any) in
    {142}event SanityServerCFIN(id_server,cr_4,sr_4,psk_4,master_secret_4,chk_4,shk_4,cfin_4,sfin_4,s_pkey_3,c_pkey_2,cak_1,sak_1,ems_3,rms_1,cur_log_CFIN)
) | (
    {143}!
    {144}in(ch_server_FIN, (id_server_1: idProc,cr_5: bytes32,sr_5: bytes32,h_alg_5: hash_alg,a_alg_5: aead_alg,psk_5: preSharedKey,cert_req_2: bool,s_pkey_4: pubkey,master_secret_5: bitstring,chk_5: aead_key,shk_5: aead_key,cfin_5: mac_key,sfin_5: mac_key,cur_log_5: bitstring));
    {145}let hash_msg_2: bitstring = hmac(h_alg_5,sfin_5,cur_log_5) in
    {146}let finished_msg_1: msg = FIN(hash_msg_2) in
    {147}let enc_finished: bitstring = aead_enc(a_alg_5,shk_5,zero,zero,finished_msg_1) in
    {148}out(io, enc_finished);
    {149}let cur_log_FIN: bitstring = (cur_log_5,finished_msg_1) in
    {150}if ((psk_5 = NoPSK) && cert_req_2) then
    (
        {151}in(io, enc_cert_msg: bitstring);
        {152}let cert_msg: msg = aead_dec(a_alg_5,chk_5,zero,zero,enc_cert_msg) in
        {153}let CRT(=zero,crt_3: certificate) = cert_msg in
        {154}let cur_log_CRT: bitstring = (cur_log_FIN,cert_msg) in
        {155}in(io, enc_cert_verif_msg: bitstring);
        {156}let cert_verify_msg: msg = aead_dec(a_alg_5,chk_5,zero,zero,enc_cert_verif_msg) in
        {157}let CV(signed_log_2: bitstring) = cert_verify_msg in
        {158}if (verify(get_pkey(crt_3),hash(h_alg_5,cur_log_CRT),signed_log_2) && verify_cert(crt_3)) then
        {159}let c_pkey_3: pubkey = get_pkey(crt_3) in
        {160}let cur_log_CV: bitstring = (cur_log_CRT,cert_verify_msg) in
        {161}out(ch_server_CFIN, (id_server_1,cr_5,sr_5,h_alg_5,a_alg_5,psk_5,s_pkey_4,c_pkey_3,master_secret_5,chk_5,shk_5,cfin_5,sfin_5,cur_log_CV))
    )
    else
        {162}out(ch_server_CFIN, (id_server_1,cr_5,sr_5,h_alg_5,a_alg_5,psk_5,s_pkey_4,NoPubKey,master_secret_5,chk_5,shk_5,cfin_5,sfin_5,cur_log_FIN))
) | (
    {163}!
    {164}in(ch_server_CRT, (id_server_2: idProc,cr_6: bytes32,sr_6: bytes32,h_alg_6: hash_alg,a_alg_6: aead_alg,s_dom_2: domain,psk_6: preSharedKey,cert_req_3: bool,master_secret_6: bitstring,chk_6: aead_key,shk_6: aead_key,cfin_6: mac_key,sfin_6: mac_key,cur_log_6: bitstring));
    {165}new st_2[]: bitstring;
    {166}event PreciseMess(ch_server_CRT,id_server_2,st_2,master_secret_6);
    {178}get long_term_keys(s_dom': domain,sk_1: privkey,s_pkey_5: pubkey,crt_4: certificate) in
    {167}event Selected_lgt(s_dom',s_dom_2,sk_1,s_pkey_5,crt_4);
    {168}let certificate_msg_3: msg = CRT(zero,crt_4) in
    {169}let encrypted_certificate_msg_1: bitstring = aead_enc(a_alg_6,shk_6,zero,zero,certificate_msg_3) in
    {170}out(io, encrypted_certificate_msg_1);
    {171}let cur_log_CRT_1: bitstring = (cur_log_6,certificate_msg_3) in
    {172}let signed_log_3: bitstring = sign(sk_1,hash(h_alg_6,cur_log_CRT_1)) in
    {173}let certificate_verify_msg_2: msg = CV(signed_log_3) in
    {174}let encrypted_certificate_verify_msg_1: bitstring = aead_enc(a_alg_6,shk_6,zero,zero,certificate_verify_msg_2) in
    {175}out(io, encrypted_certificate_verify_msg_1);
    {176}let cur_log_CV_1: bitstring = (cur_log_CRT_1,certificate_verify_msg_2) in
    {177}out(ch_server_FIN, (id_server_2,cr_6,sr_6,h_alg_6,a_alg_6,psk_6,cert_req_3,s_pkey_5,master_secret_6,chk_6,shk_6,cfin_6,sfin_6,cur_log_CV_1))
) | (
    {179}!
    {180}in(ch_server_SH, (id_server_3: idProc,use_psk: bool,is_backend: bool,cert_req_4: bool,s_dom_3: domain,g: group,h_alg_7: hash_alg,a_alg_7: aead_alg,s_extra: extraExt,encrypted_ext: bitstring,client_hello: msg,cur_log_7: bitstring));
    {181}new st_3[]: bitstring;
    {182}event PreciseMess(ch_server_SH,id_server_3,st_3,client_hello);
    {183}let CH(cr_7: bytes32,offer: params) = client_hello in
    {184}let nego(=TLS13,=h_alg_7,=a_alg_7,client_kex_ext(DHE_kex(=g,gx: element)),sni_ext: sniExt,ech_ext: echExt,psk_ext: preSharedKeyExt,extra_ext: extraExt) = offer in
    (
        {185}if (not(is_backend) || (ech_ext = ech_is_inner)) then
        (
            {186}if (sni_ext = SNI(s_dom_3)) then
            (
                {187}let v_18: msg = client_hello in
                {188}let v_19: bool = (((TLS13 =nf 1-proj-nego(2-proj-CH(v_18))) && success?(1-proj-nego(2-proj-CH(v_18)))) && success?(1-proj-CH(v_18))) in
                {189}let extra_ext_1: extraExt = (if v_19 then 8-proj-nego(2-proj-CH(v_18)) else caught-fail) in
                {190}let psk_ext_1: preSharedKeyExt = (if v_19 then 7-proj-nego(2-proj-CH(v_18)) else caught-fail) in
                {191}let ech_ext_1: echExt = (if v_19 then 6-proj-nego(2-proj-CH(v_18)) else caught-fail) in
                {192}let sni_ext_1: sniExt = (if v_19 then 5-proj-nego(2-proj-CH(v_18)) else caught-fail) in
                {193}let kex_ext: keyShareExt = (if v_19 then 4-proj-nego(2-proj-CH(v_18)) else caught-fail) in
                {194}let a_alg_8: aead_alg = (if v_19 then 3-proj-nego(2-proj-CH(v_18)) else caught-fail) in
                {195}let h_alg_8: hash_alg = (if v_19 then 2-proj-nego(2-proj-CH(v_18)) else caught-fail) in
                {196}let cr_8: bytes32 = (if v_19 then 1-proj-CH(v_18) else caught-fail) in
                {197}let v_20: bitstring = (if v_19 then catch-fail((psk_ext_1,use_psk)) else caught-fail) in
                {198}let v_21: bool = (not-caught-fail(v_20) && ((success?(1-proj-client_psk_ext(1-proj-2-tuple(v_20))) && (true =nf 2-proj-2-tuple(v_20))) && success?(1-proj-2-tuple(v_20)))) in
                {199}let binders: bitstring = (if v_21 then 2-proj-client_psk_ext(1-proj-2-tuple(v_20)) else caught-fail) in
                {200}let id: identityPsk = (if v_21 then 1-proj-client_psk_ext(1-proj-2-tuple(v_20)) else caught-fail) in
                {201}let v_22: bool = (if v_21 then catch-fail(((get_receiver_psk(id) = s_dom_3) && (get_hash_psk(id) = h_alg_8))) else caught-fail) in
                {202}let psk_7: preSharedKey = (if v_22 then catch-fail(PSK(get_ipsk(id))) else caught-fail) in
                {203}let v_23: bool = not-caught-fail(psk_7) in
                {204}let s: bitstring = (if v_23 then zero else caught-fail) in
                {205}let k: bitstring = (if v_23 then catch-fail(psk2b(psk_7)) else caught-fail) in
                {206}let v_24: bool = not-caught-fail(k) in
                {207}let early_secret: bitstring = (if v_23 then catch-fail((if v_24 then hmac(h_alg_8,s,k) else fail-any)) else caught-fail) in
                {208}let v_25: bool = not-caught-fail(early_secret) in
                {209}let l_12: label = (if v_25 then tls13_resumption_psk_binder_key else caught-fail) in
                {210}let m: bitstring = (if v_25 then zero else caught-fail) in
                {211}let h_12: bitstring = (if v_25 then catch-fail(hash(h_alg_8,m)) else caught-fail) in
                {212}let v_26: bool = not-caught-fail(h_12) in
                {213}let x_12: bitstring = (if v_26 then (l_12,h_12) else caught-fail) in
                {214}let binder_key: bitstring = (if v_25 then catch-fail((if v_26 then hmac(h_alg_8,early_secret,x_12) else fail-any)) else caught-fail) in
                {215}let v_27: bool = not-caught-fail(binder_key) in
                {216}let v_28: bitstring = (if v_23 then catch-fail((if v_25 then (if v_27 then (early_secret,binder_key) else fail-any) else fail-any)) else caught-fail) in
                {217}let v_29: bool = (not-caught-fail(v_28) && success?(1-proj-2-tuple(v_28))) in
                {218}let kb: mac_key = (if v_29 then 2-proj-2-tuple(v_28) else caught-fail) in
                {219}let early_secret_1: bitstring = (if v_29 then 1-proj-2-tuple(v_28) else caught-fail) in
                {220}let offer_1: params = (if v_29 then nego(TLS13,h_alg_8,a_alg_8,kex_ext,sni_ext_1,ech_ext_1,trunc_client_psk_ext(id),extra_ext_1) else caught-fail) in
                {221}let cur_log'_1: bitstring = (if v_29 then (cur_log_7,CH(cr_8,offer_1)) else caught-fail) in
                {222}let psk_8: preSharedKey = (if is-false(v_22) then NoPSK else caught-fail) in
                {223}let s_1: bitstring = (if is-false(v_22) then zero else caught-fail) in
                {224}let k_1: bitstring = (if is-false(v_22) then catch-fail(psk2b(psk_8)) else caught-fail) in
                {225}let v_30: bool = not-caught-fail(k_1) in
                {226}let early_secret_2: bitstring = (if is-false(v_22) then catch-fail((if v_30 then hmac(h_alg_8,s_1,k_1) else fail-any)) else caught-fail) in
                {227}let v_31: bool = not-caught-fail(early_secret_2) in
                {228}let l_13: label = (if v_31 then tls13_resumption_psk_binder_key else caught-fail) in
                {229}let m_1: bitstring = (if v_31 then zero else caught-fail) in
                {230}let h_13: bitstring = (if v_31 then catch-fail(hash(h_alg_8,m_1)) else caught-fail) in
                {231}let v_32: bool = not-caught-fail(h_13) in
                {232}let x_13: bitstring = (if v_32 then (l_13,h_13) else caught-fail) in
                {233}let binder_key_1: bitstring = (if v_31 then catch-fail((if v_32 then hmac(h_alg_8,early_secret_2,x_13) else fail-any)) else caught-fail) in
                {234}let v_33: bool = not-caught-fail(binder_key_1) in
                {235}let v_34: bitstring = (if is-false(v_22) then catch-fail((if v_31 then (if v_33 then (early_secret_2,binder_key_1) else fail-any) else fail-any)) else caught-fail) in
                {236}let v_35: bool = (not-caught-fail(v_34) && success?(1-proj-2-tuple(v_34))) in
                {237}let kb_1: mac_key = (if v_35 then 2-proj-2-tuple(v_34) else caught-fail) in
                {238}let es: bitstring = (if v_35 then 1-proj-2-tuple(v_34) else caught-fail) in
                {239}let v_36: bool = (v_19 && not(v_21)) in
                {240}let psk_9: preSharedKey = (if v_36 then NoPSK else caught-fail) in
                {241}let s_2: bitstring = (if v_36 then zero else caught-fail) in
                {242}let k_2: bitstring = (if v_36 then catch-fail(psk2b(psk_9)) else caught-fail) in
                {243}let v_37: bool = not-caught-fail(k_2) in
                {244}let early_secret_3: bitstring = (if v_36 then catch-fail((if v_37 then hmac(h_alg_8,s_2,k_2) else fail-any)) else caught-fail) in
                {245}let v_38: bool = not-caught-fail(early_secret_3) in
                {246}let l_14: label = (if v_38 then tls13_resumption_psk_binder_key else caught-fail) in
                {247}let m_2: bitstring = (if v_38 then zero else caught-fail) in
                {248}let h_14: bitstring = (if v_38 then catch-fail(hash(h_alg_8,m_2)) else caught-fail) in
                {249}let v_39: bool = not-caught-fail(h_14) in
                {250}let x_14: bitstring = (if v_39 then (l_14,h_14) else caught-fail) in
                {251}let binder_key_2: bitstring = (if v_38 then catch-fail((if v_39 then hmac(h_alg_8,early_secret_3,x_14) else fail-any)) else caught-fail) in
                {252}let v_40: bool = not-caught-fail(binder_key_2) in
                {253}let v_41: bitstring = (if v_36 then catch-fail((if v_38 then (if v_40 then (early_secret_3,binder_key_2) else fail-any) else fail-any)) else caught-fail) in
                {254}let v_42: bool = (not-caught-fail(v_41) && success?(1-proj-2-tuple(v_41))) in
                {255}let kb_2: mac_key = (if v_42 then 2-proj-2-tuple(v_41) else caught-fail) in
                {256}let es_1: bitstring = (if v_42 then 1-proj-2-tuple(v_41) else caught-fail) in
                {257}let (early_secret_4: bitstring,s_psk_ext: preSharedKeyExt,psk_10: preSharedKey) = (if v_19 then (if v_21 then (if undo-catch-fail(v_22) then (if v_23 then (if v_29 then (if (binders = hmac(h_alg_8,kb,cur_log'_1)) then (early_secret_1,server_psk_ext(1),psk_7) else fail-any) else fail-any) else fail-any) else (if v_35 then (es,empty_psk_ext,NoPSK) else fail-any)) else (if v_42 then (es_1,empty_psk_ext,NoPSK) else fail-any)) else fail-any) in
                {258}let cur_log_CH: bitstring = (cur_log_7,client_hello) in
                {259}event SanityServerCH(id_server_3,is_backend,cr_7,s_dom_3,psk_10,cur_log_CH);
                {260}new s_3[]: seed;
                {261}let (gxy: element,gy: element) = (dh_xy(s_3,client_hello),dh_encap_fun(g,gx,dh_xy(s_3,client_hello))) in
                {262}let l_15: label = tls13_derived in
                {263}let m_3: bitstring = catch-fail(hash(h_alg_7,zero)) in
                {264}let v_43: bool = not-caught-fail(m_3) in
                {265}let h_15: bitstring = (if v_43 then catch-fail(hash(h_alg_7,m_3)) else caught-fail) in
                {266}let v_44: bool = not-caught-fail(h_15) in
                {267}let x_15: bitstring = (if v_44 then (l_15,h_15) else caught-fail) in
                {268}let extra: bitstring = catch-fail((if v_43 then (if v_44 then hmac(h_alg_7,early_secret_4,x_15) else fail-any) else fail-any)) in
                {269}let v_45: bool = not-caught-fail(extra) in
                {270}let handshake_secret: bitstring = (if v_45 then hmac(h_alg_7,extra,gxy) else fail-any) in
                {271}let s_offer: params = nego(TLS13,h_alg_7,a_alg_7,server_kex_ext(DHE_kex(g,gy)),empty_sni_ext,empty_ech_ext,s_psk_ext,s_extra) in
                {272}let v_46: bool = is_backend in
                {273}new sr24[]: bytes24;
                {274}let SH_ECHConf: msg = (if v_46 then SH(B32(sr24,zero8),s_offer) else caught-fail) in
                {275}let cur_log_SH_ech: bitstring = (if v_46 then (cur_log_CH,SH_ECHConf) else caught-fail) in
                {276}let l_16: label = (if v_46 then ech_accept_confirmation else caught-fail) in
                {277}let h_16: bitstring = (if v_46 then catch-fail(hash(h_alg_7,cur_log_SH_ech)) else caught-fail) in
                {278}let v_47: bool = not-caught-fail(h_16) in
                {279}let x_16: bitstring = (if v_47 then (l_16,h_16) else caught-fail) in
                {280}let accept_confirmation: bitstring = (if v_46 then catch-fail((if v_47 then hmac(h_alg_7,handshake_secret,x_16) else fail-any)) else caught-fail) in
                {281}let v_48: bool = not-caught-fail(accept_confirmation) in
                {282}let sr8: bytes8 = (if v_48 then crop_into_bytes8(accept_confirmation) else caught-fail) in
                {283}new rand24[]: bytes24;
                {284}new rand8[]: bytes8;
                {285}let sr_7: bytes32 = (if v_46 then (if v_48 then B32(sr24,sr8) else fail-any) else B32(rand24,rand8)) in
                {286}let server_hello: msg = SH(sr_7,s_offer) in
                {287}out(io, server_hello);
                {288}let cur_log_SH: bitstring = (cur_log_CH,server_hello) in
                {289}event SanityServerSH(id_server_3,cr_7,sr_7,s_dom_3,handshake_secret,psk_10,cur_log_SH);
                {290}let l_17: label = tls13_derived in
                {291}let m_4: bitstring = catch-fail(hash(h_alg_7,zero)) in
                {292}let v_49: bool = not-caught-fail(m_4) in
                {293}let h_17: bitstring = (if v_49 then catch-fail(hash(h_alg_7,m_4)) else caught-fail) in
                {294}let v_50: bool = not-caught-fail(h_17) in
                {295}let x_17: bitstring = (if v_50 then (l_17,h_17) else caught-fail) in
                {296}let extra_1: bitstring = catch-fail((if v_49 then (if v_50 then hmac(h_alg_7,handshake_secret,x_17) else fail-any) else fail-any)) in
                {297}let v_51: bool = not-caught-fail(extra_1) in
                {298}let k_3: bitstring = (if v_51 then zero else caught-fail) in
                {299}let master_secret_7: bitstring = (if v_51 then catch-fail(hmac(h_alg_7,handshake_secret,k_3)) else caught-fail) in
                {300}let v_52: bool = not-caught-fail(master_secret_7) in
                {301}let l_18: label = (if v_52 then tls13_client_handshake_traffic_secret else caught-fail) in
                {302}let h_18: bitstring = (if v_52 then catch-fail(hash(h_alg_7,cur_log_SH)) else caught-fail) in
                {303}let v_53: bool = not-caught-fail(h_18) in
                {304}let x_18: bitstring = (if v_53 then (l_18,h_18) else caught-fail) in
                {305}let client_hts: bitstring = (if v_52 then catch-fail((if v_53 then hmac(h_alg_7,handshake_secret,x_18) else fail-any)) else caught-fail) in
                {306}let v_54: bool = not-caught-fail(client_hts) in
                {307}let l_19: label = (if v_54 then tls13_server_handshake_traffic_secret else caught-fail) in
                {308}let h_19: bitstring = (if v_54 then catch-fail(hash(h_alg_7,cur_log_SH)) else caught-fail) in
                {309}let v_55: bool = not-caught-fail(h_19) in
                {310}let x_19: bitstring = (if v_55 then (l_19,h_19) else caught-fail) in
                {311}let server_hts: bitstring = (if v_54 then catch-fail((if v_55 then hmac(h_alg_7,handshake_secret,x_19) else fail-any)) else caught-fail) in
                {312}let v_56: bool = not-caught-fail(server_hts) in
                {313}let l_20: label = (if v_56 then tls13_key else caught-fail) in
                {314}let h_20: bitstring = (if v_56 then zero else caught-fail) in
                {315}let x_20: bitstring = (if v_56 then (l_20,h_20) else caught-fail) in
                {316}let client_wkh: bitstring = (if v_56 then catch-fail(hmac(h_alg_7,client_hts,x_20)) else caught-fail) in
                {317}let v_57: bool = not-caught-fail(client_wkh) in
                {318}let l_21: label = (if v_57 then tls13_key else caught-fail) in
                {319}let h_21: bitstring = (if v_57 then zero else caught-fail) in
                {320}let x_21: bitstring = (if v_57 then (l_21,h_21) else caught-fail) in
                {321}let server_wkh: bitstring = (if v_57 then catch-fail(hmac(h_alg_7,server_hts,x_21)) else caught-fail) in
                {322}let v_58: bool = not-caught-fail(server_wkh) in
                {323}let l_22: label = (if v_58 then tls13_finished else caught-fail) in
                {324}let h_22: bitstring = (if v_58 then zero else caught-fail) in
                {325}let x_22: bitstring = (if v_58 then (l_22,h_22) else caught-fail) in
                {326}let client_fk: bitstring = (if v_58 then catch-fail(hmac(h_alg_7,client_hts,x_22)) else caught-fail) in
                {327}let v_59: bool = not-caught-fail(client_fk) in
                {328}let l_23: label = (if v_59 then tls13_finished else caught-fail) in
                {329}let h_23: bitstring = (if v_59 then zero else caught-fail) in
                {330}let x_23: bitstring = (if v_59 then (l_23,h_23) else caught-fail) in
                {331}let server_fk: bitstring = (if v_59 then catch-fail(hmac(h_alg_7,server_hts,x_23)) else caught-fail) in
                {332}let v_60: bool = not-caught-fail(server_fk) in
                {333}let (master_secret_8: bitstring,chk_7: aead_key,shk_7: aead_key,cfin_7: mac_key,sfin_7: mac_key) = (if v_51 then (if v_52 then (if v_54 then (if v_56 then (if v_57 then (if v_58 then (if v_59 then (if v_60 then (master_secret_7,client_wkh,server_wkh,client_fk,server_fk) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
                {334}let ee_msg: msg = EE(encrypted_ext) in
                {335}let enc_ee: bitstring = aead_enc(a_alg_7,shk_7,zero,zero,ee_msg) in
                {336}out(io, enc_ee);
                {337}let cur_log_EE: bitstring = (cur_log_SH,ee_msg) in
                {338}if (psk_10 = NoPSK) then
                (
                    {339}if cert_req_4 then
                    (
                        {340}let crtr_msg: msg = CRTR(zero) in
                        {341}let enc_crt: bitstring = aead_enc(a_alg_7,shk_7,zero,zero,crtr_msg) in
                        {342}out(io, enc_crt);
                        {343}let cur_log_CRTR: bitstring = (cur_log_EE,crtr_msg) in
                        {344}out(ch_server_CRT, (id_server_3,cr_7,sr_7,h_alg_7,a_alg_7,s_dom_3,psk_10,cert_req_4,master_secret_8,chk_7,shk_7,cfin_7,sfin_7,cur_log_CRTR))
                    )
                    else
                        {345}out(ch_server_CRT, (id_server_3,cr_7,sr_7,h_alg_7,a_alg_7,s_dom_3,psk_10,cert_req_4,master_secret_8,chk_7,shk_7,cfin_7,sfin_7,cur_log_EE))
                )
                else
                    {346}out(ch_server_FIN, (id_server_3,cr_7,sr_7,h_alg_7,a_alg_7,psk_10,false,NoPubKey,master_secret_8,chk_7,shk_7,cfin_7,sfin_7,cur_log_EE))
            )
            else
                {347}out(io, illegal_parameter)
        )
        else
            {348}out(io, illegal_parameter)
    )
    else
        {349}out(io, handshake_failure)
) | (
    {350}!
    {351}in(io, a: domain);
    {352}event Same(a);
    {353}new s_4: seed;
    {354}let sk_h: privkey = uc_privkey(s_4) in
    {355}event GenCert(a,pk(sk_h));
    {356}insert long_term_keys(a,sk_h,pk(sk_h),valid_cert(a,pk(sk_h)));
    {357}out(io, pk(sk_h))
) | (
    {358}!
    {359}in(io, (c_dom_3: domain,s_dom_4: domain));
    {360}event Same((c_dom_3,s_dom_4));
    {361}new s_5: seed;
    {362}let psk_11: internal_preSharedKey = uc_psk(s_5) in
    {363}let id_1: identityPsk = mk_idpsk(c_dom_3,s_dom_4,tls_h,psk_11) in
    {364}event GenPsk(c_dom_3,s_dom_4,PSK(psk_11));
    {365}insert pre_shared_keys(c_dom_3,s_dom_4,tls_h,id_1,psk_11)
) | (
    {366}!
    {367}in(io, o_dom: domain);
    {368}new id_2: configId;
    {369}new s_6[]: seed;
    {370}let gx_1: element = dh_pub(ech_g,dh_k(s_6)) in
    {371}let (skR: bitstring,pkR: element) = (dh_k(s_6),gx_1) in
    {372}let config: echConfig = ech_config(id_2,ech_g,pkR,o_dom,ech_h,ech_a) in
    {373}insert ech_configurations(config,skR);
    {374}let config_1: echConfig = config in
    {375}out(io, config_1)
) | (
    {376}!
    {380}get pre_shared_keys(c_dom1: domain,s_dom1: domain,h_alg1: hash_alg,id1: identityPsk,psk1: internal_preSharedKey) in
    {379}get pre_shared_keys(c_dom2: domain,s_dom2: domain,h_alg2: hash_alg,id2: identityPsk,psk2: internal_preSharedKey) in
    {377}insert pre_shared_keys(choice[c_dom1,c_dom2],choice[s_dom1,s_dom2],choice[h_alg1,h_alg2],choice[id1,id2],choice[psk1,psk2]);
    {378}insert pre_shared_keys(choice[c_dom2,c_dom1],choice[s_dom2,s_dom1],choice[h_alg1,h_alg2],choice[id2,id1],choice[psk2,psk1])
) | (
    {381}!
    {385}get long_term_keys(dom1: domain,sk1: privkey,pk1: pubkey,cert1: certificate) in
    {384}get long_term_keys(dom2: domain,sk2: privkey,pk2: pubkey,cert2: certificate) in
    {382}insert long_term_keys(choice[dom1,dom2],choice[sk1,sk2],choice[pk1,pk2],choice[cert1,cert2]);
    {383}insert long_term_keys(choice[dom2,dom1],choice[sk2,sk1],choice[pk2,pk1],choice[cert2,cert1])
) | (
    {386}!
    {387}in(io, a_1: domain);
    {388}event Same(a_1);
    {389}new sk_d: privkey;
    {390}out(io, (sk_d,valid_cert(a_1,pk(sk_d))))
) | (
    {391}!
    {392}in(io, (c_dom_4: domain,s_dom_5: domain));
    {393}event Same((c_dom_4,s_dom_5));
    {394}new psk_d: internal_preSharedKey;
    {395}let id_3: identityPsk = mk_idpsk(c_dom_4,s_dom_5,tls_h,psk_d) in
    {396}insert pre_shared_keys(c_dom_4,s_dom_5,tls_h,id_3,psk_d);
    {397}out(io, id_3)
) | (
    {398}!
    {399}let use_psk_1: bool = false in
    {400}let send_kex: bool = true in
    {401}in(io, (c_dom_5: domain,s_dom_6: domain));
    {402}event Same((use_psk_1,send_kex,c_dom_5,s_dom_6));
    {403}let extra_2: extraExt = empty_extra_ext in
    {404}new id_client_4[]: idProc;
    {405}event SanityClient(id_client_4,false,false,use_psk_1,send_kex);
    {406}let cur_log_8: bitstring = zero in
    {407}new rand24_1[]: bytes24;
    {408}new rand8_1[]: bytes8;
    {409}let cr_9: bytes32 = B32(rand24_1,rand8_1) in
    {410}new s_7[]: seed;
    {411}let gx_2: element = dh_pub(tls_g,dh_k(s_7)) in
    {412}let v_61: bitstring = (dh_k(s_7),gx_2) in
    {413}let v_62: bool = success?(1-proj-2-tuple(v_61)) in
    {414}let gx_3: element = (if v_62 then 2-proj-2-tuple(v_61) else caught-fail) in
    {415}let x_24: bitstring = (if v_62 then 1-proj-2-tuple(v_61) else caught-fail) in
    {416}let kex: kex_alg = (if v_62 then (if send_kex then DHE_kex(tls_g,gx_3) else DHE_group(tls_g)) else caught-fail) in
    {417}let (kex_ext_1: keyShareExt,kex_data: bitstring) = (if v_62 then (client_kex_ext(kex),(x_24,tls_g,send_kex)) else fail-any) in
    {418}let ech_ext_2: echExt = empty_ech_ext in
    {738}get pre_shared_keys(c_dom'_1: domain,s_dom'_1: domain,=tls_h,id_4: identityPsk,internal_psk: internal_preSharedKey) in
    {419}event Selected_psk(c_dom_5,c_dom'_1,s_dom_6,s_dom'_1,id_4,internal_psk);
    {420}let v_63: bool = use_psk_1 in
    {421}let psk_12: preSharedKey = (if v_63 then PSK(internal_psk) else caught-fail) in
    {422}let offer_2: params = (if v_63 then nego(TLS13,tls_h,tls_a,kex_ext_1,SNI(s_dom_6),ech_ext_2,trunc_client_psk_ext(id_4),extra_2) else caught-fail) in
    {423}let cur_log'_2: bitstring = (if v_63 then (cur_log_8,CH(cr_9,offer_2)) else caught-fail) in
    {424}let s_8: bitstring = (if v_63 then zero else caught-fail) in
    {425}let k_4: bitstring = (if v_63 then catch-fail(psk2b(psk_12)) else caught-fail) in
    {426}let v_64: bool = not-caught-fail(k_4) in
    {427}let early_secret_5: bitstring = (if v_63 then catch-fail((if v_64 then hmac(tls_h,s_8,k_4) else fail-any)) else caught-fail) in
    {428}let v_65: bool = not-caught-fail(early_secret_5) in
    {429}let l_24: label = (if v_65 then tls13_resumption_psk_binder_key else caught-fail) in
    {430}let m_5: bitstring = (if v_65 then zero else caught-fail) in
    {431}let h_24: bitstring = (if v_65 then catch-fail(hash(tls_h,m_5)) else caught-fail) in
    {432}let v_66: bool = not-caught-fail(h_24) in
    {433}let x_25: bitstring = (if v_66 then (l_24,h_24) else caught-fail) in
    {434}let binder_key_3: bitstring = (if v_65 then catch-fail((if v_66 then hmac(tls_h,early_secret_5,x_25) else fail-any)) else caught-fail) in
    {435}let v_67: bool = not-caught-fail(binder_key_3) in
    {436}let v_68: bitstring = (if v_63 then catch-fail((if v_65 then (if v_67 then (early_secret_5,binder_key_3) else fail-any) else fail-any)) else caught-fail) in
    {437}let v_69: bool = (not-caught-fail(v_68) && success?(1-proj-2-tuple(v_68))) in
    {438}let kb_3: mac_key = (if v_69 then 2-proj-2-tuple(v_68) else caught-fail) in
    {439}let es_2: bitstring = (if v_69 then 1-proj-2-tuple(v_68) else caught-fail) in
    {440}let binders_1: bitstring = (if v_69 then catch-fail(hmac(tls_h,kb_3,cur_log'_2)) else caught-fail) in
    {441}let v_70: bool = not-caught-fail(binders_1) in
    {442}let psk_13: preSharedKey = (if not(v_63) then NoPSK else caught-fail) in
    {443}let s_9: bitstring = (if not(v_63) then zero else caught-fail) in
    {444}let k_5: bitstring = (if not(v_63) then catch-fail(psk2b(psk_13)) else caught-fail) in
    {445}let v_71: bool = not-caught-fail(k_5) in
    {446}let early_secret_6: bitstring = (if not(v_63) then catch-fail((if v_71 then hmac(tls_h,s_9,k_5) else fail-any)) else caught-fail) in
    {447}let v_72: bool = not-caught-fail(early_secret_6) in
    {448}let l_25: label = (if v_72 then tls13_resumption_psk_binder_key else caught-fail) in
    {449}let m_6: bitstring = (if v_72 then zero else caught-fail) in
    {450}let h_25: bitstring = (if v_72 then catch-fail(hash(tls_h,m_6)) else caught-fail) in
    {451}let v_73: bool = not-caught-fail(h_25) in
    {452}let x_26: bitstring = (if v_73 then (l_25,h_25) else caught-fail) in
    {453}let binder_key_4: bitstring = (if v_72 then catch-fail((if v_73 then hmac(tls_h,early_secret_6,x_26) else fail-any)) else caught-fail) in
    {454}let v_74: bool = not-caught-fail(binder_key_4) in
    {455}let v_75: bitstring = (if not(v_63) then catch-fail((if v_72 then (if v_74 then (early_secret_6,binder_key_4) else fail-any) else fail-any)) else caught-fail) in
    {456}let v_76: bool = (not-caught-fail(v_75) && success?(1-proj-2-tuple(v_75))) in
    {457}let kb_4: mac_key = (if v_76 then 2-proj-2-tuple(v_75) else caught-fail) in
    {458}let es_3: bitstring = (if v_76 then 1-proj-2-tuple(v_75) else caught-fail) in
    {459}let v_77: bitstring = catch-fail((if v_63 then (if v_69 then (if v_70 then (client_psk_ext(id_4,binders_1),(tls_h,psk_12,es_2)) else fail-any) else fail-any) else (if v_76 then (empty_psk_ext,(tls_h,NoPSK,es_3)) else fail-any))) in
    {460}let v_78: bool = (not-caught-fail(v_77) && success?(1-proj-2-tuple(v_77))) in
    {461}let psk_data: bitstring = (if v_78 then 2-proj-2-tuple(v_77) else caught-fail) in
    {462}let psk_ext_2: preSharedKeyExt = (if v_78 then 1-proj-2-tuple(v_77) else caught-fail) in
    {463}let offer_3: params = (if v_78 then nego(TLS13,tls_h,tls_a,kex_ext_1,SNI(s_dom_6),empty_ech_ext,psk_ext_2,extra_2) else caught-fail) in
    {464}let (client_hello_1: msg,cr_10: bytes32,kex_ext_2: keyShareExt,kex_data_1: bitstring,psk_data_1: bitstring) = (if v_78 then (CH(cr_9,offer_3),cr_9,kex_ext_1,kex_data,psk_data) else fail-any) in
    {465}out(io, client_hello_1);
    {466}let cur_log2_4: bitstring = (cur_log_8,client_hello_1) in
    {467}let (=tls_h,psk_14: preSharedKey,es_4: bitstring) = psk_data_1 in
    {468}event SanityClientCH(id_client_4,zero32,cr_10,c_dom_5,s_dom_6,psk_14,cur_log2_4);
    {469}in(io, server_hello_1: msg);
    {470}let SH(sr_8: bytes32,mode: params) = server_hello_1 in
    (
        {471}if (sr_8 = rand_HelloRetryRequest) then
        (
            {472}let (nego(=TLS13,=tls_h,=tls_a,hrr_kex_ext(=tls_g),=empty_sni_ext,=empty_ech_ext,=empty_psk_ext,srv_extra: extraExt),=false) = (mode,send_kex) in
            (
                {473}let cur_log3_2: bitstring = (cur_log2_4,server_hello_1) in
                {474}event SanityClientHRR(id_client_4,cr_10,c_dom_5,s_dom_6,cur_log3_2);
                {475}let send_kex_1: bool = true in
                {476}new rand24_2[]: bytes24;
                {477}new rand8_2[]: bytes8;
                {478}let cr_11: bytes32 = B32(rand24_2,rand8_2) in
                {479}new s_10[]: seed;
                {480}let gx_4: element = dh_pub(tls_g,dh_k(s_10)) in
                {481}let v_79: bitstring = (dh_k(s_10),gx_4) in
                {482}let v_80: bool = success?(1-proj-2-tuple(v_79)) in
                {483}let gx_5: element = (if v_80 then 2-proj-2-tuple(v_79) else caught-fail) in
                {484}let x_27: bitstring = (if v_80 then 1-proj-2-tuple(v_79) else caught-fail) in
                {485}let kex_1: kex_alg = (if v_80 then (if send_kex_1 then DHE_kex(tls_g,gx_5) else DHE_group(tls_g)) else caught-fail) in
                {486}let (kex_ext_3: keyShareExt,kex_data_2: bitstring) = (if v_80 then (client_kex_ext(kex_1),(x_27,tls_g,send_kex_1)) else fail-any) in
                {487}let ech_ext_3: echExt = empty_ech_ext in
                {638}get pre_shared_keys(c_dom'_2: domain,s_dom'_2: domain,=tls_h,id_5: identityPsk,internal_psk_1: internal_preSharedKey) in
                {488}event Selected_psk(c_dom_5,c_dom'_2,s_dom_6,s_dom'_2,id_5,internal_psk_1);
                {489}let v_81: bool = use_psk_1 in
                {490}let psk_15: preSharedKey = (if v_81 then PSK(internal_psk_1) else caught-fail) in
                {491}let offer_4: params = (if v_81 then nego(TLS13,tls_h,tls_a,kex_ext_3,SNI(s_dom_6),ech_ext_3,trunc_client_psk_ext(id_5),extra_2) else caught-fail) in
                {492}let cur_log'_3: bitstring = (if v_81 then (cur_log3_2,CH(cr_11,offer_4)) else caught-fail) in
                {493}let s_11: bitstring = (if v_81 then zero else caught-fail) in
                {494}let k_6: bitstring = (if v_81 then catch-fail(psk2b(psk_15)) else caught-fail) in
                {495}let v_82: bool = not-caught-fail(k_6) in
                {496}let early_secret_7: bitstring = (if v_81 then catch-fail((if v_82 then hmac(tls_h,s_11,k_6) else fail-any)) else caught-fail) in
                {497}let v_83: bool = not-caught-fail(early_secret_7) in
                {498}let l_26: label = (if v_83 then tls13_resumption_psk_binder_key else caught-fail) in
                {499}let m_7: bitstring = (if v_83 then zero else caught-fail) in
                {500}let h_26: bitstring = (if v_83 then catch-fail(hash(tls_h,m_7)) else caught-fail) in
                {501}let v_84: bool = not-caught-fail(h_26) in
                {502}let x_28: bitstring = (if v_84 then (l_26,h_26) else caught-fail) in
                {503}let binder_key_5: bitstring = (if v_83 then catch-fail((if v_84 then hmac(tls_h,early_secret_7,x_28) else fail-any)) else caught-fail) in
                {504}let v_85: bool = not-caught-fail(binder_key_5) in
                {505}let v_86: bitstring = (if v_81 then catch-fail((if v_83 then (if v_85 then (early_secret_7,binder_key_5) else fail-any) else fail-any)) else caught-fail) in
                {506}let v_87: bool = (not-caught-fail(v_86) && success?(1-proj-2-tuple(v_86))) in
                {507}let kb_5: mac_key = (if v_87 then 2-proj-2-tuple(v_86) else caught-fail) in
                {508}let es_5: bitstring = (if v_87 then 1-proj-2-tuple(v_86) else caught-fail) in
                {509}let binders_2: bitstring = (if v_87 then catch-fail(hmac(tls_h,kb_5,cur_log'_3)) else caught-fail) in
                {510}let v_88: bool = not-caught-fail(binders_2) in
                {511}let psk_16: preSharedKey = (if not(v_81) then NoPSK else caught-fail) in
                {512}let s_12: bitstring = (if not(v_81) then zero else caught-fail) in
                {513}let k_7: bitstring = (if not(v_81) then catch-fail(psk2b(psk_16)) else caught-fail) in
                {514}let v_89: bool = not-caught-fail(k_7) in
                {515}let early_secret_8: bitstring = (if not(v_81) then catch-fail((if v_89 then hmac(tls_h,s_12,k_7) else fail-any)) else caught-fail) in
                {516}let v_90: bool = not-caught-fail(early_secret_8) in
                {517}let l_27: label = (if v_90 then tls13_resumption_psk_binder_key else caught-fail) in
                {518}let m_8: bitstring = (if v_90 then zero else caught-fail) in
                {519}let h_27: bitstring = (if v_90 then catch-fail(hash(tls_h,m_8)) else caught-fail) in
                {520}let v_91: bool = not-caught-fail(h_27) in
                {521}let x_29: bitstring = (if v_91 then (l_27,h_27) else caught-fail) in
                {522}let binder_key_6: bitstring = (if v_90 then catch-fail((if v_91 then hmac(tls_h,early_secret_8,x_29) else fail-any)) else caught-fail) in
                {523}let v_92: bool = not-caught-fail(binder_key_6) in
                {524}let v_93: bitstring = (if not(v_81) then catch-fail((if v_90 then (if v_92 then (early_secret_8,binder_key_6) else fail-any) else fail-any)) else caught-fail) in
                {525}let v_94: bool = (not-caught-fail(v_93) && success?(1-proj-2-tuple(v_93))) in
                {526}let kb_6: mac_key = (if v_94 then 2-proj-2-tuple(v_93) else caught-fail) in
                {527}let es_6: bitstring = (if v_94 then 1-proj-2-tuple(v_93) else caught-fail) in
                {528}let v_95: bitstring = catch-fail((if v_81 then (if v_87 then (if v_88 then (client_psk_ext(id_5,binders_2),(tls_h,psk_15,es_5)) else fail-any) else fail-any) else (if v_94 then (empty_psk_ext,(tls_h,NoPSK,es_6)) else fail-any))) in
                {529}let v_96: bool = (not-caught-fail(v_95) && success?(1-proj-2-tuple(v_95))) in
                {530}let psk_data_2: bitstring = (if v_96 then 2-proj-2-tuple(v_95) else caught-fail) in
                {531}let psk_ext_3: preSharedKeyExt = (if v_96 then 1-proj-2-tuple(v_95) else caught-fail) in
                {532}let offer_5: params = (if v_96 then nego(TLS13,tls_h,tls_a,kex_ext_3,SNI(s_dom_6),empty_ech_ext,psk_ext_3,extra_2) else caught-fail) in
                {533}let (client_hello': msg,cr': bytes32,kex_ext': keyShareExt,kex_data': bitstring,psk_data': bitstring) = (if v_96 then (CH(cr_11,offer_5),cr_11,kex_ext_3,kex_data_2,psk_data_2) else fail-any) in
                {534}out(io, client_hello');
                {535}let cur_log4: bitstring = (cur_log3_2,client_hello') in
                {536}let (=tls_h,psk': preSharedKey,es': bitstring) = psk_data' in
                {537}event SanityClientCH(id_client_4,cr_10,cr',c_dom_5,s_dom_6,psk',cur_log4);
                {538}in(io, server_hello': msg);
                {539}let SH(sr': bytes32,mode': params) = server_hello' in
                (
                    {540}if (sr' = rand_HelloRetryRequest) then
                        {541}out(io, unexpected_message)
                    else
                        {542}let id_client_5: idProc = id_client_4 in
                        {543}let SH(sr_9: bytes32,mode_1: params) = server_hello' in
                        {544}let (x_30: bitstring,g_1: group,=true) = kex_data' in
                        {545}let nego(=TLS13,=tls_h,=tls_a,server_kex_ext(DHE_kex(=g_1,gy_1: element)),=empty_sni_ext,=empty_ech_ext,psk_ext_4: preSharedKeyExt,extra_3: extraExt) = mode_1 in
                        (
                            {546}let cur_log2_5: bitstring = (cur_log4,server_hello') in
                            {547}let v_97: bool = (psk_ext_4 = empty_psk_ext) in
                            {548}let psk_17: preSharedKey = (if v_97 then NoPSK else caught-fail) in
                            {549}let s_13: bitstring = (if v_97 then zero else caught-fail) in
                            {550}let k_8: bitstring = (if v_97 then catch-fail(psk2b(psk_17)) else caught-fail) in
                            {551}let v_98: bool = not-caught-fail(k_8) in
                            {552}let early_secret_9: bitstring = (if v_97 then catch-fail((if v_98 then hmac(tls_h,s_13,k_8) else fail-any)) else caught-fail) in
                            {553}let v_99: bool = not-caught-fail(early_secret_9) in
                            {554}let l_28: label = (if v_99 then tls13_resumption_psk_binder_key else caught-fail) in
                            {555}let m_9: bitstring = (if v_99 then zero else caught-fail) in
                            {556}let h_28: bitstring = (if v_99 then catch-fail(hash(tls_h,m_9)) else caught-fail) in
                            {557}let v_100: bool = not-caught-fail(h_28) in
                            {558}let x_31: bitstring = (if v_100 then (l_28,h_28) else caught-fail) in
                            {559}let binder_key_7: bitstring = (if v_99 then catch-fail((if v_100 then hmac(tls_h,early_secret_9,x_31) else fail-any)) else caught-fail) in
                            {560}let v_101: bool = not-caught-fail(binder_key_7) in
                            {561}let v_102: bitstring = (if v_97 then catch-fail((if v_99 then (if v_101 then (early_secret_9,binder_key_7) else fail-any) else fail-any)) else caught-fail) in
                            {562}let v_103: bool = (not-caught-fail(v_102) && success?(1-proj-2-tuple(v_102))) in
                            {563}let kb_7: mac_key = (if v_103 then 2-proj-2-tuple(v_102) else caught-fail) in
                            {564}let es_7: bitstring = (if v_103 then 1-proj-2-tuple(v_102) else caught-fail) in
                            {565}let v_104: bitstring = (if not(v_97) then catch-fail(psk_data') else caught-fail) in
                            {566}let v_105: bool = (not-caught-fail(v_104) && success?(1-proj-3-tuple(v_104))) in
                            {567}let es_8: bitstring = (if v_105 then 3-proj-3-tuple(v_104) else caught-fail) in
                            {568}let psk_18: preSharedKey = (if v_105 then 2-proj-3-tuple(v_104) else caught-fail) in
                            {569}let h'_alg: hash_alg = (if v_105 then 1-proj-3-tuple(v_104) else caught-fail) in
                            {570}let (psk_19: preSharedKey,early_secret_10: bitstring,valid: bool) = (if v_97 then (if v_103 then (NoPSK,es_7,true) else fail-any) else (if v_105 then (psk_18,es_8,((h'_alg = tls_h) && ((server_psk_ext(1) = psk_ext_4) && use_psk_1))) else fail-any)) in
                            {571}if valid then
                            (
                                {572}let gxy_1: element = catch-fail(dh_decap_fun(g_1,gy_1,x_30)) in
                                {573}let v_106: bool = not-caught-fail(gxy_1) in
                                {574}new s_14[]: seed;
                                {575}let gxy_2: element = (if v_106 then gxy_1 else dh_f(s_14)) in
                                {576}let l_29: label = tls13_derived in
                                {577}let m_10: bitstring = catch-fail(hash(tls_h,zero)) in
                                {578}let v_107: bool = not-caught-fail(m_10) in
                                {579}let h_29: bitstring = (if v_107 then catch-fail(hash(tls_h,m_10)) else caught-fail) in
                                {580}let v_108: bool = not-caught-fail(h_29) in
                                {581}let x_32: bitstring = (if v_108 then (l_29,h_29) else caught-fail) in
                                {582}let extra_4: bitstring = catch-fail((if v_107 then (if v_108 then hmac(tls_h,early_secret_10,x_32) else fail-any) else fail-any)) in
                                {583}let v_109: bool = not-caught-fail(extra_4) in
                                {584}let handshake_secret_1: bitstring = (if v_109 then hmac(tls_h,extra_4,gxy_2) else fail-any) in
                                {585}event SanityClientSH(id_client_5,cr',sr_9,c_dom_5,s_dom_6,handshake_secret_1,psk_19,cur_log2_5);
                                {586}let l_30: label = tls13_derived in
                                {587}let m_11: bitstring = catch-fail(hash(tls_h,zero)) in
                                {588}let v_110: bool = not-caught-fail(m_11) in
                                {589}let h_30: bitstring = (if v_110 then catch-fail(hash(tls_h,m_11)) else caught-fail) in
                                {590}let v_111: bool = not-caught-fail(h_30) in
                                {591}let x_33: bitstring = (if v_111 then (l_30,h_30) else caught-fail) in
                                {592}let extra_5: bitstring = catch-fail((if v_110 then (if v_111 then hmac(tls_h,handshake_secret_1,x_33) else fail-any) else fail-any)) in
                                {593}let v_112: bool = not-caught-fail(extra_5) in
                                {594}let k_9: bitstring = (if v_112 then zero else caught-fail) in
                                {595}let master_secret_9: bitstring = (if v_112 then catch-fail(hmac(tls_h,handshake_secret_1,k_9)) else caught-fail) in
                                {596}let v_113: bool = not-caught-fail(master_secret_9) in
                                {597}let l_31: label = (if v_113 then tls13_client_handshake_traffic_secret else caught-fail) in
                                {598}let h_31: bitstring = (if v_113 then catch-fail(hash(tls_h,cur_log2_5)) else caught-fail) in
                                {599}let v_114: bool = not-caught-fail(h_31) in
                                {600}let x_34: bitstring = (if v_114 then (l_31,h_31) else caught-fail) in
                                {601}let client_hts_1: bitstring = (if v_113 then catch-fail((if v_114 then hmac(tls_h,handshake_secret_1,x_34) else fail-any)) else caught-fail) in
                                {602}let v_115: bool = not-caught-fail(client_hts_1) in
                                {603}let l_32: label = (if v_115 then tls13_server_handshake_traffic_secret else caught-fail) in
                                {604}let h_32: bitstring = (if v_115 then catch-fail(hash(tls_h,cur_log2_5)) else caught-fail) in
                                {605}let v_116: bool = not-caught-fail(h_32) in
                                {606}let x_35: bitstring = (if v_116 then (l_32,h_32) else caught-fail) in
                                {607}let server_hts_1: bitstring = (if v_115 then catch-fail((if v_116 then hmac(tls_h,handshake_secret_1,x_35) else fail-any)) else caught-fail) in
                                {608}let v_117: bool = not-caught-fail(server_hts_1) in
                                {609}let l_33: label = (if v_117 then tls13_key else caught-fail) in
                                {610}let h_33: bitstring = (if v_117 then zero else caught-fail) in
                                {611}let x_36: bitstring = (if v_117 then (l_33,h_33) else caught-fail) in
                                {612}let client_wkh_1: bitstring = (if v_117 then catch-fail(hmac(tls_h,client_hts_1,x_36)) else caught-fail) in
                                {613}let v_118: bool = not-caught-fail(client_wkh_1) in
                                {614}let l_34: label = (if v_118 then tls13_key else caught-fail) in
                                {615}let h_34: bitstring = (if v_118 then zero else caught-fail) in
                                {616}let x_37: bitstring = (if v_118 then (l_34,h_34) else caught-fail) in
                                {617}let server_wkh_1: bitstring = (if v_118 then catch-fail(hmac(tls_h,server_hts_1,x_37)) else caught-fail) in
                                {618}let v_119: bool = not-caught-fail(server_wkh_1) in
                                {619}let l_35: label = (if v_119 then tls13_finished else caught-fail) in
                                {620}let h_35: bitstring = (if v_119 then zero else caught-fail) in
                                {621}let x_38: bitstring = (if v_119 then (l_35,h_35) else caught-fail) in
                                {622}let client_fk_1: bitstring = (if v_119 then catch-fail(hmac(tls_h,client_hts_1,x_38)) else caught-fail) in
                                {623}let v_120: bool = not-caught-fail(client_fk_1) in
                                {624}let l_36: label = (if v_120 then tls13_finished else caught-fail) in
                                {625}let h_36: bitstring = (if v_120 then zero else caught-fail) in
                                {626}let x_39: bitstring = (if v_120 then (l_36,h_36) else caught-fail) in
                                {627}let server_fk_1: bitstring = (if v_120 then catch-fail(hmac(tls_h,server_hts_1,x_39)) else caught-fail) in
                                {628}let v_121: bool = not-caught-fail(server_fk_1) in
                                {629}let (master_secret_10: bitstring,chk_8: aead_key,shk_8: aead_key,cfin_8: mac_key,sfin_8: mac_key) = (if v_112 then (if v_113 then (if v_115 then (if v_117 then (if v_118 then (if v_119 then (if v_120 then (if v_121 then (master_secret_9,client_wkh_1,server_wkh_1,client_fk_1,server_fk_1) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
                                {630}in(io, enc_ee_msg: bitstring);
                                {631}let ee_msg_1: msg = aead_dec(tls_a,shk_8,zero,zero,enc_ee_msg) in
                                {632}let EE(x_40: bitstring) = ee_msg_1 in
                                {633}let cur_log2_6: bitstring = (cur_log2_5,ee_msg_1) in
                                {634}out(ch_client_after_EE, (id_client_5,cr',sr_9,tls_h,tls_a,c_dom_5,s_dom_6,psk_19,master_secret_10,chk_8,shk_8,cfin_8,sfin_8,cur_log2_6))
                            )
                            else
                                {635}out(io, illegal_parameter)
                        )
                        else
                            {636}out(io, illegal_parameter)
                )
                else
                    {637}out(io, unexpected_message)
            )
            else
                {639}out(io, illegal_parameter)
        )
        else
            {640}if send_kex then
            (
                {641}let id_client_6: idProc = id_client_4 in
                {642}let SH(sr_10: bytes32,mode_2: params) = server_hello_1 in
                {643}let (x_41: bitstring,g_2: group,=true) = kex_data_1 in
                {644}let nego(=TLS13,=tls_h,=tls_a,server_kex_ext(DHE_kex(=g_2,gy_2: element)),=empty_sni_ext,=empty_ech_ext,psk_ext_5: preSharedKeyExt,extra_6: extraExt) = mode_2 in
                (
                    {645}let cur_log2_7: bitstring = (cur_log2_4,server_hello_1) in
                    {646}let v_122: bool = (psk_ext_5 = empty_psk_ext) in
                    {647}let psk_20: preSharedKey = (if v_122 then NoPSK else caught-fail) in
                    {648}let s_15: bitstring = (if v_122 then zero else caught-fail) in
                    {649}let k_10: bitstring = (if v_122 then catch-fail(psk2b(psk_20)) else caught-fail) in
                    {650}let v_123: bool = not-caught-fail(k_10) in
                    {651}let early_secret_11: bitstring = (if v_122 then catch-fail((if v_123 then hmac(tls_h,s_15,k_10) else fail-any)) else caught-fail) in
                    {652}let v_124: bool = not-caught-fail(early_secret_11) in
                    {653}let l_37: label = (if v_124 then tls13_resumption_psk_binder_key else caught-fail) in
                    {654}let m_12: bitstring = (if v_124 then zero else caught-fail) in
                    {655}let h_37: bitstring = (if v_124 then catch-fail(hash(tls_h,m_12)) else caught-fail) in
                    {656}let v_125: bool = not-caught-fail(h_37) in
                    {657}let x_42: bitstring = (if v_125 then (l_37,h_37) else caught-fail) in
                    {658}let binder_key_8: bitstring = (if v_124 then catch-fail((if v_125 then hmac(tls_h,early_secret_11,x_42) else fail-any)) else caught-fail) in
                    {659}let v_126: bool = not-caught-fail(binder_key_8) in
                    {660}let v_127: bitstring = (if v_122 then catch-fail((if v_124 then (if v_126 then (early_secret_11,binder_key_8) else fail-any) else fail-any)) else caught-fail) in
                    {661}let v_128: bool = (not-caught-fail(v_127) && success?(1-proj-2-tuple(v_127))) in
                    {662}let kb_8: mac_key = (if v_128 then 2-proj-2-tuple(v_127) else caught-fail) in
                    {663}let es_9: bitstring = (if v_128 then 1-proj-2-tuple(v_127) else caught-fail) in
                    {664}let v_129: bitstring = (if not(v_122) then catch-fail(psk_data_1) else caught-fail) in
                    {665}let v_130: bool = (not-caught-fail(v_129) && success?(1-proj-3-tuple(v_129))) in
                    {666}let es_10: bitstring = (if v_130 then 3-proj-3-tuple(v_129) else caught-fail) in
                    {667}let psk_21: preSharedKey = (if v_130 then 2-proj-3-tuple(v_129) else caught-fail) in
                    {668}let h'_alg_1: hash_alg = (if v_130 then 1-proj-3-tuple(v_129) else caught-fail) in
                    {669}let (psk_22: preSharedKey,early_secret_12: bitstring,valid_1: bool) = (if v_122 then (if v_128 then (NoPSK,es_9,true) else fail-any) else (if v_130 then (psk_21,es_10,((h'_alg_1 = tls_h) && ((server_psk_ext(1) = psk_ext_5) && use_psk_1))) else fail-any)) in
                    {670}if valid_1 then
                    (
                        {671}let gxy_3: element = catch-fail(dh_decap_fun(g_2,gy_2,x_41)) in
                        {672}let v_131: bool = not-caught-fail(gxy_3) in
                        {673}new s_16[]: seed;
                        {674}let gxy_4: element = (if v_131 then gxy_3 else dh_f(s_16)) in
                        {675}let l_38: label = tls13_derived in
                        {676}let m_13: bitstring = catch-fail(hash(tls_h,zero)) in
                        {677}let v_132: bool = not-caught-fail(m_13) in
                        {678}let h_38: bitstring = (if v_132 then catch-fail(hash(tls_h,m_13)) else caught-fail) in
                        {679}let v_133: bool = not-caught-fail(h_38) in
                        {680}let x_43: bitstring = (if v_133 then (l_38,h_38) else caught-fail) in
                        {681}let extra_7: bitstring = catch-fail((if v_132 then (if v_133 then hmac(tls_h,early_secret_12,x_43) else fail-any) else fail-any)) in
                        {682}let v_134: bool = not-caught-fail(extra_7) in
                        {683}let handshake_secret_2: bitstring = (if v_134 then hmac(tls_h,extra_7,gxy_4) else fail-any) in
                        {684}event SanityClientSH(id_client_6,cr_10,sr_10,c_dom_5,s_dom_6,handshake_secret_2,psk_22,cur_log2_7);
                        {685}let l_39: label = tls13_derived in
                        {686}let m_14: bitstring = catch-fail(hash(tls_h,zero)) in
                        {687}let v_135: bool = not-caught-fail(m_14) in
                        {688}let h_39: bitstring = (if v_135 then catch-fail(hash(tls_h,m_14)) else caught-fail) in
                        {689}let v_136: bool = not-caught-fail(h_39) in
                        {690}let x_44: bitstring = (if v_136 then (l_39,h_39) else caught-fail) in
                        {691}let extra_8: bitstring = catch-fail((if v_135 then (if v_136 then hmac(tls_h,handshake_secret_2,x_44) else fail-any) else fail-any)) in
                        {692}let v_137: bool = not-caught-fail(extra_8) in
                        {693}let k_11: bitstring = (if v_137 then zero else caught-fail) in
                        {694}let master_secret_11: bitstring = (if v_137 then catch-fail(hmac(tls_h,handshake_secret_2,k_11)) else caught-fail) in
                        {695}let v_138: bool = not-caught-fail(master_secret_11) in
                        {696}let l_40: label = (if v_138 then tls13_client_handshake_traffic_secret else caught-fail) in
                        {697}let h_40: bitstring = (if v_138 then catch-fail(hash(tls_h,cur_log2_7)) else caught-fail) in
                        {698}let v_139: bool = not-caught-fail(h_40) in
                        {699}let x_45: bitstring = (if v_139 then (l_40,h_40) else caught-fail) in
                        {700}let client_hts_2: bitstring = (if v_138 then catch-fail((if v_139 then hmac(tls_h,handshake_secret_2,x_45) else fail-any)) else caught-fail) in
                        {701}let v_140: bool = not-caught-fail(client_hts_2) in
                        {702}let l_41: label = (if v_140 then tls13_server_handshake_traffic_secret else caught-fail) in
                        {703}let h_41: bitstring = (if v_140 then catch-fail(hash(tls_h,cur_log2_7)) else caught-fail) in
                        {704}let v_141: bool = not-caught-fail(h_41) in
                        {705}let x_46: bitstring = (if v_141 then (l_41,h_41) else caught-fail) in
                        {706}let server_hts_2: bitstring = (if v_140 then catch-fail((if v_141 then hmac(tls_h,handshake_secret_2,x_46) else fail-any)) else caught-fail) in
                        {707}let v_142: bool = not-caught-fail(server_hts_2) in
                        {708}let l_42: label = (if v_142 then tls13_key else caught-fail) in
                        {709}let h_42: bitstring = (if v_142 then zero else caught-fail) in
                        {710}let x_47: bitstring = (if v_142 then (l_42,h_42) else caught-fail) in
                        {711}let client_wkh_2: bitstring = (if v_142 then catch-fail(hmac(tls_h,client_hts_2,x_47)) else caught-fail) in
                        {712}let v_143: bool = not-caught-fail(client_wkh_2) in
                        {713}let l_43: label = (if v_143 then tls13_key else caught-fail) in
                        {714}let h_43: bitstring = (if v_143 then zero else caught-fail) in
                        {715}let x_48: bitstring = (if v_143 then (l_43,h_43) else caught-fail) in
                        {716}let server_wkh_2: bitstring = (if v_143 then catch-fail(hmac(tls_h,server_hts_2,x_48)) else caught-fail) in
                        {717}let v_144: bool = not-caught-fail(server_wkh_2) in
                        {718}let l_44: label = (if v_144 then tls13_finished else caught-fail) in
                        {719}let h_44: bitstring = (if v_144 then zero else caught-fail) in
                        {720}let x_49: bitstring = (if v_144 then (l_44,h_44) else caught-fail) in
                        {721}let client_fk_2: bitstring = (if v_144 then catch-fail(hmac(tls_h,client_hts_2,x_49)) else caught-fail) in
                        {722}let v_145: bool = not-caught-fail(client_fk_2) in
                        {723}let l_45: label = (if v_145 then tls13_finished else caught-fail) in
                        {724}let h_45: bitstring = (if v_145 then zero else caught-fail) in
                        {725}let x_50: bitstring = (if v_145 then (l_45,h_45) else caught-fail) in
                        {726}let server_fk_2: bitstring = (if v_145 then catch-fail(hmac(tls_h,server_hts_2,x_50)) else caught-fail) in
                        {727}let v_146: bool = not-caught-fail(server_fk_2) in
                        {728}let (master_secret_12: bitstring,chk_9: aead_key,shk_9: aead_key,cfin_9: mac_key,sfin_9: mac_key) = (if v_137 then (if v_138 then (if v_140 then (if v_142 then (if v_143 then (if v_144 then (if v_145 then (if v_146 then (master_secret_11,client_wkh_2,server_wkh_2,client_fk_2,server_fk_2) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
                        {729}in(io, enc_ee_msg_1: bitstring);
                        {730}let ee_msg_2: msg = aead_dec(tls_a,shk_9,zero,zero,enc_ee_msg_1) in
                        {731}let EE(x_51: bitstring) = ee_msg_2 in
                        {732}let cur_log2_8: bitstring = (cur_log2_7,ee_msg_2) in
                        {733}out(ch_client_after_EE, (id_client_6,cr_10,sr_10,tls_h,tls_a,c_dom_5,s_dom_6,psk_22,master_secret_12,chk_9,shk_9,cfin_9,sfin_9,cur_log2_8))
                    )
                    else
                        {734}out(io, illegal_parameter)
                )
                else
                    {735}out(io, illegal_parameter)
            )
            else
                {736}out(io, illegal_parameter)
    )
    else
        {737}out(io, unexpected_message)
) | (
    {739}!
    {740}let use_grease: bool = false in
    {741}let use_psk_2: bool = false in
    {742}let send_kex_2: bool = true in
    {743}in(io, (c_dom_6: domain,cfs_dom: domain,backend_dom: domain));
    {744}event Same((use_grease,use_psk_2,send_kex_2,c_dom_6,cfs_dom,backend_dom));
    {1092}get ech_configurations(ech_config(id_6: configId,g_3: group,pkR_1: element,=cfs_dom,h_alg_9: hash_alg,a_alg_9: aead_alg),skR_1: bitstring) in
    {745}let ech_conf: echConfig = ech_config(id_6,g_3,pkR_1,cfs_dom,h_alg_9,a_alg_9) in
    {746}let i_extra: extraExt = empty_extra_ext in
    {747}let o_extra: extraExt = empty_extra_ext in
    {748}new id_client_7[]: idProc;
    {749}event SanityClient(id_client_7,true,use_grease,use_psk_2,send_kex_2);
    {750}if not((use_grease && use_psk_2)) then
    {751}let i_cur_log: bitstring = zero in
    {752}new s_17[]: seed;
    {753}let gx_6: element = dh_pub(tls_g,dh_k(s_17)) in
    {754}let v_147: bitstring = (dh_k(s_17),gx_6) in
    {755}let v_148: bool = success?(1-proj-2-tuple(v_147)) in
    {756}let i_gx: element = (if v_148 then 2-proj-2-tuple(v_147) else caught-fail) in
    {757}let i_x: bitstring = (if v_148 then 1-proj-2-tuple(v_147) else caught-fail) in
    {758}new s_18[]: seed;
    {759}let gx_7: element = (if v_148 then dh_pub(tls_g,dh_k(s_18)) else caught-fail) in
    {760}let v_149: bitstring = (if v_148 then catch-fail((dh_k(s_18),gx_7)) else caught-fail) in
    {761}let v_150: bool = (not-caught-fail(v_149) && success?(1-proj-2-tuple(v_149))) in
    {762}let o_gx: element = (if v_150 then 2-proj-2-tuple(v_149) else caught-fail) in
    {763}let o_x: bitstring = (if v_150 then 1-proj-2-tuple(v_149) else caught-fail) in
    {764}let v_151: bitstring = (if v_150 then catch-fail((if send_kex_2 then (DHE_kex(tls_g,i_gx),DHE_kex(tls_g,o_gx)) else (DHE_group(tls_g),DHE_group(tls_g)))) else caught-fail) in
    {765}let v_152: bool = (not-caught-fail(v_151) && success?(1-proj-2-tuple(v_151))) in
    {766}let o_kex: kex_alg = (if v_152 then 2-proj-2-tuple(v_151) else caught-fail) in
    {767}let i_kex: kex_alg = (if v_152 then 1-proj-2-tuple(v_151) else caught-fail) in
    {768}let (i_kex_ext: keyShareExt,o_kex_ext: keyShareExt,kex_data_3: bitstring) = (if v_148 then (if v_150 then (if v_152 then (client_kex_ext(i_kex),client_kex_ext(o_kex),(i_x,o_x,tls_g,send_kex_2)) else fail-any) else fail-any) else fail-any) in
    {769}new rand24_3[]: bytes24;
    {770}new rand8_3[]: bytes8;
    {771}let i_cr: bytes32 = B32(rand24_3,rand8_3) in
    {772}let ech_ext_4: echExt = ech_is_inner in
    {1091}get pre_shared_keys(c_dom'_3: domain,s_dom'_3: domain,=tls_h,id_7: identityPsk,internal_psk_2: internal_preSharedKey) in
    {773}event Selected_psk(c_dom_6,c_dom'_3,backend_dom,s_dom'_3,id_7,internal_psk_2);
    {774}let v_153: bool = use_psk_2 in
    {775}let psk_23: preSharedKey = (if v_153 then PSK(internal_psk_2) else caught-fail) in
    {776}let offer_6: params = (if v_153 then nego(TLS13,tls_h,tls_a,i_kex_ext,SNI(backend_dom),ech_ext_4,trunc_client_psk_ext(id_7),i_extra) else caught-fail) in
    {777}let cur_log'_4: bitstring = (if v_153 then (i_cur_log,CH(i_cr,offer_6)) else caught-fail) in
    {778}let s_19: bitstring = (if v_153 then zero else caught-fail) in
    {779}let k_12: bitstring = (if v_153 then catch-fail(psk2b(psk_23)) else caught-fail) in
    {780}let v_154: bool = not-caught-fail(k_12) in
    {781}let early_secret_13: bitstring = (if v_153 then catch-fail((if v_154 then hmac(tls_h,s_19,k_12) else fail-any)) else caught-fail) in
    {782}let v_155: bool = not-caught-fail(early_secret_13) in
    {783}let l_46: label = (if v_155 then tls13_resumption_psk_binder_key else caught-fail) in
    {784}let m_15: bitstring = (if v_155 then zero else caught-fail) in
    {785}let h_46: bitstring = (if v_155 then catch-fail(hash(tls_h,m_15)) else caught-fail) in
    {786}let v_156: bool = not-caught-fail(h_46) in
    {787}let x_52: bitstring = (if v_156 then (l_46,h_46) else caught-fail) in
    {788}let binder_key_9: bitstring = (if v_155 then catch-fail((if v_156 then hmac(tls_h,early_secret_13,x_52) else fail-any)) else caught-fail) in
    {789}let v_157: bool = not-caught-fail(binder_key_9) in
    {790}let v_158: bitstring = (if v_153 then catch-fail((if v_155 then (if v_157 then (early_secret_13,binder_key_9) else fail-any) else fail-any)) else caught-fail) in
    {791}let v_159: bool = (not-caught-fail(v_158) && success?(1-proj-2-tuple(v_158))) in
    {792}let kb_9: mac_key = (if v_159 then 2-proj-2-tuple(v_158) else caught-fail) in
    {793}let es_11: bitstring = (if v_159 then 1-proj-2-tuple(v_158) else caught-fail) in
    {794}let binders_3: bitstring = (if v_159 then catch-fail(hmac(tls_h,kb_9,cur_log'_4)) else caught-fail) in
    {795}let v_160: bool = not-caught-fail(binders_3) in
    {796}let psk_24: preSharedKey = (if not(v_153) then NoPSK else caught-fail) in
    {797}let s_20: bitstring = (if not(v_153) then zero else caught-fail) in
    {798}let k_13: bitstring = (if not(v_153) then catch-fail(psk2b(psk_24)) else caught-fail) in
    {799}let v_161: bool = not-caught-fail(k_13) in
    {800}let early_secret_14: bitstring = (if not(v_153) then catch-fail((if v_161 then hmac(tls_h,s_20,k_13) else fail-any)) else caught-fail) in
    {801}let v_162: bool = not-caught-fail(early_secret_14) in
    {802}let l_47: label = (if v_162 then tls13_resumption_psk_binder_key else caught-fail) in
    {803}let m_16: bitstring = (if v_162 then zero else caught-fail) in
    {804}let h_47: bitstring = (if v_162 then catch-fail(hash(tls_h,m_16)) else caught-fail) in
    {805}let v_163: bool = not-caught-fail(h_47) in
    {806}let x_53: bitstring = (if v_163 then (l_47,h_47) else caught-fail) in
    {807}let binder_key_10: bitstring = (if v_162 then catch-fail((if v_163 then hmac(tls_h,early_secret_14,x_53) else fail-any)) else caught-fail) in
    {808}let v_164: bool = not-caught-fail(binder_key_10) in
    {809}let v_165: bitstring = (if not(v_153) then catch-fail((if v_162 then (if v_164 then (early_secret_14,binder_key_10) else fail-any) else fail-any)) else caught-fail) in
    {810}let v_166: bool = (not-caught-fail(v_165) && success?(1-proj-2-tuple(v_165))) in
    {811}let kb_10: mac_key = (if v_166 then 2-proj-2-tuple(v_165) else caught-fail) in
    {812}let es_12: bitstring = (if v_166 then 1-proj-2-tuple(v_165) else caught-fail) in
    {813}let v_167: bitstring = catch-fail((if v_153 then (if v_159 then (if v_160 then (client_psk_ext(id_7,binders_3),(tls_h,psk_23,es_11)) else fail-any) else fail-any) else (if v_166 then (empty_psk_ext,(tls_h,NoPSK,es_12)) else fail-any))) in
    {814}let v_168: bool = (not-caught-fail(v_167) && success?(1-proj-2-tuple(v_167))) in
    {815}let psk_data_3: bitstring = (if v_168 then 2-proj-2-tuple(v_167) else caught-fail) in
    {816}let psk_ext_6: preSharedKeyExt = (if v_168 then 1-proj-2-tuple(v_167) else caught-fail) in
    {817}let i_offer: params = (if v_168 then nego(TLS13,tls_h,tls_a,i_kex_ext,SNI(backend_dom),ech_is_inner,psk_ext_6,i_extra) else caught-fail) in
    {818}let i_client_hello: msg = (if v_168 then CH(i_cr,i_offer) else caught-fail) in
    {819}let v_169: echConfig = (if v_168 then catch-fail(ech_conf) else caught-fail) in
    {820}let v_170: bool = (not-caught-fail(v_169) && success?(1-proj-ech_config(v_169))) in
    {821}let a_alg_ech: aead_alg = (if v_170 then 6-proj-ech_config(v_169) else caught-fail) in
    {822}let h_alg_ech: hash_alg = (if v_170 then 5-proj-ech_config(v_169) else caught-fail) in
    {823}let o_dom_1: domain = (if v_170 then 4-proj-ech_config(v_169) else caught-fail) in
    {824}let pkR_2: element = (if v_170 then 3-proj-ech_config(v_169) else caught-fail) in
    {825}let g_ech: group = (if v_170 then 2-proj-ech_config(v_169) else caught-fail) in
    {826}let config_id: configId = (if v_170 then 1-proj-ech_config(v_169) else caught-fail) in
    {827}let info: bitstring = (if v_170 then (tls_ech_str,ech_conf) else caught-fail) in
    {828}new s_21[]: seed;
    {829}let v_171: bitstring = (if v_170 then catch-fail((dh_xy(s_21,pkR_2),dh_encap_fun(g_ech,pkR_2,dh_xy(s_21,pkR_2)))) else caught-fail) in
    {830}let v_172: bool = (not-caught-fail(v_171) && success?(1-proj-2-tuple(v_171))) in
    {831}let enc: element = (if v_172 then 2-proj-2-tuple(v_171) else caught-fail) in
    {832}let shared_secret: element = (if v_172 then 1-proj-2-tuple(v_171) else caught-fail) in
    {833}let m_17: hpkeMode = (if v_172 then S else caught-fail) in
    {834}let s_22: bitstring = (if v_172 then zero else caught-fail) in
    {835}let k_14: bitstring = (if v_172 then (hpke_info_hash,info) else caught-fail) in
    {836}let info_hash: bitstring = (if v_172 then catch-fail(hmac(h_alg_ech,s_22,k_14)) else caught-fail) in
    {837}let v_173: bool = not-caught-fail(info_hash) in
    {838}let k_15: bitstring = (if v_173 then (hpke_secret,zero) else caught-fail) in
    {839}let xsecret: bitstring = (if v_173 then catch-fail(hmac(h_alg_ech,shared_secret,k_15)) else caught-fail) in
    {840}let v_174: bool = not-caught-fail(xsecret) in
    {841}let l_48: label = (if v_174 then hpke_key else caught-fail) in
    {842}let x_54: bitstring = (if v_174 then (l_48,info_hash) else caught-fail) in
    {843}let key: aead_key = (if v_174 then catch-fail(hmac(h_alg_ech,xsecret,x_54)) else caught-fail) in
    {844}let v_175: bool = not-caught-fail(key) in
    {845}let l_49: label = (if v_175 then hpke_base_nonce else caught-fail) in
    {846}let x_55: bitstring = (if v_175 then (l_49,info_hash) else caught-fail) in
    {847}let base_nonce: bitstring = (if v_175 then catch-fail(hmac(h_alg_ech,xsecret,x_55)) else caught-fail) in
    {848}let v_176: bool = not-caught-fail(base_nonce) in
    {849}let l_50: label = (if v_176 then hpke_exp else caught-fail) in
    {850}let x_56: bitstring = (if v_176 then (l_50,info_hash) else caught-fail) in
    {851}let exporter_secret: bitstring = (if v_176 then catch-fail(hmac(h_alg_ech,xsecret,x_56)) else caught-fail) in
    {852}let v_177: bool = not-caught-fail(exporter_secret) in
    {853}let v_178: bitstring = (if v_170 then catch-fail((if v_172 then (enc,(if v_173 then (if v_174 then (if v_175 then (if v_176 then (if v_177 then hpke_context(m_17,key) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) else fail-any)) else caught-fail) in
    {854}let v_179: bool = (not-caught-fail(v_178) && success?(1-proj-2-tuple(v_178))) in
    {855}let context: hpkeContext = (if v_179 then 2-proj-2-tuple(v_178) else caught-fail) in
    {856}let enc_1: element = (if v_179 then 1-proj-2-tuple(v_178) else caught-fail) in
    {857}new rand24_4[]: bytes24;
    {858}new rand8_4[]: bytes8;
    {859}let o_cr: bytes32 = (if v_179 then B32(rand24_4,rand8_4) else caught-fail) in
    {860}let v_180: bool = (if v_179 then catch-fail(use_grease) else caught-fail) in
    {861}new payload[]: bitstring;
    {862}let ech_ext_5: echExt = (if v_180 then client_ECH(h_alg_ech,a_alg_ech,config_id,enc_1,payload) else caught-fail) in
    {863}let o_offer: params = (if v_180 then nego(TLS13,tls_h,tls_a,o_kex_ext,SNI(o_dom_1),ech_ext_5,empty_psk_ext,o_extra) else caught-fail) in
    {864}let dummy_ech_ext: echExt = (if is-false(v_180) then client_ECH(h_alg_ech,a_alg_ech,config_id,enc_1,zero) else caught-fail) in
    {865}let o_offer1: params = (if is-false(v_180) then nego(TLS13,tls_h,tls_a,o_kex_ext,SNI(o_dom_1),dummy_ech_ext,empty_psk_ext,o_extra) else caught-fail) in
    {866}let o_client_hello1: msg = (if is-false(v_180) then CH(o_cr,o_offer1) else caught-fail) in
    {867}let v_181: msg = (if is-false(v_180) then catch-fail(o_client_hello1) else caught-fail) in
    {868}let v_182: bool = (not-caught-fail(v_181) && (success?(1-proj-nego(2-proj-CH(v_181))) && success?(1-proj-CH(v_181)))) in
    {869}let extra_9: extraExt = (if v_182 then 8-proj-nego(2-proj-CH(v_181)) else caught-fail) in
    {870}let psk_ext_7: preSharedKeyExt = (if v_182 then 7-proj-nego(2-proj-CH(v_181)) else caught-fail) in
    {871}let ech_ext_6: echExt = (if v_182 then 6-proj-nego(2-proj-CH(v_181)) else caught-fail) in
    {872}let sni_ext_2: sniExt = (if v_182 then 5-proj-nego(2-proj-CH(v_181)) else caught-fail) in
    {873}let kex_ext_4: keyShareExt = (if v_182 then 4-proj-nego(2-proj-CH(v_181)) else caught-fail) in
    {874}let a_alg_10: aead_alg = (if v_182 then 3-proj-nego(2-proj-CH(v_181)) else caught-fail) in
    {875}let h_alg_10: hash_alg = (if v_182 then 2-proj-nego(2-proj-CH(v_181)) else caught-fail) in
    {876}let version: TLS_version = (if v_182 then 1-proj-nego(2-proj-CH(v_181)) else caught-fail) in
    {877}let r: bytes32 = (if v_182 then 1-proj-CH(v_181) else caught-fail) in
    {878}let v_183: echExt = (if v_182 then catch-fail(ech_ext_6) else caught-fail) in
    {879}let v_184: bool = (not-caught-fail(v_183) && success?(1-proj-client_ECH(v_183))) in
    {880}let payload_1: bitstring = (if v_184 then 5-proj-client_ECH(v_183) else caught-fail) in
    {881}let enc_2: element = (if v_184 then 4-proj-client_ECH(v_183) else caught-fail) in
    {882}let config_id_1: configId = (if v_184 then 3-proj-client_ECH(v_183) else caught-fail) in
    {883}let a_alg_ech_1: aead_alg = (if v_184 then 2-proj-client_ECH(v_183) else caught-fail) in
    {884}let h_alg_ech_1: hash_alg = (if v_184 then 1-proj-client_ECH(v_183) else caught-fail) in
    {885}let client_hello_outer': msg = (if v_184 then CH(r,nego(version,h_alg_10,a_alg_10,kex_ext_4,sni_ext_2,empty_ech_ext,psk_ext_7,extra_9)) else caught-fail) in
    {886}let client_hello_AAD: ClientHelloOuterAAD = (if is-false(v_180) then catch-fail((if v_182 then (if v_184 then client_hello_outer_AAD(h_alg_ech_1,a_alg_ech_1,config_id_1,enc_2,client_hello_outer') else fail-any) else fail-any)) else caught-fail) in
    {887}let v_185: bool = not-caught-fail(client_hello_AAD) in
    {888}let v_186: hpkeContext = (if v_185 then catch-fail(context) else caught-fail) in
    {889}let v_187: bool = (not-caught-fail(v_186) && ((S =nf 1-proj-hpke_context(v_186)) && success?(1-proj-hpke_context(v_186)))) in
    {890}let key_1: aead_key = (if v_187 then 2-proj-hpke_context(v_186) else caught-fail) in
    {891}let payload_2: bitstring = (if v_185 then catch-fail((if v_187 then aead_enc(a_alg_ech,key_1,nonce_for_seal_open,client_hello_AAD,i_client_hello) else fail-any)) else caught-fail) in
    {892}let v_188: bool = not-caught-fail(payload_2) in
    {893}let ech_ext_7: echExt = (if v_188 then client_ECH(h_alg_ech,a_alg_ech,config_id,enc_1,payload_2) else caught-fail) in
    {894}let o_offer_1: params = (if v_188 then nego(TLS13,tls_h,tls_a,o_kex_ext,SNI(o_dom_1),ech_ext_7,empty_psk_ext,o_extra) else caught-fail) in
    {895}let (o_client_hello: msg,i_client_hello_1: msg,i_cr_1: bytes32,o_cr_1: bytes32,i_kex_ext_1: keyShareExt,o_kex_ext_1: keyShareExt,kex_data_4: bitstring,psk_data_4: bitstring) = (if v_168 then (if v_170 then (if v_179 then (if undo-catch-fail(v_180) then (CH(o_cr,o_offer),CH(o_cr,o_offer),o_cr,o_cr,o_kex_ext,o_kex_ext,kex_data_3,psk_data_3) else (if v_185 then (if v_188 then (CH(o_cr,o_offer_1),i_client_hello,i_cr,o_cr,i_kex_ext,o_kex_ext,kex_data_3,psk_data_3) else fail-any) else fail-any)) else fail-any) else fail-any) else fail-any) in
    {896}out(io, o_client_hello);
    {897}let (=tls_h,psk_25: preSharedKey,es_13: bitstring) = psk_data_4 in
    {898}let v_189: echConfig = ech_conf in
    {899}let v_190: bool = success?(1-proj-ech_config(v_189)) in
    {900}let al: aead_alg = (if v_190 then 6-proj-ech_config(v_189) else caught-fail) in
    {901}let hl: hash_alg = (if v_190 then 5-proj-ech_config(v_189) else caught-fail) in
    {902}let dom: domain = (if v_190 then 4-proj-ech_config(v_189) else caught-fail) in
    {903}let public_key: element = (if v_190 then 3-proj-ech_config(v_189) else caught-fail) in
    {904}let g_4: group = (if v_190 then 2-proj-ech_config(v_189) else caught-fail) in
    {905}let id_8: configId = (if v_190 then 1-proj-ech_config(v_189) else caught-fail) in
    {906}let o_dom_2: domain = (if v_190 then dom else fail-any) in
    {907}let v_191: echConfig = ech_conf in
    {908}let v_192: bool = success?(1-proj-ech_config(v_191)) in
    {909}let al_1: aead_alg = (if v_192 then 6-proj-ech_config(v_191) else caught-fail) in
    {910}let hl_1: hash_alg = (if v_192 then 5-proj-ech_config(v_191) else caught-fail) in
    {911}let dom_1: domain = (if v_192 then 4-proj-ech_config(v_191) else caught-fail) in
    {912}let public_key_1: element = (if v_192 then 3-proj-ech_config(v_191) else caught-fail) in
    {913}let g_5: group = (if v_192 then 2-proj-ech_config(v_191) else caught-fail) in
    {914}let id_9: configId = (if v_192 then 1-proj-ech_config(v_191) else caught-fail) in
    {915}let ech_pk: element = (if v_192 then public_key_1 else fail-any) in
    {916}event SanityClientCH_ECH(id_client_7,zero32,i_cr_1,o_cr_1,c_dom_6,o_dom_2,backend_dom,ech_pk,psk_25,(zero,o_client_hello),(zero,i_client_hello_1));
    {917}in(io, server_hello_2: msg);
    {918}let SH(sr_11: bytes32,mode_3: params) = server_hello_2 in
    (
        {919}if (sr_11 = rand_HelloRetryRequest) then
            {920}out(io, illegal_parameter)
        else
            {921}let v_193: echConfig = ech_conf in
            {922}let v_194: bool = success?(1-proj-ech_config(v_193)) in
            {923}let al_2: aead_alg = (if v_194 then 6-proj-ech_config(v_193) else caught-fail) in
            {924}let hl_2: hash_alg = (if v_194 then 5-proj-ech_config(v_193) else caught-fail) in
            {925}let dom_2: domain = (if v_194 then 4-proj-ech_config(v_193) else caught-fail) in
            {926}let public_key_2: element = (if v_194 then 3-proj-ech_config(v_193) else caught-fail) in
            {927}let g_6: group = (if v_194 then 2-proj-ech_config(v_193) else caught-fail) in
            {928}let id_10: configId = (if v_194 then 1-proj-ech_config(v_193) else caught-fail) in
            {929}let id_client_8: idProc = id_client_7 in
            {930}let o_dom_3: domain = (if v_194 then dom_2 else fail-any) in
            {931}let i_cur_log_1: bitstring = (zero,i_client_hello_1) in
            {932}let o_cur_log: bitstring = (zero,o_client_hello) in
            {933}let SH(B32(sr24_1: bytes24,sr8_1: bytes8),mode_4: params) = server_hello_2 in
            {934}let (i_x_1: bitstring,o_x_1: bitstring,g_7: group,=true) = kex_data_4 in
            {935}let nego(=TLS13,=tls_h,=tls_a,server_kex_ext(DHE_kex(=g_7,gy_srv: element)),=empty_sni_ext,=empty_ech_ext,psk_ext_8: preSharedKeyExt,extra_10: extraExt) = mode_4 in
            (
                {936}let v_195: bool = (psk_ext_8 = empty_psk_ext) in
                {937}let psk_26: preSharedKey = (if v_195 then NoPSK else caught-fail) in
                {938}let s_23: bitstring = (if v_195 then zero else caught-fail) in
                {939}let k_16: bitstring = (if v_195 then catch-fail(psk2b(psk_26)) else caught-fail) in
                {940}let v_196: bool = not-caught-fail(k_16) in
                {941}let early_secret_15: bitstring = (if v_195 then catch-fail((if v_196 then hmac(tls_h,s_23,k_16) else fail-any)) else caught-fail) in
                {942}let v_197: bool = not-caught-fail(early_secret_15) in
                {943}let l_51: label = (if v_197 then tls13_resumption_psk_binder_key else caught-fail) in
                {944}let m_18: bitstring = (if v_197 then zero else caught-fail) in
                {945}let h_48: bitstring = (if v_197 then catch-fail(hash(tls_h,m_18)) else caught-fail) in
                {946}let v_198: bool = not-caught-fail(h_48) in
                {947}let x_57: bitstring = (if v_198 then (l_51,h_48) else caught-fail) in
                {948}let binder_key_11: bitstring = (if v_197 then catch-fail((if v_198 then hmac(tls_h,early_secret_15,x_57) else fail-any)) else caught-fail) in
                {949}let v_199: bool = not-caught-fail(binder_key_11) in
                {950}let v_200: bitstring = (if v_195 then catch-fail((if v_197 then (if v_199 then (early_secret_15,binder_key_11) else fail-any) else fail-any)) else caught-fail) in
                {951}let v_201: bool = (not-caught-fail(v_200) && success?(1-proj-2-tuple(v_200))) in
                {952}let kb_11: mac_key = (if v_201 then 2-proj-2-tuple(v_200) else caught-fail) in
                {953}let es_14: bitstring = (if v_201 then 1-proj-2-tuple(v_200) else caught-fail) in
                {954}let v_202: bitstring = (if not(v_195) then catch-fail(psk_data_4) else caught-fail) in
                {955}let v_203: bool = (not-caught-fail(v_202) && success?(1-proj-3-tuple(v_202))) in
                {956}let es_15: bitstring = (if v_203 then 3-proj-3-tuple(v_202) else caught-fail) in
                {957}let psk_27: preSharedKey = (if v_203 then 2-proj-3-tuple(v_202) else caught-fail) in
                {958}let h'_alg_2: hash_alg = (if v_203 then 1-proj-3-tuple(v_202) else caught-fail) in
                {959}let (psk_28: preSharedKey,early_secret_16: bitstring,valid_2: bool) = (if v_195 then (if v_201 then (NoPSK,es_14,true) else fail-any) else (if v_203 then (psk_27,es_15,((h'_alg_2 = tls_h) && ((server_psk_ext(1) = psk_ext_8) && use_psk_2))) else fail-any)) in
                {960}if valid_2 then
                (
                    {961}let v_204: bool = use_grease in
                    {962}let gxy_5: element = (if not(v_204) then catch-fail(dh_decap_fun(g_7,gy_srv,i_x_1)) else caught-fail) in
                    {963}let v_205: bool = not-caught-fail(gxy_5) in
                    {964}new s_24[]: seed;
                    {965}let i_gxy: element = (if not(v_204) then (if v_205 then gxy_5 else dh_f(s_24)) else caught-fail) in
                    {966}let l_52: label = (if not(v_204) then tls13_derived else caught-fail) in
                    {967}let m_19: bitstring = (if not(v_204) then catch-fail(hash(tls_h,zero)) else caught-fail) in
                    {968}let v_206: bool = not-caught-fail(m_19) in
                    {969}let h_49: bitstring = (if v_206 then catch-fail(hash(tls_h,m_19)) else caught-fail) in
                    {970}let v_207: bool = not-caught-fail(h_49) in
                    {971}let x_58: bitstring = (if v_207 then (l_52,h_49) else caught-fail) in
                    {972}let extra_11: bitstring = (if not(v_204) then catch-fail((if v_206 then (if v_207 then hmac(tls_h,early_secret_16,x_58) else fail-any) else fail-any)) else caught-fail) in
                    {973}let v_208: bool = not-caught-fail(extra_11) in
                    {974}let i_handshake_secret: bitstring = (if not(v_204) then catch-fail((if v_208 then hmac(tls_h,extra_11,i_gxy) else fail-any)) else caught-fail) in
                    {975}let v_209: bool = not-caught-fail(i_handshake_secret) in
                    {976}let SH_ECHConf_1: msg = (if v_209 then SH(B32(sr24_1,zero8),mode_4) else caught-fail) in
                    {977}let l_53: label = (if v_209 then ech_accept_confirmation else caught-fail) in
                    {978}let m_20: bitstring = (if v_209 then (i_cur_log_1,SH_ECHConf_1) else caught-fail) in
                    {979}let h_50: bitstring = (if v_209 then catch-fail(hash(tls_h,m_20)) else caught-fail) in
                    {980}let v_210: bool = not-caught-fail(h_50) in
                    {981}let x_59: bitstring = (if v_210 then (l_53,h_50) else caught-fail) in
                    {982}let accept_confirmation_1: bitstring = (if v_209 then catch-fail((if v_210 then hmac(tls_h,i_handshake_secret,x_59) else fail-any)) else caught-fail) in
                    {983}let v_211: bool = not-caught-fail(accept_confirmation_1) in
                    {984}let is_accepted: bool = (if v_204 then false else (if v_209 then (if v_211 then (sr8_1 = crop_into_bytes8(accept_confirmation_1)) else fail-any) else fail-any)) in
                    {985}let v_212: bool = is_accepted in
                    {986}let gxy_6: element = (if v_212 then catch-fail(dh_decap_fun(g_7,gy_srv,i_x_1)) else caught-fail) in
                    {987}let v_213: bool = not-caught-fail(gxy_6) in
                    {988}new s_25[]: seed;
                    {989}let i_gxy_1: element = (if v_212 then (if v_213 then gxy_6 else dh_f(s_25)) else caught-fail) in
                    {990}let l_54: label = (if v_212 then tls13_derived else caught-fail) in
                    {991}let m_21: bitstring = (if v_212 then catch-fail(hash(tls_h,zero)) else caught-fail) in
                    {992}let v_214: bool = not-caught-fail(m_21) in
                    {993}let h_51: bitstring = (if v_214 then catch-fail(hash(tls_h,m_21)) else caught-fail) in
                    {994}let v_215: bool = not-caught-fail(h_51) in
                    {995}let x_60: bitstring = (if v_215 then (l_54,h_51) else caught-fail) in
                    {996}let extra_12: bitstring = (if v_212 then catch-fail((if v_214 then (if v_215 then hmac(tls_h,early_secret_16,x_60) else fail-any) else fail-any)) else caught-fail) in
                    {997}let v_216: bool = not-caught-fail(extra_12) in
                    {998}let i_handshake_secret_1: bitstring = (if v_212 then catch-fail((if v_216 then hmac(tls_h,extra_12,i_gxy_1) else fail-any)) else caught-fail) in
                    {999}let v_217: bool = not-caught-fail(i_handshake_secret_1) in
                    {1000}let gxy_7: element = (if not(v_212) then catch-fail(dh_decap_fun(g_7,gy_srv,o_x_1)) else caught-fail) in
                    {1001}let v_218: bool = not-caught-fail(gxy_7) in
                    {1002}new s_26[]: seed;
                    {1003}let o_gxy: element = (if not(v_212) then (if v_218 then gxy_7 else dh_f(s_26)) else caught-fail) in
                    {1004}let psk_29: preSharedKey = (if not(v_212) then NoPSK else caught-fail) in
                    {1005}let s_27: bitstring = (if not(v_212) then zero else caught-fail) in
                    {1006}let k_17: bitstring = (if not(v_212) then catch-fail(psk2b(psk_29)) else caught-fail) in
                    {1007}let v_219: bool = not-caught-fail(k_17) in
                    {1008}let early_secret_17: bitstring = (if not(v_212) then catch-fail((if v_219 then hmac(tls_h,s_27,k_17) else fail-any)) else caught-fail) in
                    {1009}let v_220: bool = not-caught-fail(early_secret_17) in
                    {1010}let l_55: label = (if v_220 then tls13_resumption_psk_binder_key else caught-fail) in
                    {1011}let m_22: bitstring = (if v_220 then zero else caught-fail) in
                    {1012}let h_52: bitstring = (if v_220 then catch-fail(hash(tls_h,m_22)) else caught-fail) in
                    {1013}let v_221: bool = not-caught-fail(h_52) in
                    {1014}let x_61: bitstring = (if v_221 then (l_55,h_52) else caught-fail) in
                    {1015}let binder_key_12: bitstring = (if v_220 then catch-fail((if v_221 then hmac(tls_h,early_secret_17,x_61) else fail-any)) else caught-fail) in
                    {1016}let v_222: bool = not-caught-fail(binder_key_12) in
                    {1017}let v_223: bitstring = (if not(v_212) then catch-fail((if v_220 then (if v_222 then (early_secret_17,binder_key_12) else fail-any) else fail-any)) else caught-fail) in
                    {1018}let v_224: bool = (not-caught-fail(v_223) && success?(1-proj-2-tuple(v_223))) in
                    {1019}let kb_12: mac_key = (if v_224 then 2-proj-2-tuple(v_223) else caught-fail) in
                    {1020}let es_16: bitstring = (if v_224 then 1-proj-2-tuple(v_223) else caught-fail) in
                    {1021}let l_56: label = (if v_224 then tls13_derived else caught-fail) in
                    {1022}let m_23: bitstring = (if v_224 then catch-fail(hash(tls_h,zero)) else caught-fail) in
                    {1023}let v_225: bool = not-caught-fail(m_23) in
                    {1024}let h_53: bitstring = (if v_225 then catch-fail(hash(tls_h,m_23)) else caught-fail) in
                    {1025}let v_226: bool = not-caught-fail(h_53) in
                    {1026}let x_62: bitstring = (if v_226 then (l_56,h_53) else caught-fail) in
                    {1027}let extra_13: bitstring = (if v_224 then catch-fail((if v_225 then (if v_226 then hmac(tls_h,es_16,x_62) else fail-any) else fail-any)) else caught-fail) in
                    {1028}let v_227: bool = not-caught-fail(extra_13) in
                    {1029}let (cr_12: bytes32,handshake_secret_3: bitstring,s_dom_7: domain,cur_log_9: bitstring) = (if v_212 then (if v_217 then (i_cr_1,i_handshake_secret_1,backend_dom,(i_cur_log_1,server_hello_2)) else fail-any) else (if v_224 then (o_cr_1,(if v_227 then hmac(tls_h,extra_13,o_gxy) else fail-any),o_dom_3,(o_cur_log,server_hello_2)) else fail-any)) in
                    {1030}let l_57: label = tls13_derived in
                    {1031}let m_24: bitstring = catch-fail(hash(tls_h,zero)) in
                    {1032}let v_228: bool = not-caught-fail(m_24) in
                    {1033}let h_54: bitstring = (if v_228 then catch-fail(hash(tls_h,m_24)) else caught-fail) in
                    {1034}let v_229: bool = not-caught-fail(h_54) in
                    {1035}let x_63: bitstring = (if v_229 then (l_57,h_54) else caught-fail) in
                    {1036}let extra_14: bitstring = catch-fail((if v_228 then (if v_229 then hmac(tls_h,handshake_secret_3,x_63) else fail-any) else fail-any)) in
                    {1037}let v_230: bool = not-caught-fail(extra_14) in
                    {1038}let k_18: bitstring = (if v_230 then zero else caught-fail) in
                    {1039}let master_secret_13: bitstring = (if v_230 then catch-fail(hmac(tls_h,handshake_secret_3,k_18)) else caught-fail) in
                    {1040}let v_231: bool = not-caught-fail(master_secret_13) in
                    {1041}let l_58: label = (if v_231 then tls13_client_handshake_traffic_secret else caught-fail) in
                    {1042}let h_55: bitstring = (if v_231 then catch-fail(hash(tls_h,cur_log_9)) else caught-fail) in
                    {1043}let v_232: bool = not-caught-fail(h_55) in
                    {1044}let x_64: bitstring = (if v_232 then (l_58,h_55) else caught-fail) in
                    {1045}let client_hts_3: bitstring = (if v_231 then catch-fail((if v_232 then hmac(tls_h,handshake_secret_3,x_64) else fail-any)) else caught-fail) in
                    {1046}let v_233: bool = not-caught-fail(client_hts_3) in
                    {1047}let l_59: label = (if v_233 then tls13_server_handshake_traffic_secret else caught-fail) in
                    {1048}let h_56: bitstring = (if v_233 then catch-fail(hash(tls_h,cur_log_9)) else caught-fail) in
                    {1049}let v_234: bool = not-caught-fail(h_56) in
                    {1050}let x_65: bitstring = (if v_234 then (l_59,h_56) else caught-fail) in
                    {1051}let server_hts_3: bitstring = (if v_233 then catch-fail((if v_234 then hmac(tls_h,handshake_secret_3,x_65) else fail-any)) else caught-fail) in
                    {1052}let v_235: bool = not-caught-fail(server_hts_3) in
                    {1053}let l_60: label = (if v_235 then tls13_key else caught-fail) in
                    {1054}let h_57: bitstring = (if v_235 then zero else caught-fail) in
                    {1055}let x_66: bitstring = (if v_235 then (l_60,h_57) else caught-fail) in
                    {1056}let client_wkh_3: bitstring = (if v_235 then catch-fail(hmac(tls_h,client_hts_3,x_66)) else caught-fail) in
                    {1057}let v_236: bool = not-caught-fail(client_wkh_3) in
                    {1058}let l_61: label = (if v_236 then tls13_key else caught-fail) in
                    {1059}let h_58: bitstring = (if v_236 then zero else caught-fail) in
                    {1060}let x_67: bitstring = (if v_236 then (l_61,h_58) else caught-fail) in
                    {1061}let server_wkh_3: bitstring = (if v_236 then catch-fail(hmac(tls_h,server_hts_3,x_67)) else caught-fail) in
                    {1062}let v_237: bool = not-caught-fail(server_wkh_3) in
                    {1063}let l_62: label = (if v_237 then tls13_finished else caught-fail) in
                    {1064}let h_59: bitstring = (if v_237 then zero else caught-fail) in
                    {1065}let x_68: bitstring = (if v_237 then (l_62,h_59) else caught-fail) in
                    {1066}let client_fk_3: bitstring = (if v_237 then catch-fail(hmac(tls_h,client_hts_3,x_68)) else caught-fail) in
                    {1067}let v_238: bool = not-caught-fail(client_fk_3) in
                    {1068}let l_63: label = (if v_238 then tls13_finished else caught-fail) in
                    {1069}let h_60: bitstring = (if v_238 then zero else caught-fail) in
                    {1070}let x_69: bitstring = (if v_238 then (l_63,h_60) else caught-fail) in
                    {1071}let server_fk_3: bitstring = (if v_238 then catch-fail(hmac(tls_h,server_hts_3,x_69)) else caught-fail) in
                    {1072}let v_239: bool = not-caught-fail(server_fk_3) in
                    {1073}let (master_secret_14: bitstring,chk_10: aead_key,shk_10: aead_key,cfin_10: mac_key,sfin_10: mac_key) = (if v_230 then (if v_231 then (if v_233 then (if v_235 then (if v_236 then (if v_237 then (if v_238 then (if v_239 then (master_secret_13,client_wkh_3,server_wkh_3,client_fk_3,server_fk_3) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
                    {1074}event SanityClientSH(id_client_8,cr_12,B32(sr24_1,sr8_1),c_dom_6,s_dom_7,handshake_secret_3,psk_28,cur_log_9);
                    {1075}if (is_accepted || (psk_ext_8 = empty_psk_ext)) then
                    (
                        {1076}let sr_12: bytes32 = B32(sr24_1,sr8_1) in
                        {1077}in(io, enc_ee_msg_2: bitstring);
                        {1078}let ee_msg_3: msg = aead_dec(tls_a,shk_10,zero,zero,enc_ee_msg_2) in
                        {1079}let EE(x_70: bitstring) = ee_msg_3 in
                        {1080}let v_240: bool = not(is_accepted) in
                        {1081}let v_241: bitstring = (if v_240 then catch-fail(x_70) else caught-fail) in
                        {1082}let v_242: bool = (not-caught-fail(v_241) && success?(1-proj-server_ECH(v_241))) in
                        {1083}let ech_conf_1: echConfig = (if v_242 then 1-proj-server_ECH(v_241) else caught-fail) in
                        {1084}let update_ech_conf: bitstring = (if v_240 then (if v_242 then () else ()) else ()) in
                        {1085}let cur_log2_9: bitstring = (cur_log_9,ee_msg_3) in
                        {1086}out(ch_client_after_EE, (id_client_8,cr_12,sr_12,tls_h,tls_a,c_dom_6,s_dom_7,psk_28,master_secret_14,chk_10,shk_10,cfin_10,sfin_10,cur_log2_9))
                    )
                    else
                        {1087}out(io, illegal_parameter)
                )
                else
                    {1088}out(io, illegal_parameter)
            )
            else
                {1089}out(io, illegal_parameter)
    )
    else
        {1090}out(io, unexpected_message)
) | (
    {1093}!
    {1094}let use_psk_3: bool = false in
    {1095}let cert_req_5: bool = true in
    {1096}in(io, (use_ech: bool,s_dom_8: domain));
    {1097}event Same((use_ech,use_psk_3,cert_req_5,s_dom_8));
    {1098}let s_extra_1: extraExt = empty_extra_ext in
    {1099}new id_server_4[]: idProc;
    {1100}event SanityServer(id_server_4,use_ech,use_psk_3,cert_req_5);
    {1101}if not((use_psk_3 && cert_req_5)) then
    {1102}in(io, x_client_hello: msg);
    {1103}let CH(cr_13: bytes32,offer_7: params) = x_client_hello in
    (
        {1104}let nego(=TLS13,c_h_alg: hash_alg,c_a_alg: aead_alg,kex_ext_5: keyShareExt,sni_ext_3: sniExt,ech_ext_8: echExt,psk_ext_9: preSharedKeyExt,extra_ext_2: extraExt) = offer_7 in
        {1105}if ((c_h_alg = tls_h) && (c_a_alg = tls_a)) then
        (
            {1106}let client_kex_ext(DHE_group(=tls_g)) = kex_ext_5 in
            (
                {1107}if (sni_ext_3 = SNI(s_dom_8)) then
                (
                    {1108}if use_ech then
                        {1109}out(io, abort_error)
                    else
                        {1110}let hrr_mode: params = nego(TLS13,tls_h,tls_a,hrr_kex_ext(tls_g),empty_sni_ext,empty_ech_ext,empty_psk_ext,empty_extra_ext) in
                        {1111}let hello_retry_request: msg = SH(rand_HelloRetryRequest,hrr_mode) in
                        {1112}out(io, hello_retry_request);
                        {1113}let cur_log_HRR: bitstring = ((zero,x_client_hello),hello_retry_request) in
                        {1114}event SanityServerHRR(id_server_4,cr_13,s_dom_8,cur_log_HRR);
                        {1115}in(io, client_hello'_1: msg);
                        {1116}let CH(cr'_1: bytes32,offer': params) = client_hello'_1 in
                            {1117}out(ch_server_SH, (id_server_4,use_psk_3,false,cert_req_5,s_dom_8,tls_g,tls_h,tls_a,s_extra_1,zero,client_hello'_1,cur_log_HRR))
                        else
                            {1118}out(io, unexpected_message)
                )
                else
                    {1119}out(io, illegal_parameter)
            )
            else
                {1120}let client_kex_ext(DHE_kex(=tls_g,gx_8: element)) = kex_ext_5 in
                (
                    {1121}let (client_ECH(ech_h_alg: hash_alg,ech_aead_alg: aead_alg,config_id_2: configId,enc_3: element,payload_3: bitstring),=true) = (ech_ext_8,use_ech) in
                    (
                        {1122}let id_server_5: idProc = id_server_4 in
                        {1123}let CH(r_1: bytes32,offer_8: params) = x_client_hello in
                        {1124}let nego(=TLS13,=tls_h,=tls_a,kex_ext_6: keyShareExt,sni_ext_4: sniExt,ech_ext_9: echExt,=empty_psk_ext,extra_ext_3: extraExt) = offer_8 in
                        {1125}let client_ECH(ech_h_alg_1: hash_alg,ech_a_alg: aead_alg,config_id_3: configId,enc_4: element,payload_4: bitstring) = ech_ext_9 in
                        {1249}get ech_configurations(ech_config(=config_id_3,ech_g_1: group,pkR_3: element,=s_dom_8,=ech_h_alg_1,=ech_a_alg),skR_2: bitstring) in
                        (
                            {1126}let ech_conf_2: echConfig = ech_config(config_id_3,ech_g_1,pkR_3,s_dom_8,ech_h_alg_1,ech_a_alg) in
                            {1127}let v_243: msg = x_client_hello in
                            {1128}let v_244: bool = (success?(1-proj-nego(2-proj-CH(v_243))) && success?(1-proj-CH(v_243))) in
                            {1129}let extra_15: extraExt = (if v_244 then 8-proj-nego(2-proj-CH(v_243)) else caught-fail) in
                            {1130}let psk_ext_10: preSharedKeyExt = (if v_244 then 7-proj-nego(2-proj-CH(v_243)) else caught-fail) in
                            {1131}let ech_ext_10: echExt = (if v_244 then 6-proj-nego(2-proj-CH(v_243)) else caught-fail) in
                            {1132}let sni_ext_5: sniExt = (if v_244 then 5-proj-nego(2-proj-CH(v_243)) else caught-fail) in
                            {1133}let kex_ext_7: keyShareExt = (if v_244 then 4-proj-nego(2-proj-CH(v_243)) else caught-fail) in
                            {1134}let a_alg_11: aead_alg = (if v_244 then 3-proj-nego(2-proj-CH(v_243)) else caught-fail) in
                            {1135}let h_alg_11: hash_alg = (if v_244 then 2-proj-nego(2-proj-CH(v_243)) else caught-fail) in
                            {1136}let version_1: TLS_version = (if v_244 then 1-proj-nego(2-proj-CH(v_243)) else caught-fail) in
                            {1137}let r_2: bytes32 = (if v_244 then 1-proj-CH(v_243) else caught-fail) in
                            {1138}let v_245: echExt = (if v_244 then catch-fail(ech_ext_10) else caught-fail) in
                            {1139}let v_246: bool = (not-caught-fail(v_245) && success?(1-proj-client_ECH(v_245))) in
                            {1140}let payload_5: bitstring = (if v_246 then 5-proj-client_ECH(v_245) else caught-fail) in
                            {1141}let enc_5: element = (if v_246 then 4-proj-client_ECH(v_245) else caught-fail) in
                            {1142}let config_id_4: configId = (if v_246 then 3-proj-client_ECH(v_245) else caught-fail) in
                            {1143}let a_alg_ech_2: aead_alg = (if v_246 then 2-proj-client_ECH(v_245) else caught-fail) in
                            {1144}let h_alg_ech_2: hash_alg = (if v_246 then 1-proj-client_ECH(v_245) else caught-fail) in
                            {1145}let client_hello_outer'_1: msg = (if v_246 then CH(r_2,nego(version_1,h_alg_11,a_alg_11,kex_ext_7,sni_ext_5,empty_ech_ext,psk_ext_10,extra_15)) else caught-fail) in
                            {1146}let client_hello_AAD_1: ClientHelloOuterAAD = catch-fail((if v_244 then (if v_246 then client_hello_outer_AAD(h_alg_ech_2,a_alg_ech_2,config_id_4,enc_5,client_hello_outer'_1) else fail-any) else fail-any)) in
                            {1147}let v_247: bool = not-caught-fail(client_hello_AAD_1) in
                            {1148}let info_1: bitstring = (if v_247 then (tls_ech_str,ech_conf_2) else caught-fail) in
                            {1149}let gxy_8: element = (if v_247 then catch-fail(dh_decap_fun(ech_g_1,enc_4,skR_2)) else caught-fail) in
                            {1150}let v_248: bool = not-caught-fail(gxy_8) in
                            {1151}new s_28[]: seed;
                            {1152}let shared_secret_1: element = (if v_247 then (if v_248 then gxy_8 else dh_f(s_28)) else caught-fail) in
                            {1153}let m_25: hpkeMode = (if v_247 then R else caught-fail) in
                            {1154}let s_29: bitstring = (if v_247 then zero else caught-fail) in
                            {1155}let k_19: bitstring = (if v_247 then (hpke_info_hash,info_1) else caught-fail) in
                            {1156}let info_hash_1: bitstring = (if v_247 then catch-fail(hmac(ech_h_alg_1,s_29,k_19)) else caught-fail) in
                            {1157}let v_249: bool = not-caught-fail(info_hash_1) in
                            {1158}let k_20: bitstring = (if v_249 then (hpke_secret,zero) else caught-fail) in
                            {1159}let xsecret_1: bitstring = (if v_249 then catch-fail(hmac(ech_h_alg_1,shared_secret_1,k_20)) else caught-fail) in
                            {1160}let v_250: bool = not-caught-fail(xsecret_1) in
                            {1161}let l_64: label = (if v_250 then hpke_key else caught-fail) in
                            {1162}let x_71: bitstring = (if v_250 then (l_64,info_hash_1) else caught-fail) in
                            {1163}let key_2: aead_key = (if v_250 then catch-fail(hmac(ech_h_alg_1,xsecret_1,x_71)) else caught-fail) in
                            {1164}let v_251: bool = not-caught-fail(key_2) in
                            {1165}let l_65: label = (if v_251 then hpke_base_nonce else caught-fail) in
                            {1166}let x_72: bitstring = (if v_251 then (l_65,info_hash_1) else caught-fail) in
                            {1167}let base_nonce_1: bitstring = (if v_251 then catch-fail(hmac(ech_h_alg_1,xsecret_1,x_72)) else caught-fail) in
                            {1168}let v_252: bool = not-caught-fail(base_nonce_1) in
                            {1169}let l_66: label = (if v_252 then hpke_exp else caught-fail) in
                            {1170}let x_73: bitstring = (if v_252 then (l_66,info_hash_1) else caught-fail) in
                            {1171}let exporter_secret_1: bitstring = (if v_252 then catch-fail(hmac(ech_h_alg_1,xsecret_1,x_73)) else caught-fail) in
                            {1172}let v_253: bool = not-caught-fail(exporter_secret_1) in
                            {1173}let context_1: hpkeContext = (if v_247 then catch-fail((if v_249 then (if v_250 then (if v_251 then (if v_252 then (if v_253 then hpke_context(m_25,key_2) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) else caught-fail) in
                            {1174}let v_254: bool = not-caught-fail(context_1) in
                            {1175}let v_255: hpkeContext = (if v_254 then catch-fail(context_1) else caught-fail) in
                            {1176}let v_256: bool = (not-caught-fail(v_255) && ((R =nf 1-proj-hpke_context(v_255)) && success?(1-proj-hpke_context(v_255)))) in
                            {1177}let key_3: aead_key = (if v_256 then 2-proj-hpke_context(v_255) else caught-fail) in
                            {1178}let i_client_hello_2: msg = (if v_254 then catch-fail((if v_256 then aead_dec(ech_a_alg,key_3,nonce_for_seal_open,client_hello_AAD_1,payload_4) else fail-any)) else caught-fail) in
                            {1179}let v_257: bool = not-caught-fail(i_client_hello_2) in
                            {1180}let v_258: msg = (if v_257 then catch-fail(i_client_hello_2) else caught-fail) in
                            {1181}let v_259: bool = (not-caught-fail(v_258) && ((((TLS13 =nf 1-proj-nego(2-proj-CH(v_258))) && success?(1-proj-SNI(5-proj-nego(2-proj-CH(v_258))))) && success?(1-proj-nego(2-proj-CH(v_258)))) && success?(1-proj-CH(v_258)))) in
                            {1182}let extra_ext': extraExt = (if v_259 then 8-proj-nego(2-proj-CH(v_258)) else caught-fail) in
                            {1183}let empty_psk_ext': preSharedKeyExt = (if v_259 then 7-proj-nego(2-proj-CH(v_258)) else caught-fail) in
                            {1184}let ech_ext': echExt = (if v_259 then 6-proj-nego(2-proj-CH(v_258)) else caught-fail) in
                            {1185}let i_dom: domain = (if v_259 then 1-proj-SNI(5-proj-nego(2-proj-CH(v_258))) else caught-fail) in
                            {1186}let kex_ext'_1: keyShareExt = (if v_259 then 4-proj-nego(2-proj-CH(v_258)) else caught-fail) in
                            {1187}let a_alg': aead_alg = (if v_259 then 3-proj-nego(2-proj-CH(v_258)) else caught-fail) in
                            {1188}let h_alg': hash_alg = (if v_259 then 2-proj-nego(2-proj-CH(v_258)) else caught-fail) in
                            {1189}let cr'_2: bytes32 = (if v_259 then 1-proj-CH(v_258) else caught-fail) in
                            {1190}let v_260: bool = (v_257 && not(v_259)) in
                            {1191}let v_261: echConfig = (if v_260 then catch-fail(ech_conf_2) else caught-fail) in
                            {1192}let v_262: bool = (not-caught-fail(v_261) && success?(1-proj-ech_config(v_261))) in
                            {1193}let a_alg_12: aead_alg = (if v_262 then 6-proj-ech_config(v_261) else caught-fail) in
                            {1194}let h_alg_12: hash_alg = (if v_262 then 5-proj-ech_config(v_261) else caught-fail) in
                            {1195}let s_dom_9: domain = (if v_262 then 4-proj-ech_config(v_261) else caught-fail) in
                            {1196}let pkR_4: element = (if v_262 then 3-proj-ech_config(v_261) else caught-fail) in
                            {1197}let g_8: group = (if v_262 then 2-proj-ech_config(v_261) else caught-fail) in
                            {1198}let config_id_5: configId = (if v_262 then 1-proj-ech_config(v_261) else caught-fail) in
                            {1199}new s_30[]: seed;
                            {1200}let gx_9: element = (if v_262 then dh_pub(g_8,dh_k(s_30)) else caught-fail) in
                            {1201}let v_263: bitstring = (if v_262 then catch-fail((dh_k(s_30),gx_9)) else caught-fail) in
                            {1202}let v_264: bool = (not-caught-fail(v_263) && success?(1-proj-2-tuple(v_263))) in
                            {1203}let pkR': element = (if v_264 then 2-proj-2-tuple(v_263) else caught-fail) in
                            {1204}let skR': bitstring = (if v_264 then 1-proj-2-tuple(v_263) else caught-fail) in
                            {1205}new config_id'[]: configId;
                            {1206}let retry_config: echConfig = (if v_260 then catch-fail((if v_262 then (if v_264 then ech_config(config_id',g_8,pkR',s_dom_9,h_alg_12,a_alg_12) else fail-any) else fail-any)) else caught-fail) in
                            {1207}let v_265: bool = not-caught-fail(retry_config) in
                            {1208}let v_266: bool = (v_254 && not(v_257)) in
                            {1209}let v_267: echConfig = (if v_266 then catch-fail(ech_conf_2) else caught-fail) in
                            {1210}let v_268: bool = (not-caught-fail(v_267) && success?(1-proj-ech_config(v_267))) in
                            {1211}let a_alg_13: aead_alg = (if v_268 then 6-proj-ech_config(v_267) else caught-fail) in
                            {1212}let h_alg_13: hash_alg = (if v_268 then 5-proj-ech_config(v_267) else caught-fail) in
                            {1213}let s_dom_10: domain = (if v_268 then 4-proj-ech_config(v_267) else caught-fail) in
                            {1214}let pkR_5: element = (if v_268 then 3-proj-ech_config(v_267) else caught-fail) in
                            {1215}let g_9: group = (if v_268 then 2-proj-ech_config(v_267) else caught-fail) in
                            {1216}let config_id_6: configId = (if v_268 then 1-proj-ech_config(v_267) else caught-fail) in
                            {1217}new s_31[]: seed;
                            {1218}let gx_10: element = (if v_268 then dh_pub(g_9,dh_k(s_31)) else caught-fail) in
                            {1219}let v_269: bitstring = (if v_268 then catch-fail((dh_k(s_31),gx_10)) else caught-fail) in
                            {1220}let v_270: bool = (not-caught-fail(v_269) && success?(1-proj-2-tuple(v_269))) in
                            {1221}let pkR'_1: element = (if v_270 then 2-proj-2-tuple(v_269) else caught-fail) in
                            {1222}let skR'_1: bitstring = (if v_270 then 1-proj-2-tuple(v_269) else caught-fail) in
                            {1223}new config_id'_1[]: configId;
                            {1224}let retry_config_1: echConfig = (if v_266 then catch-fail((if v_268 then (if v_270 then ech_config(config_id'_1,g_9,pkR'_1,s_dom_10,h_alg_13,a_alg_13) else fail-any) else fail-any)) else caught-fail) in
                            {1225}let v_271: bool = not-caught-fail(retry_config_1) in
                            {1226}let (s_dom_11: domain,client_hello_2: msg,encrypted_ext_1: bitstring,is_backend_1: bool) = (if v_247 then (if v_254 then (if v_257 then (if v_259 then (i_dom,i_client_hello_2,zero,true) else (if v_265 then (s_dom_8,x_client_hello,server_ECH(retry_config),false) else fail-any)) else (if v_271 then (s_dom_8,x_client_hello,server_ECH(retry_config_1),false) else fail-any)) else fail-any) else fail-any) in
                            {1227}out(ch_server_SH, (id_server_5,use_psk_3,is_backend_1,cert_req_5,s_dom_11,tls_g,tls_h,tls_a,s_extra_1,encrypted_ext_1,client_hello_2,zero))
                        )
                        else
                            {1248}get ech_configurations(ech_config(config_id'_2: configId,ech_g': group,pkR'_2: element,=s_dom_8,ech_h_alg': hash_alg,ech_a_alg': aead_alg),skR'_2: bitstring) in
                            {1228}let config_2: echConfig = ech_config(config_id'_2,ech_g',pkR'_2,s_dom_8,ech_h_alg',ech_a_alg') in
                            {1229}let v_272: echConfig = config_2 in
                            {1230}let v_273: bool = success?(1-proj-ech_config(v_272)) in
                            {1231}let a_alg_14: aead_alg = (if v_273 then 6-proj-ech_config(v_272) else caught-fail) in
                            {1232}let h_alg_14: hash_alg = (if v_273 then 5-proj-ech_config(v_272) else caught-fail) in
                            {1233}let s_dom_12: domain = (if v_273 then 4-proj-ech_config(v_272) else caught-fail) in
                            {1234}let pkR_6: element = (if v_273 then 3-proj-ech_config(v_272) else caught-fail) in
                            {1235}let g_10: group = (if v_273 then 2-proj-ech_config(v_272) else caught-fail) in
                            {1236}let config_id_7: configId = (if v_273 then 1-proj-ech_config(v_272) else caught-fail) in
                            {1237}new s_32[]: seed;
                            {1238}let gx_11: element = (if v_273 then dh_pub(g_10,dh_k(s_32)) else caught-fail) in
                            {1239}let v_274: bitstring = (if v_273 then catch-fail((dh_k(s_32),gx_11)) else caught-fail) in
                            {1240}let v_275: bool = (not-caught-fail(v_274) && success?(1-proj-2-tuple(v_274))) in
                            {1241}let pkR'_3: element = (if v_275 then 2-proj-2-tuple(v_274) else caught-fail) in
                            {1242}let skR'_3: bitstring = (if v_275 then 1-proj-2-tuple(v_274) else caught-fail) in
                            {1243}new config_id'_3[]: configId;
                            {1244}let retry_config_2: echConfig = catch-fail((if v_273 then (if v_275 then ech_config(config_id'_3,g_10,pkR'_3,s_dom_12,h_alg_14,a_alg_14) else fail-any) else fail-any)) in
                            {1245}let v_276: bool = not-caught-fail(retry_config_2) in
                            {1246}let (s_dom_13: domain,client_hello_3: msg,encrypted_ext_2: bitstring,is_backend_2: bool) = (if v_276 then (s_dom_8,x_client_hello,server_ECH(retry_config_2),false) else fail-any) in
                            {1247}out(ch_server_SH, (id_server_5,use_psk_3,is_backend_2,cert_req_5,s_dom_13,tls_g,tls_h,tls_a,s_extra_1,encrypted_ext_2,client_hello_3,zero))
                    )
                    else
                        {1250}if ((ech_ext_8 = empty_ech_ext) || not(use_ech)) then
                            {1251}out(ch_server_SH, (id_server_4,use_psk_3,false,cert_req_5,s_dom_8,tls_g,tls_h,tls_a,s_extra_1,zero,x_client_hello,zero))
                        else
                            {1252}out(io, illegal_parameter)
                )
                else
                    {1253}out(io, handshake_failure)
        )
        else
            {1254}out(io, handshake_failure)
    )
    else
        {1255}out(io, unexpected_message)
) | (
    {1256}let use_grease_1: bool = false in
    {1257}let use_psk_4: bool = false in
    {1258}let send_kex_3: bool = true in
    {1259}in(io, (s_dom_14: domain,cfs_dom_1: domain));
    {1260}event Same((use_grease_1,use_psk_4,s_dom_14));
    {1609}get ech_configurations(ech_config(id_11: configId,g_11: group,pkR_7: element,=cfs_dom_1,h_alg_15: hash_alg,a_alg_15: aead_alg),skR_3: bitstring) in
    {1261}let ech_conf_3: echConfig = ech_config(id_11,g_11,pkR_7,cfs_dom_1,h_alg_15,a_alg_15) in
    {1262}let c_dom_7: domain = choice[ClientA,ClientB] in
    {1263}let i_extra_1: extraExt = empty_extra_ext in
    {1264}let o_extra_1: extraExt = empty_extra_ext in
    {1265}new id_client_9[]: idProc;
    {1266}event SanityClient(id_client_9,true,use_grease_1,use_psk_4,send_kex_3);
    {1267}if not((use_grease_1 && use_psk_4)) then
    {1268}let i_cur_log_2: bitstring = zero in
    {1269}new s_33[]: seed;
    {1270}let gx_12: element = dh_pub(tls_g,dh_k(s_33)) in
    {1271}let v_277: bitstring = (dh_k(s_33),gx_12) in
    {1272}let v_278: bool = success?(1-proj-2-tuple(v_277)) in
    {1273}let i_gx_1: element = (if v_278 then 2-proj-2-tuple(v_277) else caught-fail) in
    {1274}let i_x_2: bitstring = (if v_278 then 1-proj-2-tuple(v_277) else caught-fail) in
    {1275}new s_34[]: seed;
    {1276}let gx_13: element = (if v_278 then dh_pub(tls_g,dh_k(s_34)) else caught-fail) in
    {1277}let v_279: bitstring = (if v_278 then catch-fail((dh_k(s_34),gx_13)) else caught-fail) in
    {1278}let v_280: bool = (not-caught-fail(v_279) && success?(1-proj-2-tuple(v_279))) in
    {1279}let o_gx_1: element = (if v_280 then 2-proj-2-tuple(v_279) else caught-fail) in
    {1280}let o_x_2: bitstring = (if v_280 then 1-proj-2-tuple(v_279) else caught-fail) in
    {1281}let v_281: bitstring = (if v_280 then catch-fail((if send_kex_3 then (DHE_kex(tls_g,i_gx_1),DHE_kex(tls_g,o_gx_1)) else (DHE_group(tls_g),DHE_group(tls_g)))) else caught-fail) in
    {1282}let v_282: bool = (not-caught-fail(v_281) && success?(1-proj-2-tuple(v_281))) in
    {1283}let o_kex_1: kex_alg = (if v_282 then 2-proj-2-tuple(v_281) else caught-fail) in
    {1284}let i_kex_1: kex_alg = (if v_282 then 1-proj-2-tuple(v_281) else caught-fail) in
    {1285}let (i_kex_ext_2: keyShareExt,o_kex_ext_2: keyShareExt,kex_data_5: bitstring) = (if v_278 then (if v_280 then (if v_282 then (client_kex_ext(i_kex_1),client_kex_ext(o_kex_1),(i_x_2,o_x_2,tls_g,send_kex_3)) else fail-any) else fail-any) else fail-any) in
    {1286}new rand24_5[]: bytes24;
    {1287}new rand8_5[]: bytes8;
    {1288}let i_cr_2: bytes32 = B32(rand24_5,rand8_5) in
    {1289}let ech_ext_11: echExt = ech_is_inner in
    {1608}get pre_shared_keys(c_dom'_4: domain,s_dom'_4: domain,=tls_h,id_12: identityPsk,internal_psk_3: internal_preSharedKey) in
    {1290}event Selected_psk(c_dom_7,c_dom'_4,s_dom_14,s_dom'_4,id_12,internal_psk_3);
    {1291}let v_283: bool = use_psk_4 in
    {1292}let psk_30: preSharedKey = (if v_283 then PSK(internal_psk_3) else caught-fail) in
    {1293}let offer_9: params = (if v_283 then nego(TLS13,tls_h,tls_a,i_kex_ext_2,SNI(s_dom_14),ech_ext_11,trunc_client_psk_ext(id_12),i_extra_1) else caught-fail) in
    {1294}let cur_log'_5: bitstring = (if v_283 then (i_cur_log_2,CH(i_cr_2,offer_9)) else caught-fail) in
    {1295}let s_35: bitstring = (if v_283 then zero else caught-fail) in
    {1296}let k_21: bitstring = (if v_283 then catch-fail(psk2b(psk_30)) else caught-fail) in
    {1297}let v_284: bool = not-caught-fail(k_21) in
    {1298}let early_secret_18: bitstring = (if v_283 then catch-fail((if v_284 then hmac(tls_h,s_35,k_21) else fail-any)) else caught-fail) in
    {1299}let v_285: bool = not-caught-fail(early_secret_18) in
    {1300}let l_67: label = (if v_285 then tls13_resumption_psk_binder_key else caught-fail) in
    {1301}let m_26: bitstring = (if v_285 then zero else caught-fail) in
    {1302}let h_61: bitstring = (if v_285 then catch-fail(hash(tls_h,m_26)) else caught-fail) in
    {1303}let v_286: bool = not-caught-fail(h_61) in
    {1304}let x_74: bitstring = (if v_286 then (l_67,h_61) else caught-fail) in
    {1305}let binder_key_13: bitstring = (if v_285 then catch-fail((if v_286 then hmac(tls_h,early_secret_18,x_74) else fail-any)) else caught-fail) in
    {1306}let v_287: bool = not-caught-fail(binder_key_13) in
    {1307}let v_288: bitstring = (if v_283 then catch-fail((if v_285 then (if v_287 then (early_secret_18,binder_key_13) else fail-any) else fail-any)) else caught-fail) in
    {1308}let v_289: bool = (not-caught-fail(v_288) && success?(1-proj-2-tuple(v_288))) in
    {1309}let kb_13: mac_key = (if v_289 then 2-proj-2-tuple(v_288) else caught-fail) in
    {1310}let es_17: bitstring = (if v_289 then 1-proj-2-tuple(v_288) else caught-fail) in
    {1311}let binders_4: bitstring = (if v_289 then catch-fail(hmac(tls_h,kb_13,cur_log'_5)) else caught-fail) in
    {1312}let v_290: bool = not-caught-fail(binders_4) in
    {1313}let psk_31: preSharedKey = (if not(v_283) then NoPSK else caught-fail) in
    {1314}let s_36: bitstring = (if not(v_283) then zero else caught-fail) in
    {1315}let k_22: bitstring = (if not(v_283) then catch-fail(psk2b(psk_31)) else caught-fail) in
    {1316}let v_291: bool = not-caught-fail(k_22) in
    {1317}let early_secret_19: bitstring = (if not(v_283) then catch-fail((if v_291 then hmac(tls_h,s_36,k_22) else fail-any)) else caught-fail) in
    {1318}let v_292: bool = not-caught-fail(early_secret_19) in
    {1319}let l_68: label = (if v_292 then tls13_resumption_psk_binder_key else caught-fail) in
    {1320}let m_27: bitstring = (if v_292 then zero else caught-fail) in
    {1321}let h_62: bitstring = (if v_292 then catch-fail(hash(tls_h,m_27)) else caught-fail) in
    {1322}let v_293: bool = not-caught-fail(h_62) in
    {1323}let x_75: bitstring = (if v_293 then (l_68,h_62) else caught-fail) in
    {1324}let binder_key_14: bitstring = (if v_292 then catch-fail((if v_293 then hmac(tls_h,early_secret_19,x_75) else fail-any)) else caught-fail) in
    {1325}let v_294: bool = not-caught-fail(binder_key_14) in
    {1326}let v_295: bitstring = (if not(v_283) then catch-fail((if v_292 then (if v_294 then (early_secret_19,binder_key_14) else fail-any) else fail-any)) else caught-fail) in
    {1327}let v_296: bool = (not-caught-fail(v_295) && success?(1-proj-2-tuple(v_295))) in
    {1328}let kb_14: mac_key = (if v_296 then 2-proj-2-tuple(v_295) else caught-fail) in
    {1329}let es_18: bitstring = (if v_296 then 1-proj-2-tuple(v_295) else caught-fail) in
    {1330}let v_297: bitstring = catch-fail((if v_283 then (if v_289 then (if v_290 then (client_psk_ext(id_12,binders_4),(tls_h,psk_30,es_17)) else fail-any) else fail-any) else (if v_296 then (empty_psk_ext,(tls_h,NoPSK,es_18)) else fail-any))) in
    {1331}let v_298: bool = (not-caught-fail(v_297) && success?(1-proj-2-tuple(v_297))) in
    {1332}let psk_data_5: bitstring = (if v_298 then 2-proj-2-tuple(v_297) else caught-fail) in
    {1333}let psk_ext_11: preSharedKeyExt = (if v_298 then 1-proj-2-tuple(v_297) else caught-fail) in
    {1334}let i_offer_1: params = (if v_298 then nego(TLS13,tls_h,tls_a,i_kex_ext_2,SNI(s_dom_14),ech_is_inner,psk_ext_11,i_extra_1) else caught-fail) in
    {1335}let i_client_hello_3: msg = (if v_298 then CH(i_cr_2,i_offer_1) else caught-fail) in
    {1336}let v_299: echConfig = (if v_298 then catch-fail(ech_conf_3) else caught-fail) in
    {1337}let v_300: bool = (not-caught-fail(v_299) && success?(1-proj-ech_config(v_299))) in
    {1338}let a_alg_ech_3: aead_alg = (if v_300 then 6-proj-ech_config(v_299) else caught-fail) in
    {1339}let h_alg_ech_3: hash_alg = (if v_300 then 5-proj-ech_config(v_299) else caught-fail) in
    {1340}let o_dom_4: domain = (if v_300 then 4-proj-ech_config(v_299) else caught-fail) in
    {1341}let pkR_8: element = (if v_300 then 3-proj-ech_config(v_299) else caught-fail) in
    {1342}let g_ech_1: group = (if v_300 then 2-proj-ech_config(v_299) else caught-fail) in
    {1343}let config_id_8: configId = (if v_300 then 1-proj-ech_config(v_299) else caught-fail) in
    {1344}let info_2: bitstring = (if v_300 then (tls_ech_str,ech_conf_3) else caught-fail) in
    {1345}new s_37[]: seed;
    {1346}let v_301: bitstring = (if v_300 then catch-fail((dh_xy(s_37,pkR_8),dh_encap_fun(g_ech_1,pkR_8,dh_xy(s_37,pkR_8)))) else caught-fail) in
    {1347}let v_302: bool = (not-caught-fail(v_301) && success?(1-proj-2-tuple(v_301))) in
    {1348}let enc_6: element = (if v_302 then 2-proj-2-tuple(v_301) else caught-fail) in
    {1349}let shared_secret_2: element = (if v_302 then 1-proj-2-tuple(v_301) else caught-fail) in
    {1350}let m_28: hpkeMode = (if v_302 then S else caught-fail) in
    {1351}let s_38: bitstring = (if v_302 then zero else caught-fail) in
    {1352}let k_23: bitstring = (if v_302 then (hpke_info_hash,info_2) else caught-fail) in
    {1353}let info_hash_2: bitstring = (if v_302 then catch-fail(hmac(h_alg_ech_3,s_38,k_23)) else caught-fail) in
    {1354}let v_303: bool = not-caught-fail(info_hash_2) in
    {1355}let k_24: bitstring = (if v_303 then (hpke_secret,zero) else caught-fail) in
    {1356}let xsecret_2: bitstring = (if v_303 then catch-fail(hmac(h_alg_ech_3,shared_secret_2,k_24)) else caught-fail) in
    {1357}let v_304: bool = not-caught-fail(xsecret_2) in
    {1358}let l_69: label = (if v_304 then hpke_key else caught-fail) in
    {1359}let x_76: bitstring = (if v_304 then (l_69,info_hash_2) else caught-fail) in
    {1360}let key_4: aead_key = (if v_304 then catch-fail(hmac(h_alg_ech_3,xsecret_2,x_76)) else caught-fail) in
    {1361}let v_305: bool = not-caught-fail(key_4) in
    {1362}let l_70: label = (if v_305 then hpke_base_nonce else caught-fail) in
    {1363}let x_77: bitstring = (if v_305 then (l_70,info_hash_2) else caught-fail) in
    {1364}let base_nonce_2: bitstring = (if v_305 then catch-fail(hmac(h_alg_ech_3,xsecret_2,x_77)) else caught-fail) in
    {1365}let v_306: bool = not-caught-fail(base_nonce_2) in
    {1366}let l_71: label = (if v_306 then hpke_exp else caught-fail) in
    {1367}let x_78: bitstring = (if v_306 then (l_71,info_hash_2) else caught-fail) in
    {1368}let exporter_secret_2: bitstring = (if v_306 then catch-fail(hmac(h_alg_ech_3,xsecret_2,x_78)) else caught-fail) in
    {1369}let v_307: bool = not-caught-fail(exporter_secret_2) in
    {1370}let v_308: bitstring = (if v_300 then catch-fail((if v_302 then (enc_6,(if v_303 then (if v_304 then (if v_305 then (if v_306 then (if v_307 then hpke_context(m_28,key_4) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) else fail-any)) else caught-fail) in
    {1371}let v_309: bool = (not-caught-fail(v_308) && success?(1-proj-2-tuple(v_308))) in
    {1372}let context_2: hpkeContext = (if v_309 then 2-proj-2-tuple(v_308) else caught-fail) in
    {1373}let enc_7: element = (if v_309 then 1-proj-2-tuple(v_308) else caught-fail) in
    {1374}new rand24_6[]: bytes24;
    {1375}new rand8_6[]: bytes8;
    {1376}let o_cr_2: bytes32 = (if v_309 then B32(rand24_6,rand8_6) else caught-fail) in
    {1377}let v_310: bool = (if v_309 then catch-fail(use_grease_1) else caught-fail) in
    {1378}new payload_6[]: bitstring;
    {1379}let ech_ext_12: echExt = (if v_310 then client_ECH(h_alg_ech_3,a_alg_ech_3,config_id_8,enc_7,payload_6) else caught-fail) in
    {1380}let o_offer_2: params = (if v_310 then nego(TLS13,tls_h,tls_a,o_kex_ext_2,SNI(o_dom_4),ech_ext_12,empty_psk_ext,o_extra_1) else caught-fail) in
    {1381}let dummy_ech_ext_1: echExt = (if is-false(v_310) then client_ECH(h_alg_ech_3,a_alg_ech_3,config_id_8,enc_7,zero) else caught-fail) in
    {1382}let o_offer1_1: params = (if is-false(v_310) then nego(TLS13,tls_h,tls_a,o_kex_ext_2,SNI(o_dom_4),dummy_ech_ext_1,empty_psk_ext,o_extra_1) else caught-fail) in
    {1383}let o_client_hello1_1: msg = (if is-false(v_310) then CH(o_cr_2,o_offer1_1) else caught-fail) in
    {1384}let v_311: msg = (if is-false(v_310) then catch-fail(o_client_hello1_1) else caught-fail) in
    {1385}let v_312: bool = (not-caught-fail(v_311) && (success?(1-proj-nego(2-proj-CH(v_311))) && success?(1-proj-CH(v_311)))) in
    {1386}let extra_16: extraExt = (if v_312 then 8-proj-nego(2-proj-CH(v_311)) else caught-fail) in
    {1387}let psk_ext_12: preSharedKeyExt = (if v_312 then 7-proj-nego(2-proj-CH(v_311)) else caught-fail) in
    {1388}let ech_ext_13: echExt = (if v_312 then 6-proj-nego(2-proj-CH(v_311)) else caught-fail) in
    {1389}let sni_ext_6: sniExt = (if v_312 then 5-proj-nego(2-proj-CH(v_311)) else caught-fail) in
    {1390}let kex_ext_8: keyShareExt = (if v_312 then 4-proj-nego(2-proj-CH(v_311)) else caught-fail) in
    {1391}let a_alg_16: aead_alg = (if v_312 then 3-proj-nego(2-proj-CH(v_311)) else caught-fail) in
    {1392}let h_alg_16: hash_alg = (if v_312 then 2-proj-nego(2-proj-CH(v_311)) else caught-fail) in
    {1393}let version_2: TLS_version = (if v_312 then 1-proj-nego(2-proj-CH(v_311)) else caught-fail) in
    {1394}let r_3: bytes32 = (if v_312 then 1-proj-CH(v_311) else caught-fail) in
    {1395}let v_313: echExt = (if v_312 then catch-fail(ech_ext_13) else caught-fail) in
    {1396}let v_314: bool = (not-caught-fail(v_313) && success?(1-proj-client_ECH(v_313))) in
    {1397}let payload_7: bitstring = (if v_314 then 5-proj-client_ECH(v_313) else caught-fail) in
    {1398}let enc_8: element = (if v_314 then 4-proj-client_ECH(v_313) else caught-fail) in
    {1399}let config_id_9: configId = (if v_314 then 3-proj-client_ECH(v_313) else caught-fail) in
    {1400}let a_alg_ech_4: aead_alg = (if v_314 then 2-proj-client_ECH(v_313) else caught-fail) in
    {1401}let h_alg_ech_4: hash_alg = (if v_314 then 1-proj-client_ECH(v_313) else caught-fail) in
    {1402}let client_hello_outer'_2: msg = (if v_314 then CH(r_3,nego(version_2,h_alg_16,a_alg_16,kex_ext_8,sni_ext_6,empty_ech_ext,psk_ext_12,extra_16)) else caught-fail) in
    {1403}let client_hello_AAD_2: ClientHelloOuterAAD = (if is-false(v_310) then catch-fail((if v_312 then (if v_314 then client_hello_outer_AAD(h_alg_ech_4,a_alg_ech_4,config_id_9,enc_8,client_hello_outer'_2) else fail-any) else fail-any)) else caught-fail) in
    {1404}let v_315: bool = not-caught-fail(client_hello_AAD_2) in
    {1405}let v_316: hpkeContext = (if v_315 then catch-fail(context_2) else caught-fail) in
    {1406}let v_317: bool = (not-caught-fail(v_316) && ((S =nf 1-proj-hpke_context(v_316)) && success?(1-proj-hpke_context(v_316)))) in
    {1407}let key_5: aead_key = (if v_317 then 2-proj-hpke_context(v_316) else caught-fail) in
    {1408}let payload_8: bitstring = (if v_315 then catch-fail((if v_317 then aead_enc(a_alg_ech_3,key_5,nonce_for_seal_open,client_hello_AAD_2,i_client_hello_3) else fail-any)) else caught-fail) in
    {1409}let v_318: bool = not-caught-fail(payload_8) in
    {1410}let ech_ext_14: echExt = (if v_318 then client_ECH(h_alg_ech_3,a_alg_ech_3,config_id_8,enc_7,payload_8) else caught-fail) in
    {1411}let o_offer_3: params = (if v_318 then nego(TLS13,tls_h,tls_a,o_kex_ext_2,SNI(o_dom_4),ech_ext_14,empty_psk_ext,o_extra_1) else caught-fail) in
    {1412}let (o_client_hello_1: msg,i_client_hello_4: msg,i_cr_3: bytes32,o_cr_3: bytes32,i_kex_ext_3: keyShareExt,o_kex_ext_3: keyShareExt,kex_data_6: bitstring,psk_data_6: bitstring) = (if v_298 then (if v_300 then (if v_309 then (if undo-catch-fail(v_310) then (CH(o_cr_2,o_offer_2),CH(o_cr_2,o_offer_2),o_cr_2,o_cr_2,o_kex_ext_2,o_kex_ext_2,kex_data_5,psk_data_5) else (if v_315 then (if v_318 then (CH(o_cr_2,o_offer_3),i_client_hello_3,i_cr_2,o_cr_2,i_kex_ext_2,o_kex_ext_2,kex_data_5,psk_data_5) else fail-any) else fail-any)) else fail-any) else fail-any) else fail-any) in
    {1413}out(io, o_client_hello_1);
    {1414}let (=tls_h,psk_32: preSharedKey,es_19: bitstring) = psk_data_6 in
    {1415}let v_319: echConfig = ech_conf_3 in
    {1416}let v_320: bool = success?(1-proj-ech_config(v_319)) in
    {1417}let al_3: aead_alg = (if v_320 then 6-proj-ech_config(v_319) else caught-fail) in
    {1418}let hl_3: hash_alg = (if v_320 then 5-proj-ech_config(v_319) else caught-fail) in
    {1419}let dom_3: domain = (if v_320 then 4-proj-ech_config(v_319) else caught-fail) in
    {1420}let public_key_3: element = (if v_320 then 3-proj-ech_config(v_319) else caught-fail) in
    {1421}let g_12: group = (if v_320 then 2-proj-ech_config(v_319) else caught-fail) in
    {1422}let id_13: configId = (if v_320 then 1-proj-ech_config(v_319) else caught-fail) in
    {1423}let o_dom_5: domain = (if v_320 then dom_3 else fail-any) in
    {1424}let v_321: echConfig = ech_conf_3 in
    {1425}let v_322: bool = success?(1-proj-ech_config(v_321)) in
    {1426}let al_4: aead_alg = (if v_322 then 6-proj-ech_config(v_321) else caught-fail) in
    {1427}let hl_4: hash_alg = (if v_322 then 5-proj-ech_config(v_321) else caught-fail) in
    {1428}let dom_4: domain = (if v_322 then 4-proj-ech_config(v_321) else caught-fail) in
    {1429}let public_key_4: element = (if v_322 then 3-proj-ech_config(v_321) else caught-fail) in
    {1430}let g_13: group = (if v_322 then 2-proj-ech_config(v_321) else caught-fail) in
    {1431}let id_14: configId = (if v_322 then 1-proj-ech_config(v_321) else caught-fail) in
    {1432}let ech_pk_1: element = (if v_322 then public_key_4 else fail-any) in
    {1433}event SanityClientCH_ECH(id_client_9,zero32,i_cr_3,o_cr_3,c_dom_7,o_dom_5,s_dom_14,ech_pk_1,psk_32,(zero,o_client_hello_1),(zero,i_client_hello_4));
    {1434}in(io, server_hello_3: msg);
    {1435}let SH(sr_13: bytes32,mode_5: params) = server_hello_3 in
    (
        {1436}if (sr_13 = rand_HelloRetryRequest) then
            {1437}out(io, illegal_parameter)
        else
            {1438}let v_323: echConfig = ech_conf_3 in
            {1439}let v_324: bool = success?(1-proj-ech_config(v_323)) in
            {1440}let al_5: aead_alg = (if v_324 then 6-proj-ech_config(v_323) else caught-fail) in
            {1441}let hl_5: hash_alg = (if v_324 then 5-proj-ech_config(v_323) else caught-fail) in
            {1442}let dom_5: domain = (if v_324 then 4-proj-ech_config(v_323) else caught-fail) in
            {1443}let public_key_5: element = (if v_324 then 3-proj-ech_config(v_323) else caught-fail) in
            {1444}let g_14: group = (if v_324 then 2-proj-ech_config(v_323) else caught-fail) in
            {1445}let id_15: configId = (if v_324 then 1-proj-ech_config(v_323) else caught-fail) in
            {1446}let id_client_10: idProc = id_client_9 in
            {1447}let o_dom_6: domain = (if v_324 then dom_5 else fail-any) in
            {1448}let i_cur_log_3: bitstring = (zero,i_client_hello_4) in
            {1449}let o_cur_log_1: bitstring = (zero,o_client_hello_1) in
            {1450}let SH(B32(sr24_2: bytes24,sr8_2: bytes8),mode_6: params) = server_hello_3 in
            {1451}let (i_x_3: bitstring,o_x_3: bitstring,g_15: group,=true) = kex_data_6 in
            {1452}let nego(=TLS13,=tls_h,=tls_a,server_kex_ext(DHE_kex(=g_15,gy_srv_1: element)),=empty_sni_ext,=empty_ech_ext,psk_ext_13: preSharedKeyExt,extra_17: extraExt) = mode_6 in
            (
                {1453}let v_325: bool = (psk_ext_13 = empty_psk_ext) in
                {1454}let psk_33: preSharedKey = (if v_325 then NoPSK else caught-fail) in
                {1455}let s_39: bitstring = (if v_325 then zero else caught-fail) in
                {1456}let k_25: bitstring = (if v_325 then catch-fail(psk2b(psk_33)) else caught-fail) in
                {1457}let v_326: bool = not-caught-fail(k_25) in
                {1458}let early_secret_20: bitstring = (if v_325 then catch-fail((if v_326 then hmac(tls_h,s_39,k_25) else fail-any)) else caught-fail) in
                {1459}let v_327: bool = not-caught-fail(early_secret_20) in
                {1460}let l_72: label = (if v_327 then tls13_resumption_psk_binder_key else caught-fail) in
                {1461}let m_29: bitstring = (if v_327 then zero else caught-fail) in
                {1462}let h_63: bitstring = (if v_327 then catch-fail(hash(tls_h,m_29)) else caught-fail) in
                {1463}let v_328: bool = not-caught-fail(h_63) in
                {1464}let x_79: bitstring = (if v_328 then (l_72,h_63) else caught-fail) in
                {1465}let binder_key_15: bitstring = (if v_327 then catch-fail((if v_328 then hmac(tls_h,early_secret_20,x_79) else fail-any)) else caught-fail) in
                {1466}let v_329: bool = not-caught-fail(binder_key_15) in
                {1467}let v_330: bitstring = (if v_325 then catch-fail((if v_327 then (if v_329 then (early_secret_20,binder_key_15) else fail-any) else fail-any)) else caught-fail) in
                {1468}let v_331: bool = (not-caught-fail(v_330) && success?(1-proj-2-tuple(v_330))) in
                {1469}let kb_15: mac_key = (if v_331 then 2-proj-2-tuple(v_330) else caught-fail) in
                {1470}let es_20: bitstring = (if v_331 then 1-proj-2-tuple(v_330) else caught-fail) in
                {1471}let v_332: bitstring = (if not(v_325) then catch-fail(psk_data_6) else caught-fail) in
                {1472}let v_333: bool = (not-caught-fail(v_332) && success?(1-proj-3-tuple(v_332))) in
                {1473}let es_21: bitstring = (if v_333 then 3-proj-3-tuple(v_332) else caught-fail) in
                {1474}let psk_34: preSharedKey = (if v_333 then 2-proj-3-tuple(v_332) else caught-fail) in
                {1475}let h'_alg_3: hash_alg = (if v_333 then 1-proj-3-tuple(v_332) else caught-fail) in
                {1476}let (psk_35: preSharedKey,early_secret_21: bitstring,valid_3: bool) = (if v_325 then (if v_331 then (NoPSK,es_20,true) else fail-any) else (if v_333 then (psk_34,es_21,((h'_alg_3 = tls_h) && ((server_psk_ext(1) = psk_ext_13) && use_psk_4))) else fail-any)) in
                {1477}if valid_3 then
                (
                    {1478}let v_334: bool = use_grease_1 in
                    {1479}let gxy_9: element = (if not(v_334) then catch-fail(dh_decap_fun(g_15,gy_srv_1,i_x_3)) else caught-fail) in
                    {1480}let v_335: bool = not-caught-fail(gxy_9) in
                    {1481}new s_40[]: seed;
                    {1482}let i_gxy_2: element = (if not(v_334) then (if v_335 then gxy_9 else dh_f(s_40)) else caught-fail) in
                    {1483}let l_73: label = (if not(v_334) then tls13_derived else caught-fail) in
                    {1484}let m_30: bitstring = (if not(v_334) then catch-fail(hash(tls_h,zero)) else caught-fail) in
                    {1485}let v_336: bool = not-caught-fail(m_30) in
                    {1486}let h_64: bitstring = (if v_336 then catch-fail(hash(tls_h,m_30)) else caught-fail) in
                    {1487}let v_337: bool = not-caught-fail(h_64) in
                    {1488}let x_80: bitstring = (if v_337 then (l_73,h_64) else caught-fail) in
                    {1489}let extra_18: bitstring = (if not(v_334) then catch-fail((if v_336 then (if v_337 then hmac(tls_h,early_secret_21,x_80) else fail-any) else fail-any)) else caught-fail) in
                    {1490}let v_338: bool = not-caught-fail(extra_18) in
                    {1491}let i_handshake_secret_2: bitstring = (if not(v_334) then catch-fail((if v_338 then hmac(tls_h,extra_18,i_gxy_2) else fail-any)) else caught-fail) in
                    {1492}let v_339: bool = not-caught-fail(i_handshake_secret_2) in
                    {1493}let SH_ECHConf_2: msg = (if v_339 then SH(B32(sr24_2,zero8),mode_6) else caught-fail) in
                    {1494}let l_74: label = (if v_339 then ech_accept_confirmation else caught-fail) in
                    {1495}let m_31: bitstring = (if v_339 then (i_cur_log_3,SH_ECHConf_2) else caught-fail) in
                    {1496}let h_65: bitstring = (if v_339 then catch-fail(hash(tls_h,m_31)) else caught-fail) in
                    {1497}let v_340: bool = not-caught-fail(h_65) in
                    {1498}let x_81: bitstring = (if v_340 then (l_74,h_65) else caught-fail) in
                    {1499}let accept_confirmation_2: bitstring = (if v_339 then catch-fail((if v_340 then hmac(tls_h,i_handshake_secret_2,x_81) else fail-any)) else caught-fail) in
                    {1500}let v_341: bool = not-caught-fail(accept_confirmation_2) in
                    {1501}let is_accepted_1: bool = (if v_334 then false else (if v_339 then (if v_341 then (sr8_2 = crop_into_bytes8(accept_confirmation_2)) else fail-any) else fail-any)) in
                    {1502}let v_342: bool = is_accepted_1 in
                    {1503}let gxy_10: element = (if v_342 then catch-fail(dh_decap_fun(g_15,gy_srv_1,i_x_3)) else caught-fail) in
                    {1504}let v_343: bool = not-caught-fail(gxy_10) in
                    {1505}new s_41[]: seed;
                    {1506}let i_gxy_3: element = (if v_342 then (if v_343 then gxy_10 else dh_f(s_41)) else caught-fail) in
                    {1507}let l_75: label = (if v_342 then tls13_derived else caught-fail) in
                    {1508}let m_32: bitstring = (if v_342 then catch-fail(hash(tls_h,zero)) else caught-fail) in
                    {1509}let v_344: bool = not-caught-fail(m_32) in
                    {1510}let h_66: bitstring = (if v_344 then catch-fail(hash(tls_h,m_32)) else caught-fail) in
                    {1511}let v_345: bool = not-caught-fail(h_66) in
                    {1512}let x_82: bitstring = (if v_345 then (l_75,h_66) else caught-fail) in
                    {1513}let extra_19: bitstring = (if v_342 then catch-fail((if v_344 then (if v_345 then hmac(tls_h,early_secret_21,x_82) else fail-any) else fail-any)) else caught-fail) in
                    {1514}let v_346: bool = not-caught-fail(extra_19) in
                    {1515}let i_handshake_secret_3: bitstring = (if v_342 then catch-fail((if v_346 then hmac(tls_h,extra_19,i_gxy_3) else fail-any)) else caught-fail) in
                    {1516}let v_347: bool = not-caught-fail(i_handshake_secret_3) in
                    {1517}let gxy_11: element = (if not(v_342) then catch-fail(dh_decap_fun(g_15,gy_srv_1,o_x_3)) else caught-fail) in
                    {1518}let v_348: bool = not-caught-fail(gxy_11) in
                    {1519}new s_42[]: seed;
                    {1520}let o_gxy_1: element = (if not(v_342) then (if v_348 then gxy_11 else dh_f(s_42)) else caught-fail) in
                    {1521}let psk_36: preSharedKey = (if not(v_342) then NoPSK else caught-fail) in
                    {1522}let s_43: bitstring = (if not(v_342) then zero else caught-fail) in
                    {1523}let k_26: bitstring = (if not(v_342) then catch-fail(psk2b(psk_36)) else caught-fail) in
                    {1524}let v_349: bool = not-caught-fail(k_26) in
                    {1525}let early_secret_22: bitstring = (if not(v_342) then catch-fail((if v_349 then hmac(tls_h,s_43,k_26) else fail-any)) else caught-fail) in
                    {1526}let v_350: bool = not-caught-fail(early_secret_22) in
                    {1527}let l_76: label = (if v_350 then tls13_resumption_psk_binder_key else caught-fail) in
                    {1528}let m_33: bitstring = (if v_350 then zero else caught-fail) in
                    {1529}let h_67: bitstring = (if v_350 then catch-fail(hash(tls_h,m_33)) else caught-fail) in
                    {1530}let v_351: bool = not-caught-fail(h_67) in
                    {1531}let x_83: bitstring = (if v_351 then (l_76,h_67) else caught-fail) in
                    {1532}let binder_key_16: bitstring = (if v_350 then catch-fail((if v_351 then hmac(tls_h,early_secret_22,x_83) else fail-any)) else caught-fail) in
                    {1533}let v_352: bool = not-caught-fail(binder_key_16) in
                    {1534}let v_353: bitstring = (if not(v_342) then catch-fail((if v_350 then (if v_352 then (early_secret_22,binder_key_16) else fail-any) else fail-any)) else caught-fail) in
                    {1535}let v_354: bool = (not-caught-fail(v_353) && success?(1-proj-2-tuple(v_353))) in
                    {1536}let kb_16: mac_key = (if v_354 then 2-proj-2-tuple(v_353) else caught-fail) in
                    {1537}let es_22: bitstring = (if v_354 then 1-proj-2-tuple(v_353) else caught-fail) in
                    {1538}let l_77: label = (if v_354 then tls13_derived else caught-fail) in
                    {1539}let m_34: bitstring = (if v_354 then catch-fail(hash(tls_h,zero)) else caught-fail) in
                    {1540}let v_355: bool = not-caught-fail(m_34) in
                    {1541}let h_68: bitstring = (if v_355 then catch-fail(hash(tls_h,m_34)) else caught-fail) in
                    {1542}let v_356: bool = not-caught-fail(h_68) in
                    {1543}let x_84: bitstring = (if v_356 then (l_77,h_68) else caught-fail) in
                    {1544}let extra_20: bitstring = (if v_354 then catch-fail((if v_355 then (if v_356 then hmac(tls_h,es_22,x_84) else fail-any) else fail-any)) else caught-fail) in
                    {1545}let v_357: bool = not-caught-fail(extra_20) in
                    {1546}let (cr_14: bytes32,handshake_secret_4: bitstring,s_dom_15: domain,cur_log_10: bitstring) = (if v_342 then (if v_347 then (i_cr_3,i_handshake_secret_3,s_dom_14,(i_cur_log_3,server_hello_3)) else fail-any) else (if v_354 then (o_cr_3,(if v_357 then hmac(tls_h,extra_20,o_gxy_1) else fail-any),o_dom_6,(o_cur_log_1,server_hello_3)) else fail-any)) in
                    {1547}let l_78: label = tls13_derived in
                    {1548}let m_35: bitstring = catch-fail(hash(tls_h,zero)) in
                    {1549}let v_358: bool = not-caught-fail(m_35) in
                    {1550}let h_69: bitstring = (if v_358 then catch-fail(hash(tls_h,m_35)) else caught-fail) in
                    {1551}let v_359: bool = not-caught-fail(h_69) in
                    {1552}let x_85: bitstring = (if v_359 then (l_78,h_69) else caught-fail) in
                    {1553}let extra_21: bitstring = catch-fail((if v_358 then (if v_359 then hmac(tls_h,handshake_secret_4,x_85) else fail-any) else fail-any)) in
                    {1554}let v_360: bool = not-caught-fail(extra_21) in
                    {1555}let k_27: bitstring = (if v_360 then zero else caught-fail) in
                    {1556}let master_secret_15: bitstring = (if v_360 then catch-fail(hmac(tls_h,handshake_secret_4,k_27)) else caught-fail) in
                    {1557}let v_361: bool = not-caught-fail(master_secret_15) in
                    {1558}let l_79: label = (if v_361 then tls13_client_handshake_traffic_secret else caught-fail) in
                    {1559}let h_70: bitstring = (if v_361 then catch-fail(hash(tls_h,cur_log_10)) else caught-fail) in
                    {1560}let v_362: bool = not-caught-fail(h_70) in
                    {1561}let x_86: bitstring = (if v_362 then (l_79,h_70) else caught-fail) in
                    {1562}let client_hts_4: bitstring = (if v_361 then catch-fail((if v_362 then hmac(tls_h,handshake_secret_4,x_86) else fail-any)) else caught-fail) in
                    {1563}let v_363: bool = not-caught-fail(client_hts_4) in
                    {1564}let l_80: label = (if v_363 then tls13_server_handshake_traffic_secret else caught-fail) in
                    {1565}let h_71: bitstring = (if v_363 then catch-fail(hash(tls_h,cur_log_10)) else caught-fail) in
                    {1566}let v_364: bool = not-caught-fail(h_71) in
                    {1567}let x_87: bitstring = (if v_364 then (l_80,h_71) else caught-fail) in
                    {1568}let server_hts_4: bitstring = (if v_363 then catch-fail((if v_364 then hmac(tls_h,handshake_secret_4,x_87) else fail-any)) else caught-fail) in
                    {1569}let v_365: bool = not-caught-fail(server_hts_4) in
                    {1570}let l_81: label = (if v_365 then tls13_key else caught-fail) in
                    {1571}let h_72: bitstring = (if v_365 then zero else caught-fail) in
                    {1572}let x_88: bitstring = (if v_365 then (l_81,h_72) else caught-fail) in
                    {1573}let client_wkh_4: bitstring = (if v_365 then catch-fail(hmac(tls_h,client_hts_4,x_88)) else caught-fail) in
                    {1574}let v_366: bool = not-caught-fail(client_wkh_4) in
                    {1575}let l_82: label = (if v_366 then tls13_key else caught-fail) in
                    {1576}let h_73: bitstring = (if v_366 then zero else caught-fail) in
                    {1577}let x_89: bitstring = (if v_366 then (l_82,h_73) else caught-fail) in
                    {1578}let server_wkh_4: bitstring = (if v_366 then catch-fail(hmac(tls_h,server_hts_4,x_89)) else caught-fail) in
                    {1579}let v_367: bool = not-caught-fail(server_wkh_4) in
                    {1580}let l_83: label = (if v_367 then tls13_finished else caught-fail) in
                    {1581}let h_74: bitstring = (if v_367 then zero else caught-fail) in
                    {1582}let x_90: bitstring = (if v_367 then (l_83,h_74) else caught-fail) in
                    {1583}let client_fk_4: bitstring = (if v_367 then catch-fail(hmac(tls_h,client_hts_4,x_90)) else caught-fail) in
                    {1584}let v_368: bool = not-caught-fail(client_fk_4) in
                    {1585}let l_84: label = (if v_368 then tls13_finished else caught-fail) in
                    {1586}let h_75: bitstring = (if v_368 then zero else caught-fail) in
                    {1587}let x_91: bitstring = (if v_368 then (l_84,h_75) else caught-fail) in
                    {1588}let server_fk_4: bitstring = (if v_368 then catch-fail(hmac(tls_h,server_hts_4,x_91)) else caught-fail) in
                    {1589}let v_369: bool = not-caught-fail(server_fk_4) in
                    {1590}let (master_secret_16: bitstring,chk_11: aead_key,shk_11: aead_key,cfin_11: mac_key,sfin_11: mac_key) = (if v_360 then (if v_361 then (if v_363 then (if v_365 then (if v_366 then (if v_367 then (if v_368 then (if v_369 then (master_secret_15,client_wkh_4,server_wkh_4,client_fk_4,server_fk_4) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
                    {1591}event SanityClientSH(id_client_10,cr_14,B32(sr24_2,sr8_2),c_dom_7,s_dom_15,handshake_secret_4,psk_35,cur_log_10);
                    {1592}if (is_accepted_1 || (psk_ext_13 = empty_psk_ext)) then
                    (
                        {1593}let sr_14: bytes32 = B32(sr24_2,sr8_2) in
                        {1594}in(io, enc_ee_msg_3: bitstring);
                        {1595}let ee_msg_4: msg = aead_dec(tls_a,shk_11,zero,zero,enc_ee_msg_3) in
                        {1596}let EE(x_92: bitstring) = ee_msg_4 in
                        {1597}let v_370: bool = not(is_accepted_1) in
                        {1598}let v_371: bitstring = (if v_370 then catch-fail(x_92) else caught-fail) in
                        {1599}let v_372: bool = (not-caught-fail(v_371) && success?(1-proj-server_ECH(v_371))) in
                        {1600}let ech_conf_4: echConfig = (if v_372 then 1-proj-server_ECH(v_371) else caught-fail) in
                        {1601}let update_ech_conf_1: bitstring = (if v_370 then (if v_372 then () else ()) else ()) in
                        {1602}let cur_log2_10: bitstring = (cur_log_10,ee_msg_4) in
                        {1603}out(ch_client_after_EE, (id_client_10,cr_14,sr_14,tls_h,tls_a,c_dom_7,s_dom_15,psk_35,master_secret_16,chk_11,shk_11,cfin_11,sfin_11,cur_log2_10))
                    )
                    else
                        {1604}out(io, illegal_parameter)
                )
                else
                    {1605}out(io, illegal_parameter)
            )
            else
                {1606}out(io, illegal_parameter)
    )
    else
        {1607}out(io, unexpected_message)
)

--  Biprocess 1 (that is, biprocess 0, with let moved downwards):
{1}let tls_h: hash_alg = id_hash(StrongHash,1) in
(
    {7}!
    {8}in(ch_client_CFIN, (id_client: idProc,cr: bytes32,sr: bytes32,h_alg: hash_alg,a_alg: aead_alg,psk: preSharedKey,s_pkey: pubkey,c_pkey: pubkey,master_secret: bitstring,chk: aead_key,shk: aead_key,cfin: mac_key,sfin: mac_key,cur_log: bitstring));
    {10}let h: bitstring = catch-fail(hash(h_alg,cur_log)) in
    {11}let v: bool = not-caught-fail(h) in
    {9}let l: label = tls13_client_application_traffic_secret in
    {12}let x: bitstring = (if v then (l,h) else caught-fail) in
    {13}let client_ats: bitstring = catch-fail((if v then hmac(h_alg,master_secret,x) else fail-any)) in
    {14}let v_1: bool = not-caught-fail(client_ats) in
    {16}let h_1: bitstring = (if v_1 then catch-fail(hash(h_alg,cur_log)) else caught-fail) in
    {17}let v_2: bool = not-caught-fail(h_1) in
    {15}let l_1: label = (if v_1 then tls13_server_application_traffic_secret else caught-fail) in
    {18}let x_1: bitstring = (if v_2 then (l_1,h_1) else caught-fail) in
    {19}let server_ats: bitstring = (if v_1 then catch-fail((if v_2 then hmac(h_alg,master_secret,x_1) else fail-any)) else caught-fail) in
    {20}let v_3: bool = not-caught-fail(server_ats) in
    {22}let h_2: bitstring = (if v_3 then catch-fail(hash(h_alg,cur_log)) else caught-fail) in
    {23}let v_4: bool = not-caught-fail(h_2) in
    {21}let l_2: label = (if v_3 then tls13_exporter_master_secret else caught-fail) in
    {24}let x_2: bitstring = (if v_4 then (l_2,h_2) else caught-fail) in
    {25}let ems: bitstring = (if v_3 then catch-fail((if v_4 then hmac(h_alg,master_secret,x_2) else fail-any)) else caught-fail) in
    {26}let v_5: bool = not-caught-fail(ems) in
    {28}let h_3: bitstring = (if v_5 then zero else caught-fail) in
    {27}let l_3: label = (if v_5 then tls13_key else caught-fail) in
    {29}let x_3: bitstring = (if v_5 then (l_3,h_3) else caught-fail) in
    {30}let client_wkad: bitstring = (if v_5 then catch-fail(hmac(h_alg,client_ats,x_3)) else caught-fail) in
    {31}let v_6: bool = not-caught-fail(client_wkad) in
    {33}let h_4: bitstring = (if v_6 then zero else caught-fail) in
    {32}let l_4: label = (if v_6 then tls13_key else caught-fail) in
    {34}let x_4: bitstring = (if v_6 then (l_4,h_4) else caught-fail) in
    {35}let server_wkad: bitstring = (if v_6 then catch-fail(hmac(h_alg,server_ats,x_4)) else caught-fail) in
    {36}let v_7: bool = not-caught-fail(server_wkad) in
    {37}let (cak: aead_key,sak: aead_key,ems_1: bitstring) = (if v_1 then (if v_3 then (if v_5 then (if v_6 then (if v_7 then (client_wkad,server_wkad,ems) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
    {38}let client_hash_msg: bitstring = hmac(h_alg,cfin,cur_log) in
    {39}let client_finished_msg: msg = FIN(client_hash_msg) in
    {40}let cur_log': bitstring = (cur_log,client_finished_msg) in
    {42}let h_5: bitstring = catch-fail(hash(h_alg,cur_log')) in
    {43}let v_8: bool = not-caught-fail(h_5) in
    {41}let l_5: label = tls13_resumption_master_secret in
    {44}let x_5: bitstring = (if v_8 then (l_5,h_5) else caught-fail) in
    {45}let rms: bitstring = (if v_8 then hmac(h_alg,master_secret,x_5) else fail-any) in
    {46}let enc_client_finished_msg: bitstring = aead_enc(a_alg,chk,zero,zero,client_finished_msg) in
    {47}out(io, enc_client_finished_msg);
    {48}event SanityClientCFIN(id_client,cr,sr,psk,master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,ems_1,rms,cur_log')
) | (
    {49}!
    {50}in(ch_client_FIN, (id_client_1: idProc,cr_1: bytes32,sr_1: bytes32,h_alg_1: hash_alg,a_alg_1: aead_alg,c_dom: domain,psk_1: preSharedKey,cert_req: bool,s_pkey_1: pubkey,master_secret_1: bitstring,chk_1: aead_key,shk_1: aead_key,cfin_1: mac_key,sfin_1: mac_key,cur_log_1: bitstring));
    {51}new st[]: bitstring;
    {52}event PreciseMess(ch_client_FIN,id_client_1,st,master_secret_1);
    {53}in(io, enc_finished_msg: bitstring);
    {54}let finished_msg: msg = aead_dec(a_alg_1,shk_1,zero,zero,enc_finished_msg) in
    (
        {55}let FIN(hash_msg: bitstring) = finished_msg in
        (
            {56}if (hash_msg = hmac(h_alg_1,sfin_1,cur_log_1)) then
            {57}let cur_log2: bitstring = (cur_log_1,finished_msg) in
            {58}if cert_req then
            (
                {70}get long_term_keys(c_dom': domain,sk: privkey,c_pkey_1: pubkey,crt: certificate) in
                {59}event Selected_lgt(c_dom',c_dom,sk,c_pkey_1,crt);
                {60}let certificate_msg: msg = CRT(zero,crt) in
                {61}let encrypted_certificate_msg: bitstring = aead_enc(a_alg_1,chk_1,zero,zero,certificate_msg) in
                {62}out(io, encrypted_certificate_msg);
                {63}let cur_log2_1: bitstring = (cur_log2,certificate_msg) in
                {64}let signed_log: bitstring = sign(sk,hash(h_alg_1,cur_log2_1)) in
                {65}let certificate_verify_msg: msg = CV(signed_log) in
                {66}let encrypted_certificate_verify_msg: bitstring = aead_enc(a_alg_1,chk_1,zero,zero,certificate_verify_msg) in
                {67}out(io, encrypted_certificate_verify_msg);
                {68}let cur_log3: bitstring = (cur_log2_1,certificate_verify_msg) in
                {69}out(ch_client_CFIN, (id_client_1,cr_1,sr_1,h_alg_1,a_alg_1,NoPSK,s_pkey_1,c_pkey_1,master_secret_1,chk_1,shk_1,cfin_1,sfin_1,cur_log3))
            )
            else
                {71}out(ch_client_CFIN, (id_client_1,cr_1,sr_1,h_alg_1,a_alg_1,psk_1,s_pkey_1,NoPubKey,master_secret_1,chk_1,shk_1,cfin_1,sfin_1,cur_log2))
        )
        else
            {72}out(io, unexpected_message)
    )
    else
        {73}out(io, bad_record_mac)
) | (
    {74}!
    {75}in(ch_client_CRT, (id_client_2: idProc,cr_2: bytes32,sr_2: bytes32,h_alg_2: hash_alg,a_alg_2: aead_alg,c_dom_1: domain,s_dom: domain,psk_2: preSharedKey,cert_req_1: bool,master_secret_2: bitstring,chk_2: aead_key,shk_2: aead_key,cfin_2: mac_key,sfin_2: mac_key,cur_log_2: bitstring,certificate_msg_1: msg));
    {76}let CRT(=zero,crt_1: certificate) = certificate_msg_1 in
    {78}in(io, enc_crt_verif_msg: bitstring);
    {79}let certificate_verify_msg_1: msg = aead_dec(a_alg_2,shk_2,zero,zero,enc_crt_verif_msg) in
    {80}let CV(signed_log_1: bitstring) = certificate_verify_msg_1 in
    {77}let cur_log2_2: bitstring = (cur_log_2,certificate_msg_1) in
    {81}if (verify(get_pkey(crt_1),hash(h_alg_2,cur_log2_2),signed_log_1) && ((get_domain(crt_1) = s_dom) && verify_cert(crt_1))) then
    {82}let s_pkey_2: pubkey = get_pkey(crt_1) in
    {83}let cur_log3_1: bitstring = (cur_log2_2,certificate_verify_msg_1) in
    {84}out(ch_client_FIN, (id_client_2,cr_2,sr_2,h_alg_2,a_alg_2,c_dom_1,psk_2,cert_req_1,s_pkey_2,master_secret_2,chk_2,shk_2,cfin_2,sfin_2,cur_log3_1))
) | (
    {85}!
    {86}in(ch_client_after_EE, (id_client_3: idProc,cr_3: bytes32,sr_3: bytes32,h_alg_3: hash_alg,a_alg_3: aead_alg,c_dom_2: domain,s_dom_1: domain,psk_3: preSharedKey,master_secret_3: bitstring,chk_3: aead_key,shk_3: aead_key,cfin_3: mac_key,sfin_3: mac_key,cur_log_3: bitstring));
    {87}new st_1[]: bitstring;
    {88}event PreciseMess(ch_client_after_EE,id_client_3,st_1,master_secret_3);
    {89}if (psk_3 = NoPSK) then
    (
        {90}in(io, enc_msg: bitstring);
        {91}let msg': msg = aead_dec(a_alg_3,shk_3,zero,zero,enc_msg) in
        {92}let CRTR(=zero) = msg' in
        (
            {94}in(io, enc_crt_msg: bitstring);
            {95}let certificate_msg_2: msg = aead_dec(a_alg_3,shk_3,zero,zero,enc_crt_msg) in
            {93}let cur_log2_3: bitstring = (cur_log_3,msg') in
            {96}out(ch_client_CRT, (id_client_3,cr_3,sr_3,h_alg_3,a_alg_3,c_dom_2,s_dom_1,psk_3,true,master_secret_3,chk_3,shk_3,cfin_3,sfin_3,cur_log2_3,certificate_msg_2))
        )
        else
            {97}let CRT(=zero,crt_2: certificate) = msg' in
                {98}out(ch_client_CRT, (id_client_3,cr_3,sr_3,h_alg_3,a_alg_3,c_dom_2,s_dom_1,psk_3,false,master_secret_3,chk_3,shk_3,cfin_3,sfin_3,cur_log_3,msg'))
            else
                {99}out(io, unexpected_message)
    )
    else
        {100}out(ch_client_FIN, (id_client_3,cr_3,sr_3,h_alg_3,a_alg_3,c_dom_2,psk_3,false,NoPubKey,master_secret_3,chk_3,shk_3,cfin_3,sfin_3,cur_log_3))
) | (
    {101}!
    {102}in(ch_server_CFIN, (id_server: idProc,cr_4: bytes32,sr_4: bytes32,h_alg_4: hash_alg,a_alg_4: aead_alg,psk_4: preSharedKey,s_pkey_3: pubkey,c_pkey_2: pubkey,master_secret_4: bitstring,chk_4: aead_key,shk_4: aead_key,cfin_4: mac_key,sfin_4: mac_key,cur_log_4: bitstring));
    {103}in(io, enc_fin: bitstring);
    {104}let fin_msg: msg = aead_dec(a_alg_4,chk_4,zero,zero,enc_fin) in
    {105}let FIN(hash_msg_1: bitstring) = fin_msg in
    {106}if (hash_msg_1 = hmac(h_alg_4,cfin_4,cur_log_4)) then
    {108}let h_6: bitstring = catch-fail(hash(h_alg_4,cur_log_4)) in
    {109}let v_9: bool = not-caught-fail(h_6) in
    {107}let l_6: label = tls13_client_application_traffic_secret in
    {110}let x_6: bitstring = (if v_9 then (l_6,h_6) else caught-fail) in
    {111}let client_ats_1: bitstring = catch-fail((if v_9 then hmac(h_alg_4,master_secret_4,x_6) else fail-any)) in
    {112}let v_10: bool = not-caught-fail(client_ats_1) in
    {114}let h_7: bitstring = (if v_10 then catch-fail(hash(h_alg_4,cur_log_4)) else caught-fail) in
    {115}let v_11: bool = not-caught-fail(h_7) in
    {113}let l_7: label = (if v_10 then tls13_server_application_traffic_secret else caught-fail) in
    {116}let x_7: bitstring = (if v_11 then (l_7,h_7) else caught-fail) in
    {117}let server_ats_1: bitstring = (if v_10 then catch-fail((if v_11 then hmac(h_alg_4,master_secret_4,x_7) else fail-any)) else caught-fail) in
    {118}let v_12: bool = not-caught-fail(server_ats_1) in
    {120}let h_8: bitstring = (if v_12 then catch-fail(hash(h_alg_4,cur_log_4)) else caught-fail) in
    {121}let v_13: bool = not-caught-fail(h_8) in
    {119}let l_8: label = (if v_12 then tls13_exporter_master_secret else caught-fail) in
    {122}let x_8: bitstring = (if v_13 then (l_8,h_8) else caught-fail) in
    {123}let ems_2: bitstring = (if v_12 then catch-fail((if v_13 then hmac(h_alg_4,master_secret_4,x_8) else fail-any)) else caught-fail) in
    {124}let v_14: bool = not-caught-fail(ems_2) in
    {126}let h_9: bitstring = (if v_14 then zero else caught-fail) in
    {125}let l_9: label = (if v_14 then tls13_key else caught-fail) in
    {127}let x_9: bitstring = (if v_14 then (l_9,h_9) else caught-fail) in
    {128}let client_wkad_1: bitstring = (if v_14 then catch-fail(hmac(h_alg_4,client_ats_1,x_9)) else caught-fail) in
    {129}let v_15: bool = not-caught-fail(client_wkad_1) in
    {131}let h_10: bitstring = (if v_15 then zero else caught-fail) in
    {130}let l_10: label = (if v_15 then tls13_key else caught-fail) in
    {132}let x_10: bitstring = (if v_15 then (l_10,h_10) else caught-fail) in
    {133}let server_wkad_1: bitstring = (if v_15 then catch-fail(hmac(h_alg_4,server_ats_1,x_10)) else caught-fail) in
    {134}let v_16: bool = not-caught-fail(server_wkad_1) in
    {135}let (cak_1: aead_key,sak_1: aead_key,ems_3: bitstring) = (if v_10 then (if v_12 then (if v_14 then (if v_15 then (if v_16 then (client_wkad_1,server_wkad_1,ems_2) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
    {136}let cur_log_CFIN: bitstring = (cur_log_4,fin_msg) in
    {138}let h_11: bitstring = catch-fail(hash(h_alg_4,cur_log_CFIN)) in
    {139}let v_17: bool = not-caught-fail(h_11) in
    {137}let l_11: label = tls13_resumption_master_secret in
    {140}let x_11: bitstring = (if v_17 then (l_11,h_11) else caught-fail) in
    {141}let rms_1: bitstring = (if v_17 then hmac(h_alg_4,master_secret_4,x_11) else fail-any) in
    {142}event SanityServerCFIN(id_server,cr_4,sr_4,psk_4,master_secret_4,chk_4,shk_4,cfin_4,sfin_4,s_pkey_3,c_pkey_2,cak_1,sak_1,ems_3,rms_1,cur_log_CFIN)
) | (
    {143}!
    {144}in(ch_server_FIN, (id_server_1: idProc,cr_5: bytes32,sr_5: bytes32,h_alg_5: hash_alg,a_alg_5: aead_alg,psk_5: preSharedKey,cert_req_2: bool,s_pkey_4: pubkey,master_secret_5: bitstring,chk_5: aead_key,shk_5: aead_key,cfin_5: mac_key,sfin_5: mac_key,cur_log_5: bitstring));
    {145}let hash_msg_2: bitstring = hmac(h_alg_5,sfin_5,cur_log_5) in
    {146}let finished_msg_1: msg = FIN(hash_msg_2) in
    {147}let enc_finished: bitstring = aead_enc(a_alg_5,shk_5,zero,zero,finished_msg_1) in
    {148}out(io, enc_finished);
    {149}let cur_log_FIN: bitstring = (cur_log_5,finished_msg_1) in
    {150}if ((psk_5 = NoPSK) && cert_req_2) then
    (
        {151}in(io, enc_cert_msg: bitstring);
        {152}let cert_msg: msg = aead_dec(a_alg_5,chk_5,zero,zero,enc_cert_msg) in
        {153}let CRT(=zero,crt_3: certificate) = cert_msg in
        {155}in(io, enc_cert_verif_msg: bitstring);
        {156}let cert_verify_msg: msg = aead_dec(a_alg_5,chk_5,zero,zero,enc_cert_verif_msg) in
        {157}let CV(signed_log_2: bitstring) = cert_verify_msg in
        {154}let cur_log_CRT: bitstring = (cur_log_FIN,cert_msg) in
        {158}if (verify(get_pkey(crt_3),hash(h_alg_5,cur_log_CRT),signed_log_2) && verify_cert(crt_3)) then
        {159}let c_pkey_3: pubkey = get_pkey(crt_3) in
        {160}let cur_log_CV: bitstring = (cur_log_CRT,cert_verify_msg) in
        {161}out(ch_server_CFIN, (id_server_1,cr_5,sr_5,h_alg_5,a_alg_5,psk_5,s_pkey_4,c_pkey_3,master_secret_5,chk_5,shk_5,cfin_5,sfin_5,cur_log_CV))
    )
    else
        {162}out(ch_server_CFIN, (id_server_1,cr_5,sr_5,h_alg_5,a_alg_5,psk_5,s_pkey_4,NoPubKey,master_secret_5,chk_5,shk_5,cfin_5,sfin_5,cur_log_FIN))
) | (
    {163}!
    {164}in(ch_server_CRT, (id_server_2: idProc,cr_6: bytes32,sr_6: bytes32,h_alg_6: hash_alg,a_alg_6: aead_alg,s_dom_2: domain,psk_6: preSharedKey,cert_req_3: bool,master_secret_6: bitstring,chk_6: aead_key,shk_6: aead_key,cfin_6: mac_key,sfin_6: mac_key,cur_log_6: bitstring));
    {165}new st_2[]: bitstring;
    {166}event PreciseMess(ch_server_CRT,id_server_2,st_2,master_secret_6);
    {178}get long_term_keys(s_dom': domain,sk_1: privkey,s_pkey_5: pubkey,crt_4: certificate) in
    {167}event Selected_lgt(s_dom',s_dom_2,sk_1,s_pkey_5,crt_4);
    {168}let certificate_msg_3: msg = CRT(zero,crt_4) in
    {169}let encrypted_certificate_msg_1: bitstring = aead_enc(a_alg_6,shk_6,zero,zero,certificate_msg_3) in
    {170}out(io, encrypted_certificate_msg_1);
    {171}let cur_log_CRT_1: bitstring = (cur_log_6,certificate_msg_3) in
    {172}let signed_log_3: bitstring = sign(sk_1,hash(h_alg_6,cur_log_CRT_1)) in
    {173}let certificate_verify_msg_2: msg = CV(signed_log_3) in
    {174}let encrypted_certificate_verify_msg_1: bitstring = aead_enc(a_alg_6,shk_6,zero,zero,certificate_verify_msg_2) in
    {175}out(io, encrypted_certificate_verify_msg_1);
    {176}let cur_log_CV_1: bitstring = (cur_log_CRT_1,certificate_verify_msg_2) in
    {177}out(ch_server_FIN, (id_server_2,cr_6,sr_6,h_alg_6,a_alg_6,psk_6,cert_req_3,s_pkey_5,master_secret_6,chk_6,shk_6,cfin_6,sfin_6,cur_log_CV_1))
) | (
    {179}!
    {180}in(ch_server_SH, (id_server_3: idProc,use_psk: bool,is_backend: bool,cert_req_4: bool,s_dom_3: domain,g: group,h_alg_7: hash_alg,a_alg_7: aead_alg,s_extra: extraExt,encrypted_ext: bitstring,client_hello: msg,cur_log_7: bitstring));
    {181}new st_3[]: bitstring;
    {182}event PreciseMess(ch_server_SH,id_server_3,st_3,client_hello);
    {183}let CH(cr_7: bytes32,offer: params) = client_hello in
    {184}let nego(=TLS13,=h_alg_7,=a_alg_7,client_kex_ext(DHE_kex(=g,gx: element)),sni_ext: sniExt,ech_ext: echExt,psk_ext: preSharedKeyExt,extra_ext: extraExt) = offer in
    (
        {185}if (not(is_backend) || (ech_ext = ech_is_inner)) then
        (
            {186}if (sni_ext = SNI(s_dom_3)) then
            (
                {187}let v_18: msg = client_hello in
                {188}let v_19: bool = (((TLS13 =nf 1-proj-nego(2-proj-CH(v_18))) && success?(1-proj-nego(2-proj-CH(v_18)))) && success?(1-proj-CH(v_18))) in
                {189}let extra_ext_1: extraExt = (if v_19 then 8-proj-nego(2-proj-CH(v_18)) else caught-fail) in
                {190}let psk_ext_1: preSharedKeyExt = (if v_19 then 7-proj-nego(2-proj-CH(v_18)) else caught-fail) in
                {191}let ech_ext_1: echExt = (if v_19 then 6-proj-nego(2-proj-CH(v_18)) else caught-fail) in
                {192}let sni_ext_1: sniExt = (if v_19 then 5-proj-nego(2-proj-CH(v_18)) else caught-fail) in
                {193}let kex_ext: keyShareExt = (if v_19 then 4-proj-nego(2-proj-CH(v_18)) else caught-fail) in
                {194}let a_alg_8: aead_alg = (if v_19 then 3-proj-nego(2-proj-CH(v_18)) else caught-fail) in
                {195}let h_alg_8: hash_alg = (if v_19 then 2-proj-nego(2-proj-CH(v_18)) else caught-fail) in
                {196}let cr_8: bytes32 = (if v_19 then 1-proj-CH(v_18) else caught-fail) in
                {197}let v_20: bitstring = (if v_19 then catch-fail((psk_ext_1,use_psk)) else caught-fail) in
                {198}let v_21: bool = (not-caught-fail(v_20) && ((success?(1-proj-client_psk_ext(1-proj-2-tuple(v_20))) && (true =nf 2-proj-2-tuple(v_20))) && success?(1-proj-2-tuple(v_20)))) in
                {199}let binders: bitstring = (if v_21 then 2-proj-client_psk_ext(1-proj-2-tuple(v_20)) else caught-fail) in
                {200}let id: identityPsk = (if v_21 then 1-proj-client_psk_ext(1-proj-2-tuple(v_20)) else caught-fail) in
                {201}let v_22: bool = (if v_21 then catch-fail(((get_receiver_psk(id) = s_dom_3) && (get_hash_psk(id) = h_alg_8))) else caught-fail) in
                {202}let psk_7: preSharedKey = (if v_22 then catch-fail(PSK(get_ipsk(id))) else caught-fail) in
                {203}let v_23: bool = not-caught-fail(psk_7) in
                {205}let k: bitstring = (if v_23 then catch-fail(psk2b(psk_7)) else caught-fail) in
                {206}let v_24: bool = not-caught-fail(k) in
                {204}let s: bitstring = (if v_23 then zero else caught-fail) in
                {207}let early_secret: bitstring = (if v_23 then catch-fail((if v_24 then hmac(h_alg_8,s,k) else fail-any)) else caught-fail) in
                {208}let v_25: bool = not-caught-fail(early_secret) in
                {210}let m: bitstring = (if v_25 then zero else caught-fail) in
                {211}let h_12: bitstring = (if v_25 then catch-fail(hash(h_alg_8,m)) else caught-fail) in
                {212}let v_26: bool = not-caught-fail(h_12) in
                {209}let l_12: label = (if v_25 then tls13_resumption_psk_binder_key else caught-fail) in
                {213}let x_12: bitstring = (if v_26 then (l_12,h_12) else caught-fail) in
                {214}let binder_key: bitstring = (if v_25 then catch-fail((if v_26 then hmac(h_alg_8,early_secret,x_12) else fail-any)) else caught-fail) in
                {215}let v_27: bool = not-caught-fail(binder_key) in
                {216}let v_28: bitstring = (if v_23 then catch-fail((if v_25 then (if v_27 then (early_secret,binder_key) else fail-any) else fail-any)) else caught-fail) in
                {217}let v_29: bool = (not-caught-fail(v_28) && success?(1-proj-2-tuple(v_28))) in
                {218}let kb: mac_key = (if v_29 then 2-proj-2-tuple(v_28) else caught-fail) in
                {219}let early_secret_1: bitstring = (if v_29 then 1-proj-2-tuple(v_28) else caught-fail) in
                {222}let psk_8: preSharedKey = (if is-false(v_22) then NoPSK else caught-fail) in
                {224}let k_1: bitstring = (if is-false(v_22) then catch-fail(psk2b(psk_8)) else caught-fail) in
                {225}let v_30: bool = not-caught-fail(k_1) in
                {223}let s_1: bitstring = (if is-false(v_22) then zero else caught-fail) in
                {226}let early_secret_2: bitstring = (if is-false(v_22) then catch-fail((if v_30 then hmac(h_alg_8,s_1,k_1) else fail-any)) else caught-fail) in
                {227}let v_31: bool = not-caught-fail(early_secret_2) in
                {229}let m_1: bitstring = (if v_31 then zero else caught-fail) in
                {230}let h_13: bitstring = (if v_31 then catch-fail(hash(h_alg_8,m_1)) else caught-fail) in
                {231}let v_32: bool = not-caught-fail(h_13) in
                {228}let l_13: label = (if v_31 then tls13_resumption_psk_binder_key else caught-fail) in
                {232}let x_13: bitstring = (if v_32 then (l_13,h_13) else caught-fail) in
                {233}let binder_key_1: bitstring = (if v_31 then catch-fail((if v_32 then hmac(h_alg_8,early_secret_2,x_13) else fail-any)) else caught-fail) in
                {234}let v_33: bool = not-caught-fail(binder_key_1) in
                {235}let v_34: bitstring = (if is-false(v_22) then catch-fail((if v_31 then (if v_33 then (early_secret_2,binder_key_1) else fail-any) else fail-any)) else caught-fail) in
                {236}let v_35: bool = (not-caught-fail(v_34) && success?(1-proj-2-tuple(v_34))) in
                {237}let kb_1: mac_key = (if v_35 then 2-proj-2-tuple(v_34) else caught-fail) in
                {238}let es: bitstring = (if v_35 then 1-proj-2-tuple(v_34) else caught-fail) in
                {239}let v_36: bool = (v_19 && not(v_21)) in
                {240}let psk_9: preSharedKey = (if v_36 then NoPSK else caught-fail) in
                {242}let k_2: bitstring = (if v_36 then catch-fail(psk2b(psk_9)) else caught-fail) in
                {243}let v_37: bool = not-caught-fail(k_2) in
                {241}let s_2: bitstring = (if v_36 then zero else caught-fail) in
                {244}let early_secret_3: bitstring = (if v_36 then catch-fail((if v_37 then hmac(h_alg_8,s_2,k_2) else fail-any)) else caught-fail) in
                {245}let v_38: bool = not-caught-fail(early_secret_3) in
                {247}let m_2: bitstring = (if v_38 then zero else caught-fail) in
                {248}let h_14: bitstring = (if v_38 then catch-fail(hash(h_alg_8,m_2)) else caught-fail) in
                {249}let v_39: bool = not-caught-fail(h_14) in
                {246}let l_14: label = (if v_38 then tls13_resumption_psk_binder_key else caught-fail) in
                {250}let x_14: bitstring = (if v_39 then (l_14,h_14) else caught-fail) in
                {251}let binder_key_2: bitstring = (if v_38 then catch-fail((if v_39 then hmac(h_alg_8,early_secret_3,x_14) else fail-any)) else caught-fail) in
                {252}let v_40: bool = not-caught-fail(binder_key_2) in
                {253}let v_41: bitstring = (if v_36 then catch-fail((if v_38 then (if v_40 then (early_secret_3,binder_key_2) else fail-any) else fail-any)) else caught-fail) in
                {254}let v_42: bool = (not-caught-fail(v_41) && success?(1-proj-2-tuple(v_41))) in
                {255}let kb_2: mac_key = (if v_42 then 2-proj-2-tuple(v_41) else caught-fail) in
                {256}let es_1: bitstring = (if v_42 then 1-proj-2-tuple(v_41) else caught-fail) in
                {220}let offer_1: params = (if v_29 then nego(TLS13,h_alg_8,a_alg_8,kex_ext,sni_ext_1,ech_ext_1,trunc_client_psk_ext(id),extra_ext_1) else caught-fail) in
                {221}let cur_log'_1: bitstring = (if v_29 then (cur_log_7,CH(cr_8,offer_1)) else caught-fail) in
                {257}let (early_secret_4: bitstring,s_psk_ext: preSharedKeyExt,psk_10: preSharedKey) = (if v_19 then (if v_21 then (if undo-catch-fail(v_22) then (if v_23 then (if v_29 then (if (binders = hmac(h_alg_8,kb,cur_log'_1)) then (early_secret_1,server_psk_ext(1),psk_7) else fail-any) else fail-any) else fail-any) else (if v_35 then (es,empty_psk_ext,NoPSK) else fail-any)) else (if v_42 then (es_1,empty_psk_ext,NoPSK) else fail-any)) else fail-any) in
                {258}let cur_log_CH: bitstring = (cur_log_7,client_hello) in
                {259}event SanityServerCH(id_server_3,is_backend,cr_7,s_dom_3,psk_10,cur_log_CH);
                {260}new s_3[]: seed;
                {261}let (gxy: element,gy: element) = (dh_xy(s_3,client_hello),dh_encap_fun(g,gx,dh_xy(s_3,client_hello))) in
                {263}let m_3: bitstring = catch-fail(hash(h_alg_7,zero)) in
                {264}let v_43: bool = not-caught-fail(m_3) in
                {265}let h_15: bitstring = (if v_43 then catch-fail(hash(h_alg_7,m_3)) else caught-fail) in
                {266}let v_44: bool = not-caught-fail(h_15) in
                {262}let l_15: label = tls13_derived in
                {267}let x_15: bitstring = (if v_44 then (l_15,h_15) else caught-fail) in
                {268}let extra: bitstring = catch-fail((if v_43 then (if v_44 then hmac(h_alg_7,early_secret_4,x_15) else fail-any) else fail-any)) in
                {269}let v_45: bool = not-caught-fail(extra) in
                {270}let handshake_secret: bitstring = (if v_45 then hmac(h_alg_7,extra,gxy) else fail-any) in
                {273}new sr24[]: bytes24;
                {283}new rand24[]: bytes24;
                {284}new rand8[]: bytes8;
                {272}let v_46: bool = is_backend in
                {271}let s_offer: params = nego(TLS13,h_alg_7,a_alg_7,server_kex_ext(DHE_kex(g,gy)),empty_sni_ext,empty_ech_ext,s_psk_ext,s_extra) in
                {274}let SH_ECHConf: msg = (if v_46 then SH(B32(sr24,zero8),s_offer) else caught-fail) in
                {275}let cur_log_SH_ech: bitstring = (if v_46 then (cur_log_CH,SH_ECHConf) else caught-fail) in
                {277}let h_16: bitstring = (if v_46 then catch-fail(hash(h_alg_7,cur_log_SH_ech)) else caught-fail) in
                {278}let v_47: bool = not-caught-fail(h_16) in
                {276}let l_16: label = (if v_46 then ech_accept_confirmation else caught-fail) in
                {279}let x_16: bitstring = (if v_47 then (l_16,h_16) else caught-fail) in
                {280}let accept_confirmation: bitstring = (if v_46 then catch-fail((if v_47 then hmac(h_alg_7,handshake_secret,x_16) else fail-any)) else caught-fail) in
                {281}let v_48: bool = not-caught-fail(accept_confirmation) in
                {282}let sr8: bytes8 = (if v_48 then crop_into_bytes8(accept_confirmation) else caught-fail) in
                {285}let sr_7: bytes32 = (if v_46 then (if v_48 then B32(sr24,sr8) else fail-any) else B32(rand24,rand8)) in
                {286}let server_hello: msg = SH(sr_7,s_offer) in
                {287}out(io, server_hello);
                {288}let cur_log_SH: bitstring = (cur_log_CH,server_hello) in
                {289}event SanityServerSH(id_server_3,cr_7,sr_7,s_dom_3,handshake_secret,psk_10,cur_log_SH);
                {291}let m_4: bitstring = catch-fail(hash(h_alg_7,zero)) in
                {292}let v_49: bool = not-caught-fail(m_4) in
                {293}let h_17: bitstring = (if v_49 then catch-fail(hash(h_alg_7,m_4)) else caught-fail) in
                {294}let v_50: bool = not-caught-fail(h_17) in
                {290}let l_17: label = tls13_derived in
                {295}let x_17: bitstring = (if v_50 then (l_17,h_17) else caught-fail) in
                {296}let extra_1: bitstring = catch-fail((if v_49 then (if v_50 then hmac(h_alg_7,handshake_secret,x_17) else fail-any) else fail-any)) in
                {297}let v_51: bool = not-caught-fail(extra_1) in
                {298}let k_3: bitstring = (if v_51 then zero else caught-fail) in
                {299}let master_secret_7: bitstring = (if v_51 then catch-fail(hmac(h_alg_7,handshake_secret,k_3)) else caught-fail) in
                {300}let v_52: bool = not-caught-fail(master_secret_7) in
                {302}let h_18: bitstring = (if v_52 then catch-fail(hash(h_alg_7,cur_log_SH)) else caught-fail) in
                {303}let v_53: bool = not-caught-fail(h_18) in
                {301}let l_18: label = (if v_52 then tls13_client_handshake_traffic_secret else caught-fail) in
                {304}let x_18: bitstring = (if v_53 then (l_18,h_18) else caught-fail) in
                {305}let client_hts: bitstring = (if v_52 then catch-fail((if v_53 then hmac(h_alg_7,handshake_secret,x_18) else fail-any)) else caught-fail) in
                {306}let v_54: bool = not-caught-fail(client_hts) in
                {308}let h_19: bitstring = (if v_54 then catch-fail(hash(h_alg_7,cur_log_SH)) else caught-fail) in
                {309}let v_55: bool = not-caught-fail(h_19) in
                {307}let l_19: label = (if v_54 then tls13_server_handshake_traffic_secret else caught-fail) in
                {310}let x_19: bitstring = (if v_55 then (l_19,h_19) else caught-fail) in
                {311}let server_hts: bitstring = (if v_54 then catch-fail((if v_55 then hmac(h_alg_7,handshake_secret,x_19) else fail-any)) else caught-fail) in
                {312}let v_56: bool = not-caught-fail(server_hts) in
                {314}let h_20: bitstring = (if v_56 then zero else caught-fail) in
                {313}let l_20: label = (if v_56 then tls13_key else caught-fail) in
                {315}let x_20: bitstring = (if v_56 then (l_20,h_20) else caught-fail) in
                {316}let client_wkh: bitstring = (if v_56 then catch-fail(hmac(h_alg_7,client_hts,x_20)) else caught-fail) in
                {317}let v_57: bool = not-caught-fail(client_wkh) in
                {319}let h_21: bitstring = (if v_57 then zero else caught-fail) in
                {318}let l_21: label = (if v_57 then tls13_key else caught-fail) in
                {320}let x_21: bitstring = (if v_57 then (l_21,h_21) else caught-fail) in
                {321}let server_wkh: bitstring = (if v_57 then catch-fail(hmac(h_alg_7,server_hts,x_21)) else caught-fail) in
                {322}let v_58: bool = not-caught-fail(server_wkh) in
                {324}let h_22: bitstring = (if v_58 then zero else caught-fail) in
                {323}let l_22: label = (if v_58 then tls13_finished else caught-fail) in
                {325}let x_22: bitstring = (if v_58 then (l_22,h_22) else caught-fail) in
                {326}let client_fk: bitstring = (if v_58 then catch-fail(hmac(h_alg_7,client_hts,x_22)) else caught-fail) in
                {327}let v_59: bool = not-caught-fail(client_fk) in
                {329}let h_23: bitstring = (if v_59 then zero else caught-fail) in
                {328}let l_23: label = (if v_59 then tls13_finished else caught-fail) in
                {330}let x_23: bitstring = (if v_59 then (l_23,h_23) else caught-fail) in
                {331}let server_fk: bitstring = (if v_59 then catch-fail(hmac(h_alg_7,server_hts,x_23)) else caught-fail) in
                {332}let v_60: bool = not-caught-fail(server_fk) in
                {333}let (master_secret_8: bitstring,chk_7: aead_key,shk_7: aead_key,cfin_7: mac_key,sfin_7: mac_key) = (if v_51 then (if v_52 then (if v_54 then (if v_56 then (if v_57 then (if v_58 then (if v_59 then (if v_60 then (master_secret_7,client_wkh,server_wkh,client_fk,server_fk) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
                {334}let ee_msg: msg = EE(encrypted_ext) in
                {335}let enc_ee: bitstring = aead_enc(a_alg_7,shk_7,zero,zero,ee_msg) in
                {336}out(io, enc_ee);
                {337}let cur_log_EE: bitstring = (cur_log_SH,ee_msg) in
                {338}if (psk_10 = NoPSK) then
                (
                    {339}if cert_req_4 then
                    (
                        {340}let crtr_msg: msg = CRTR(zero) in
                        {341}let enc_crt: bitstring = aead_enc(a_alg_7,shk_7,zero,zero,crtr_msg) in
                        {342}out(io, enc_crt);
                        {343}let cur_log_CRTR: bitstring = (cur_log_EE,crtr_msg) in
                        {344}out(ch_server_CRT, (id_server_3,cr_7,sr_7,h_alg_7,a_alg_7,s_dom_3,psk_10,cert_req_4,master_secret_8,chk_7,shk_7,cfin_7,sfin_7,cur_log_CRTR))
                    )
                    else
                        {345}out(ch_server_CRT, (id_server_3,cr_7,sr_7,h_alg_7,a_alg_7,s_dom_3,psk_10,cert_req_4,master_secret_8,chk_7,shk_7,cfin_7,sfin_7,cur_log_EE))
                )
                else
                    {346}out(ch_server_FIN, (id_server_3,cr_7,sr_7,h_alg_7,a_alg_7,psk_10,false,NoPubKey,master_secret_8,chk_7,shk_7,cfin_7,sfin_7,cur_log_EE))
            )
            else
                {347}out(io, illegal_parameter)
        )
        else
            {348}out(io, illegal_parameter)
    )
    else
        {349}out(io, handshake_failure)
) | (
    {350}!
    {351}in(io, a: domain);
    {352}event Same(a);
    {353}new s_4: seed;
    {354}let sk_h: privkey = uc_privkey(s_4) in
    {355}event GenCert(a,pk(sk_h));
    {356}insert long_term_keys(a,sk_h,pk(sk_h),valid_cert(a,pk(sk_h)));
    {357}out(io, pk(sk_h))
) | (
    {358}!
    {359}in(io, (c_dom_3: domain,s_dom_4: domain));
    {360}event Same((c_dom_3,s_dom_4));
    {361}new s_5: seed;
    {362}let psk_11: internal_preSharedKey = uc_psk(s_5) in
    {364}event GenPsk(c_dom_3,s_dom_4,PSK(psk_11));
    {363}let id_1: identityPsk = mk_idpsk(c_dom_3,s_dom_4,tls_h,psk_11) in
    {365}insert pre_shared_keys(c_dom_3,s_dom_4,tls_h,id_1,psk_11)
) | (
    {366}!
    {367}in(io, o_dom: domain);
    {368}new id_2: configId;
    {369}new s_6[]: seed;
    {6}let ech_g: group = id_g(StrongDH,2) in
    {370}let gx_1: element = dh_pub(ech_g,dh_k(s_6)) in
    {371}let (skR: bitstring,pkR: element) = (dh_k(s_6),gx_1) in
    {5}let ech_a: aead_alg = id_aead(StrongAE,2) in
    {4}let ech_h: hash_alg = id_hash(StrongHash,2) in
    {372}let config: echConfig = ech_config(id_2,ech_g,pkR,o_dom,ech_h,ech_a) in
    {373}insert ech_configurations(config,skR);
    {374}let config_1: echConfig = config in
    {375}out(io, config_1)
) | (
    {376}!
    {380}get pre_shared_keys(c_dom1: domain,s_dom1: domain,h_alg1: hash_alg,id1: identityPsk,psk1: internal_preSharedKey) in
    {379}get pre_shared_keys(c_dom2: domain,s_dom2: domain,h_alg2: hash_alg,id2: identityPsk,psk2: internal_preSharedKey) in
    {377}insert pre_shared_keys(choice[c_dom1,c_dom2],choice[s_dom1,s_dom2],choice[h_alg1,h_alg2],choice[id1,id2],choice[psk1,psk2]);
    {378}insert pre_shared_keys(choice[c_dom2,c_dom1],choice[s_dom2,s_dom1],choice[h_alg1,h_alg2],choice[id2,id1],choice[psk2,psk1])
) | (
    {381}!
    {385}get long_term_keys(dom1: domain,sk1: privkey,pk1: pubkey,cert1: certificate) in
    {384}get long_term_keys(dom2: domain,sk2: privkey,pk2: pubkey,cert2: certificate) in
    {382}insert long_term_keys(choice[dom1,dom2],choice[sk1,sk2],choice[pk1,pk2],choice[cert1,cert2]);
    {383}insert long_term_keys(choice[dom2,dom1],choice[sk2,sk1],choice[pk2,pk1],choice[cert2,cert1])
) | (
    {386}!
    {387}in(io, a_1: domain);
    {388}event Same(a_1);
    {389}new sk_d: privkey;
    {390}out(io, (sk_d,valid_cert(a_1,pk(sk_d))))
) | (
    {391}!
    {392}in(io, (c_dom_4: domain,s_dom_5: domain));
    {393}event Same((c_dom_4,s_dom_5));
    {394}new psk_d: internal_preSharedKey;
    {395}let id_3: identityPsk = mk_idpsk(c_dom_4,s_dom_5,tls_h,psk_d) in
    {396}insert pre_shared_keys(c_dom_4,s_dom_5,tls_h,id_3,psk_d);
    {397}out(io, id_3)
) | (
    {3}let tls_g: group = id_g(StrongDH,1) in
    {2}let tls_a: aead_alg = id_aead(StrongAE,1) in
    (
        {398}!
        {401}in(io, (c_dom_5: domain,s_dom_6: domain));
        {400}let send_kex: bool = true in
        {399}let use_psk_1: bool = false in
        {402}event Same((use_psk_1,send_kex,c_dom_5,s_dom_6));
        {404}new id_client_4[]: idProc;
        {405}event SanityClient(id_client_4,false,false,use_psk_1,send_kex);
        {407}new rand24_1[]: bytes24;
        {408}new rand8_1[]: bytes8;
        {410}new s_7[]: seed;
        {411}let gx_2: element = dh_pub(tls_g,dh_k(s_7)) in
        {412}let v_61: bitstring = (dh_k(s_7),gx_2) in
        {413}let v_62: bool = success?(1-proj-2-tuple(v_61)) in
        {414}let gx_3: element = (if v_62 then 2-proj-2-tuple(v_61) else caught-fail) in
        {415}let x_24: bitstring = (if v_62 then 1-proj-2-tuple(v_61) else caught-fail) in
        {416}let kex: kex_alg = (if v_62 then (if send_kex then DHE_kex(tls_g,gx_3) else DHE_group(tls_g)) else caught-fail) in
        {417}let (kex_ext_1: keyShareExt,kex_data: bitstring) = (if v_62 then (client_kex_ext(kex),(x_24,tls_g,send_kex)) else fail-any) in
        {738}get pre_shared_keys(c_dom'_1: domain,s_dom'_1: domain,=tls_h,id_4: identityPsk,internal_psk: internal_preSharedKey) in
        {419}event Selected_psk(c_dom_5,c_dom'_1,s_dom_6,s_dom'_1,id_4,internal_psk);
        {420}let v_63: bool = use_psk_1 in
        {421}let psk_12: preSharedKey = (if v_63 then PSK(internal_psk) else caught-fail) in
        {425}let k_4: bitstring = (if v_63 then catch-fail(psk2b(psk_12)) else caught-fail) in
        {426}let v_64: bool = not-caught-fail(k_4) in
        {424}let s_8: bitstring = (if v_63 then zero else caught-fail) in
        {427}let early_secret_5: bitstring = (if v_63 then catch-fail((if v_64 then hmac(tls_h,s_8,k_4) else fail-any)) else caught-fail) in
        {428}let v_65: bool = not-caught-fail(early_secret_5) in
        {430}let m_5: bitstring = (if v_65 then zero else caught-fail) in
        {431}let h_24: bitstring = (if v_65 then catch-fail(hash(tls_h,m_5)) else caught-fail) in
        {432}let v_66: bool = not-caught-fail(h_24) in
        {429}let l_24: label = (if v_65 then tls13_resumption_psk_binder_key else caught-fail) in
        {433}let x_25: bitstring = (if v_66 then (l_24,h_24) else caught-fail) in
        {434}let binder_key_3: bitstring = (if v_65 then catch-fail((if v_66 then hmac(tls_h,early_secret_5,x_25) else fail-any)) else caught-fail) in
        {435}let v_67: bool = not-caught-fail(binder_key_3) in
        {436}let v_68: bitstring = (if v_63 then catch-fail((if v_65 then (if v_67 then (early_secret_5,binder_key_3) else fail-any) else fail-any)) else caught-fail) in
        {437}let v_69: bool = (not-caught-fail(v_68) && success?(1-proj-2-tuple(v_68))) in
        {438}let kb_3: mac_key = (if v_69 then 2-proj-2-tuple(v_68) else caught-fail) in
        {439}let es_2: bitstring = (if v_69 then 1-proj-2-tuple(v_68) else caught-fail) in
        {442}let psk_13: preSharedKey = (if not(v_63) then NoPSK else caught-fail) in
        {444}let k_5: bitstring = (if not(v_63) then catch-fail(psk2b(psk_13)) else caught-fail) in
        {445}let v_71: bool = not-caught-fail(k_5) in
        {443}let s_9: bitstring = (if not(v_63) then zero else caught-fail) in
        {446}let early_secret_6: bitstring = (if not(v_63) then catch-fail((if v_71 then hmac(tls_h,s_9,k_5) else fail-any)) else caught-fail) in
        {447}let v_72: bool = not-caught-fail(early_secret_6) in
        {449}let m_6: bitstring = (if v_72 then zero else caught-fail) in
        {450}let h_25: bitstring = (if v_72 then catch-fail(hash(tls_h,m_6)) else caught-fail) in
        {451}let v_73: bool = not-caught-fail(h_25) in
        {448}let l_25: label = (if v_72 then tls13_resumption_psk_binder_key else caught-fail) in
        {452}let x_26: bitstring = (if v_73 then (l_25,h_25) else caught-fail) in
        {453}let binder_key_4: bitstring = (if v_72 then catch-fail((if v_73 then hmac(tls_h,early_secret_6,x_26) else fail-any)) else caught-fail) in
        {454}let v_74: bool = not-caught-fail(binder_key_4) in
        {455}let v_75: bitstring = (if not(v_63) then catch-fail((if v_72 then (if v_74 then (early_secret_6,binder_key_4) else fail-any) else fail-any)) else caught-fail) in
        {456}let v_76: bool = (not-caught-fail(v_75) && success?(1-proj-2-tuple(v_75))) in
        {457}let kb_4: mac_key = (if v_76 then 2-proj-2-tuple(v_75) else caught-fail) in
        {458}let es_3: bitstring = (if v_76 then 1-proj-2-tuple(v_75) else caught-fail) in
        {418}let ech_ext_2: echExt = empty_ech_ext in
        {403}let extra_2: extraExt = empty_extra_ext in
        {422}let offer_2: params = (if v_63 then nego(TLS13,tls_h,tls_a,kex_ext_1,SNI(s_dom_6),ech_ext_2,trunc_client_psk_ext(id_4),extra_2) else caught-fail) in
        {409}let cr_9: bytes32 = B32(rand24_1,rand8_1) in
        {406}let cur_log_8: bitstring = zero in
        {423}let cur_log'_2: bitstring = (if v_63 then (cur_log_8,CH(cr_9,offer_2)) else caught-fail) in
        {440}let binders_1: bitstring = (if v_69 then catch-fail(hmac(tls_h,kb_3,cur_log'_2)) else caught-fail) in
        {441}let v_70: bool = not-caught-fail(binders_1) in
        {459}let v_77: bitstring = catch-fail((if v_63 then (if v_69 then (if v_70 then (client_psk_ext(id_4,binders_1),(tls_h,psk_12,es_2)) else fail-any) else fail-any) else (if v_76 then (empty_psk_ext,(tls_h,NoPSK,es_3)) else fail-any))) in
        {460}let v_78: bool = (not-caught-fail(v_77) && success?(1-proj-2-tuple(v_77))) in
        {461}let psk_data: bitstring = (if v_78 then 2-proj-2-tuple(v_77) else caught-fail) in
        {462}let psk_ext_2: preSharedKeyExt = (if v_78 then 1-proj-2-tuple(v_77) else caught-fail) in
        {463}let offer_3: params = (if v_78 then nego(TLS13,tls_h,tls_a,kex_ext_1,SNI(s_dom_6),empty_ech_ext,psk_ext_2,extra_2) else caught-fail) in
        {464}let (client_hello_1: msg,cr_10: bytes32,kex_ext_2: keyShareExt,kex_data_1: bitstring,psk_data_1: bitstring) = (if v_78 then (CH(cr_9,offer_3),cr_9,kex_ext_1,kex_data,psk_data) else fail-any) in
        {465}out(io, client_hello_1);
        {467}let (=tls_h,psk_14: preSharedKey,es_4: bitstring) = psk_data_1 in
        {466}let cur_log2_4: bitstring = (cur_log_8,client_hello_1) in
        {468}event SanityClientCH(id_client_4,zero32,cr_10,c_dom_5,s_dom_6,psk_14,cur_log2_4);
        {469}in(io, server_hello_1: msg);
        {470}let SH(sr_8: bytes32,mode: params) = server_hello_1 in
        (
            {471}if (sr_8 = rand_HelloRetryRequest) then
            (
                {472}let (nego(=TLS13,=tls_h,=tls_a,hrr_kex_ext(=tls_g),=empty_sni_ext,=empty_ech_ext,=empty_psk_ext,srv_extra: extraExt),=false) = (mode,send_kex) in
                (
                    {473}let cur_log3_2: bitstring = (cur_log2_4,server_hello_1) in
                    {474}event SanityClientHRR(id_client_4,cr_10,c_dom_5,s_dom_6,cur_log3_2);
                    {476}new rand24_2[]: bytes24;
                    {477}new rand8_2[]: bytes8;
                    {479}new s_10[]: seed;
                    {480}let gx_4: element = dh_pub(tls_g,dh_k(s_10)) in
                    {481}let v_79: bitstring = (dh_k(s_10),gx_4) in
                    {482}let v_80: bool = success?(1-proj-2-tuple(v_79)) in
                    {483}let gx_5: element = (if v_80 then 2-proj-2-tuple(v_79) else caught-fail) in
                    {484}let x_27: bitstring = (if v_80 then 1-proj-2-tuple(v_79) else caught-fail) in
                    {475}let send_kex_1: bool = true in
                    {485}let kex_1: kex_alg = (if v_80 then (if send_kex_1 then DHE_kex(tls_g,gx_5) else DHE_group(tls_g)) else caught-fail) in
                    {486}let (kex_ext_3: keyShareExt,kex_data_2: bitstring) = (if v_80 then (client_kex_ext(kex_1),(x_27,tls_g,send_kex_1)) else fail-any) in
                    {638}get pre_shared_keys(c_dom'_2: domain,s_dom'_2: domain,=tls_h,id_5: identityPsk,internal_psk_1: internal_preSharedKey) in
                    {488}event Selected_psk(c_dom_5,c_dom'_2,s_dom_6,s_dom'_2,id_5,internal_psk_1);
                    {489}let v_81: bool = use_psk_1 in
                    {490}let psk_15: preSharedKey = (if v_81 then PSK(internal_psk_1) else caught-fail) in
                    {494}let k_6: bitstring = (if v_81 then catch-fail(psk2b(psk_15)) else caught-fail) in
                    {495}let v_82: bool = not-caught-fail(k_6) in
                    {493}let s_11: bitstring = (if v_81 then zero else caught-fail) in
                    {496}let early_secret_7: bitstring = (if v_81 then catch-fail((if v_82 then hmac(tls_h,s_11,k_6) else fail-any)) else caught-fail) in
                    {497}let v_83: bool = not-caught-fail(early_secret_7) in
                    {499}let m_7: bitstring = (if v_83 then zero else caught-fail) in
                    {500}let h_26: bitstring = (if v_83 then catch-fail(hash(tls_h,m_7)) else caught-fail) in
                    {501}let v_84: bool = not-caught-fail(h_26) in
                    {498}let l_26: label = (if v_83 then tls13_resumption_psk_binder_key else caught-fail) in
                    {502}let x_28: bitstring = (if v_84 then (l_26,h_26) else caught-fail) in
                    {503}let binder_key_5: bitstring = (if v_83 then catch-fail((if v_84 then hmac(tls_h,early_secret_7,x_28) else fail-any)) else caught-fail) in
                    {504}let v_85: bool = not-caught-fail(binder_key_5) in
                    {505}let v_86: bitstring = (if v_81 then catch-fail((if v_83 then (if v_85 then (early_secret_7,binder_key_5) else fail-any) else fail-any)) else caught-fail) in
                    {506}let v_87: bool = (not-caught-fail(v_86) && success?(1-proj-2-tuple(v_86))) in
                    {507}let kb_5: mac_key = (if v_87 then 2-proj-2-tuple(v_86) else caught-fail) in
                    {508}let es_5: bitstring = (if v_87 then 1-proj-2-tuple(v_86) else caught-fail) in
                    {511}let psk_16: preSharedKey = (if not(v_81) then NoPSK else caught-fail) in
                    {513}let k_7: bitstring = (if not(v_81) then catch-fail(psk2b(psk_16)) else caught-fail) in
                    {514}let v_89: bool = not-caught-fail(k_7) in
                    {512}let s_12: bitstring = (if not(v_81) then zero else caught-fail) in
                    {515}let early_secret_8: bitstring = (if not(v_81) then catch-fail((if v_89 then hmac(tls_h,s_12,k_7) else fail-any)) else caught-fail) in
                    {516}let v_90: bool = not-caught-fail(early_secret_8) in
                    {518}let m_8: bitstring = (if v_90 then zero else caught-fail) in
                    {519}let h_27: bitstring = (if v_90 then catch-fail(hash(tls_h,m_8)) else caught-fail) in
                    {520}let v_91: bool = not-caught-fail(h_27) in
                    {517}let l_27: label = (if v_90 then tls13_resumption_psk_binder_key else caught-fail) in
                    {521}let x_29: bitstring = (if v_91 then (l_27,h_27) else caught-fail) in
                    {522}let binder_key_6: bitstring = (if v_90 then catch-fail((if v_91 then hmac(tls_h,early_secret_8,x_29) else fail-any)) else caught-fail) in
                    {523}let v_92: bool = not-caught-fail(binder_key_6) in
                    {524}let v_93: bitstring = (if not(v_81) then catch-fail((if v_90 then (if v_92 then (early_secret_8,binder_key_6) else fail-any) else fail-any)) else caught-fail) in
                    {525}let v_94: bool = (not-caught-fail(v_93) && success?(1-proj-2-tuple(v_93))) in
                    {526}let kb_6: mac_key = (if v_94 then 2-proj-2-tuple(v_93) else caught-fail) in
                    {527}let es_6: bitstring = (if v_94 then 1-proj-2-tuple(v_93) else caught-fail) in
                    {487}let ech_ext_3: echExt = empty_ech_ext in
                    {491}let offer_4: params = (if v_81 then nego(TLS13,tls_h,tls_a,kex_ext_3,SNI(s_dom_6),ech_ext_3,trunc_client_psk_ext(id_5),extra_2) else caught-fail) in
                    {478}let cr_11: bytes32 = B32(rand24_2,rand8_2) in
                    {492}let cur_log'_3: bitstring = (if v_81 then (cur_log3_2,CH(cr_11,offer_4)) else caught-fail) in
                    {509}let binders_2: bitstring = (if v_87 then catch-fail(hmac(tls_h,kb_5,cur_log'_3)) else caught-fail) in
                    {510}let v_88: bool = not-caught-fail(binders_2) in
                    {528}let v_95: bitstring = catch-fail((if v_81 then (if v_87 then (if v_88 then (client_psk_ext(id_5,binders_2),(tls_h,psk_15,es_5)) else fail-any) else fail-any) else (if v_94 then (empty_psk_ext,(tls_h,NoPSK,es_6)) else fail-any))) in
                    {529}let v_96: bool = (not-caught-fail(v_95) && success?(1-proj-2-tuple(v_95))) in
                    {530}let psk_data_2: bitstring = (if v_96 then 2-proj-2-tuple(v_95) else caught-fail) in
                    {531}let psk_ext_3: preSharedKeyExt = (if v_96 then 1-proj-2-tuple(v_95) else caught-fail) in
                    {532}let offer_5: params = (if v_96 then nego(TLS13,tls_h,tls_a,kex_ext_3,SNI(s_dom_6),empty_ech_ext,psk_ext_3,extra_2) else caught-fail) in
                    {533}let (client_hello': msg,cr': bytes32,kex_ext': keyShareExt,kex_data': bitstring,psk_data': bitstring) = (if v_96 then (CH(cr_11,offer_5),cr_11,kex_ext_3,kex_data_2,psk_data_2) else fail-any) in
                    {534}out(io, client_hello');
                    {536}let (=tls_h,psk': preSharedKey,es': bitstring) = psk_data' in
                    {535}let cur_log4: bitstring = (cur_log3_2,client_hello') in
                    {537}event SanityClientCH(id_client_4,cr_10,cr',c_dom_5,s_dom_6,psk',cur_log4);
                    {538}in(io, server_hello': msg);
                    {539}let SH(sr': bytes32,mode': params) = server_hello' in
                    (
                        {540}if (sr' = rand_HelloRetryRequest) then
                            {541}out(io, unexpected_message)
                        else
                            {543}let SH(sr_9: bytes32,mode_1: params) = server_hello' in
                            {544}let (x_30: bitstring,g_1: group,=true) = kex_data' in
                            {545}let nego(=TLS13,=tls_h,=tls_a,server_kex_ext(DHE_kex(=g_1,gy_1: element)),=empty_sni_ext,=empty_ech_ext,psk_ext_4: preSharedKeyExt,extra_3: extraExt) = mode_1 in
                            (
                                {547}let v_97: bool = (psk_ext_4 = empty_psk_ext) in
                                {548}let psk_17: preSharedKey = (if v_97 then NoPSK else caught-fail) in
                                {550}let k_8: bitstring = (if v_97 then catch-fail(psk2b(psk_17)) else caught-fail) in
                                {551}let v_98: bool = not-caught-fail(k_8) in
                                {549}let s_13: bitstring = (if v_97 then zero else caught-fail) in
                                {552}let early_secret_9: bitstring = (if v_97 then catch-fail((if v_98 then hmac(tls_h,s_13,k_8) else fail-any)) else caught-fail) in
                                {553}let v_99: bool = not-caught-fail(early_secret_9) in
                                {555}let m_9: bitstring = (if v_99 then zero else caught-fail) in
                                {556}let h_28: bitstring = (if v_99 then catch-fail(hash(tls_h,m_9)) else caught-fail) in
                                {557}let v_100: bool = not-caught-fail(h_28) in
                                {554}let l_28: label = (if v_99 then tls13_resumption_psk_binder_key else caught-fail) in
                                {558}let x_31: bitstring = (if v_100 then (l_28,h_28) else caught-fail) in
                                {559}let binder_key_7: bitstring = (if v_99 then catch-fail((if v_100 then hmac(tls_h,early_secret_9,x_31) else fail-any)) else caught-fail) in
                                {560}let v_101: bool = not-caught-fail(binder_key_7) in
                                {561}let v_102: bitstring = (if v_97 then catch-fail((if v_99 then (if v_101 then (early_secret_9,binder_key_7) else fail-any) else fail-any)) else caught-fail) in
                                {562}let v_103: bool = (not-caught-fail(v_102) && success?(1-proj-2-tuple(v_102))) in
                                {563}let kb_7: mac_key = (if v_103 then 2-proj-2-tuple(v_102) else caught-fail) in
                                {564}let es_7: bitstring = (if v_103 then 1-proj-2-tuple(v_102) else caught-fail) in
                                {565}let v_104: bitstring = (if not(v_97) then catch-fail(psk_data') else caught-fail) in
                                {566}let v_105: bool = (not-caught-fail(v_104) && success?(1-proj-3-tuple(v_104))) in
                                {567}let es_8: bitstring = (if v_105 then 3-proj-3-tuple(v_104) else caught-fail) in
                                {568}let psk_18: preSharedKey = (if v_105 then 2-proj-3-tuple(v_104) else caught-fail) in
                                {569}let h'_alg: hash_alg = (if v_105 then 1-proj-3-tuple(v_104) else caught-fail) in
                                {570}let (psk_19: preSharedKey,early_secret_10: bitstring,valid: bool) = (if v_97 then (if v_103 then (NoPSK,es_7,true) else fail-any) else (if v_105 then (psk_18,es_8,((h'_alg = tls_h) && ((server_psk_ext(1) = psk_ext_4) && use_psk_1))) else fail-any)) in
                                {571}if valid then
                                (
                                    {574}new s_14[]: seed;
                                    {577}let m_10: bitstring = catch-fail(hash(tls_h,zero)) in
                                    {578}let v_107: bool = not-caught-fail(m_10) in
                                    {579}let h_29: bitstring = (if v_107 then catch-fail(hash(tls_h,m_10)) else caught-fail) in
                                    {580}let v_108: bool = not-caught-fail(h_29) in
                                    {576}let l_29: label = tls13_derived in
                                    {581}let x_32: bitstring = (if v_108 then (l_29,h_29) else caught-fail) in
                                    {582}let extra_4: bitstring = catch-fail((if v_107 then (if v_108 then hmac(tls_h,early_secret_10,x_32) else fail-any) else fail-any)) in
                                    {583}let v_109: bool = not-caught-fail(extra_4) in
                                    {572}let gxy_1: element = catch-fail(dh_decap_fun(g_1,gy_1,x_30)) in
                                    {573}let v_106: bool = not-caught-fail(gxy_1) in
                                    {575}let gxy_2: element = (if v_106 then gxy_1 else dh_f(s_14)) in
                                    {584}let handshake_secret_1: bitstring = (if v_109 then hmac(tls_h,extra_4,gxy_2) else fail-any) in
                                    {546}let cur_log2_5: bitstring = (cur_log4,server_hello') in
                                    {542}let id_client_5: idProc = id_client_4 in
                                    {585}event SanityClientSH(id_client_5,cr',sr_9,c_dom_5,s_dom_6,handshake_secret_1,psk_19,cur_log2_5);
                                    {587}let m_11: bitstring = catch-fail(hash(tls_h,zero)) in
                                    {588}let v_110: bool = not-caught-fail(m_11) in
                                    {589}let h_30: bitstring = (if v_110 then catch-fail(hash(tls_h,m_11)) else caught-fail) in
                                    {590}let v_111: bool = not-caught-fail(h_30) in
                                    {586}let l_30: label = tls13_derived in
                                    {591}let x_33: bitstring = (if v_111 then (l_30,h_30) else caught-fail) in
                                    {592}let extra_5: bitstring = catch-fail((if v_110 then (if v_111 then hmac(tls_h,handshake_secret_1,x_33) else fail-any) else fail-any)) in
                                    {593}let v_112: bool = not-caught-fail(extra_5) in
                                    {594}let k_9: bitstring = (if v_112 then zero else caught-fail) in
                                    {595}let master_secret_9: bitstring = (if v_112 then catch-fail(hmac(tls_h,handshake_secret_1,k_9)) else caught-fail) in
                                    {596}let v_113: bool = not-caught-fail(master_secret_9) in
                                    {598}let h_31: bitstring = (if v_113 then catch-fail(hash(tls_h,cur_log2_5)) else caught-fail) in
                                    {599}let v_114: bool = not-caught-fail(h_31) in
                                    {597}let l_31: label = (if v_113 then tls13_client_handshake_traffic_secret else caught-fail) in
                                    {600}let x_34: bitstring = (if v_114 then (l_31,h_31) else caught-fail) in
                                    {601}let client_hts_1: bitstring = (if v_113 then catch-fail((if v_114 then hmac(tls_h,handshake_secret_1,x_34) else fail-any)) else caught-fail) in
                                    {602}let v_115: bool = not-caught-fail(client_hts_1) in
                                    {604}let h_32: bitstring = (if v_115 then catch-fail(hash(tls_h,cur_log2_5)) else caught-fail) in
                                    {605}let v_116: bool = not-caught-fail(h_32) in
                                    {603}let l_32: label = (if v_115 then tls13_server_handshake_traffic_secret else caught-fail) in
                                    {606}let x_35: bitstring = (if v_116 then (l_32,h_32) else caught-fail) in
                                    {607}let server_hts_1: bitstring = (if v_115 then catch-fail((if v_116 then hmac(tls_h,handshake_secret_1,x_35) else fail-any)) else caught-fail) in
                                    {608}let v_117: bool = not-caught-fail(server_hts_1) in
                                    {610}let h_33: bitstring = (if v_117 then zero else caught-fail) in
                                    {609}let l_33: label = (if v_117 then tls13_key else caught-fail) in
                                    {611}let x_36: bitstring = (if v_117 then (l_33,h_33) else caught-fail) in
                                    {612}let client_wkh_1: bitstring = (if v_117 then catch-fail(hmac(tls_h,client_hts_1,x_36)) else caught-fail) in
                                    {613}let v_118: bool = not-caught-fail(client_wkh_1) in
                                    {615}let h_34: bitstring = (if v_118 then zero else caught-fail) in
                                    {614}let l_34: label = (if v_118 then tls13_key else caught-fail) in
                                    {616}let x_37: bitstring = (if v_118 then (l_34,h_34) else caught-fail) in
                                    {617}let server_wkh_1: bitstring = (if v_118 then catch-fail(hmac(tls_h,server_hts_1,x_37)) else caught-fail) in
                                    {618}let v_119: bool = not-caught-fail(server_wkh_1) in
                                    {620}let h_35: bitstring = (if v_119 then zero else caught-fail) in
                                    {619}let l_35: label = (if v_119 then tls13_finished else caught-fail) in
                                    {621}let x_38: bitstring = (if v_119 then (l_35,h_35) else caught-fail) in
                                    {622}let client_fk_1: bitstring = (if v_119 then catch-fail(hmac(tls_h,client_hts_1,x_38)) else caught-fail) in
                                    {623}let v_120: bool = not-caught-fail(client_fk_1) in
                                    {625}let h_36: bitstring = (if v_120 then zero else caught-fail) in
                                    {624}let l_36: label = (if v_120 then tls13_finished else caught-fail) in
                                    {626}let x_39: bitstring = (if v_120 then (l_36,h_36) else caught-fail) in
                                    {627}let server_fk_1: bitstring = (if v_120 then catch-fail(hmac(tls_h,server_hts_1,x_39)) else caught-fail) in
                                    {628}let v_121: bool = not-caught-fail(server_fk_1) in
                                    {629}let (master_secret_10: bitstring,chk_8: aead_key,shk_8: aead_key,cfin_8: mac_key,sfin_8: mac_key) = (if v_112 then (if v_113 then (if v_115 then (if v_117 then (if v_118 then (if v_119 then (if v_120 then (if v_121 then (master_secret_9,client_wkh_1,server_wkh_1,client_fk_1,server_fk_1) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
                                    {630}in(io, enc_ee_msg: bitstring);
                                    {631}let ee_msg_1: msg = aead_dec(tls_a,shk_8,zero,zero,enc_ee_msg) in
                                    {632}let EE(x_40: bitstring) = ee_msg_1 in
                                    {633}let cur_log2_6: bitstring = (cur_log2_5,ee_msg_1) in
                                    {634}out(ch_client_after_EE, (id_client_5,cr',sr_9,tls_h,tls_a,c_dom_5,s_dom_6,psk_19,master_secret_10,chk_8,shk_8,cfin_8,sfin_8,cur_log2_6))
                                )
                                else
                                    {635}out(io, illegal_parameter)
                            )
                            else
                                {636}out(io, illegal_parameter)
                    )
                    else
                        {637}out(io, unexpected_message)
                )
                else
                    {639}out(io, illegal_parameter)
            )
            else
                {640}if send_kex then
                (
                    {642}let SH(sr_10: bytes32,mode_2: params) = server_hello_1 in
                    {643}let (x_41: bitstring,g_2: group,=true) = kex_data_1 in
                    {644}let nego(=TLS13,=tls_h,=tls_a,server_kex_ext(DHE_kex(=g_2,gy_2: element)),=empty_sni_ext,=empty_ech_ext,psk_ext_5: preSharedKeyExt,extra_6: extraExt) = mode_2 in
                    (
                        {646}let v_122: bool = (psk_ext_5 = empty_psk_ext) in
                        {647}let psk_20: preSharedKey = (if v_122 then NoPSK else caught-fail) in
                        {649}let k_10: bitstring = (if v_122 then catch-fail(psk2b(psk_20)) else caught-fail) in
                        {650}let v_123: bool = not-caught-fail(k_10) in
                        {648}let s_15: bitstring = (if v_122 then zero else caught-fail) in
                        {651}let early_secret_11: bitstring = (if v_122 then catch-fail((if v_123 then hmac(tls_h,s_15,k_10) else fail-any)) else caught-fail) in
                        {652}let v_124: bool = not-caught-fail(early_secret_11) in
                        {654}let m_12: bitstring = (if v_124 then zero else caught-fail) in
                        {655}let h_37: bitstring = (if v_124 then catch-fail(hash(tls_h,m_12)) else caught-fail) in
                        {656}let v_125: bool = not-caught-fail(h_37) in
                        {653}let l_37: label = (if v_124 then tls13_resumption_psk_binder_key else caught-fail) in
                        {657}let x_42: bitstring = (if v_125 then (l_37,h_37) else caught-fail) in
                        {658}let binder_key_8: bitstring = (if v_124 then catch-fail((if v_125 then hmac(tls_h,early_secret_11,x_42) else fail-any)) else caught-fail) in
                        {659}let v_126: bool = not-caught-fail(binder_key_8) in
                        {660}let v_127: bitstring = (if v_122 then catch-fail((if v_124 then (if v_126 then (early_secret_11,binder_key_8) else fail-any) else fail-any)) else caught-fail) in
                        {661}let v_128: bool = (not-caught-fail(v_127) && success?(1-proj-2-tuple(v_127))) in
                        {662}let kb_8: mac_key = (if v_128 then 2-proj-2-tuple(v_127) else caught-fail) in
                        {663}let es_9: bitstring = (if v_128 then 1-proj-2-tuple(v_127) else caught-fail) in
                        {664}let v_129: bitstring = (if not(v_122) then catch-fail(psk_data_1) else caught-fail) in
                        {665}let v_130: bool = (not-caught-fail(v_129) && success?(1-proj-3-tuple(v_129))) in
                        {666}let es_10: bitstring = (if v_130 then 3-proj-3-tuple(v_129) else caught-fail) in
                        {667}let psk_21: preSharedKey = (if v_130 then 2-proj-3-tuple(v_129) else caught-fail) in
                        {668}let h'_alg_1: hash_alg = (if v_130 then 1-proj-3-tuple(v_129) else caught-fail) in
                        {669}let (psk_22: preSharedKey,early_secret_12: bitstring,valid_1: bool) = (if v_122 then (if v_128 then (NoPSK,es_9,true) else fail-any) else (if v_130 then (psk_21,es_10,((h'_alg_1 = tls_h) && ((server_psk_ext(1) = psk_ext_5) && use_psk_1))) else fail-any)) in
                        {670}if valid_1 then
                        (
                            {673}new s_16[]: seed;
                            {676}let m_13: bitstring = catch-fail(hash(tls_h,zero)) in
                            {677}let v_132: bool = not-caught-fail(m_13) in
                            {678}let h_38: bitstring = (if v_132 then catch-fail(hash(tls_h,m_13)) else caught-fail) in
                            {679}let v_133: bool = not-caught-fail(h_38) in
                            {675}let l_38: label = tls13_derived in
                            {680}let x_43: bitstring = (if v_133 then (l_38,h_38) else caught-fail) in
                            {681}let extra_7: bitstring = catch-fail((if v_132 then (if v_133 then hmac(tls_h,early_secret_12,x_43) else fail-any) else fail-any)) in
                            {682}let v_134: bool = not-caught-fail(extra_7) in
                            {671}let gxy_3: element = catch-fail(dh_decap_fun(g_2,gy_2,x_41)) in
                            {672}let v_131: bool = not-caught-fail(gxy_3) in
                            {674}let gxy_4: element = (if v_131 then gxy_3 else dh_f(s_16)) in
                            {683}let handshake_secret_2: bitstring = (if v_134 then hmac(tls_h,extra_7,gxy_4) else fail-any) in
                            {645}let cur_log2_7: bitstring = (cur_log2_4,server_hello_1) in
                            {641}let id_client_6: idProc = id_client_4 in
                            {684}event SanityClientSH(id_client_6,cr_10,sr_10,c_dom_5,s_dom_6,handshake_secret_2,psk_22,cur_log2_7);
                            {686}let m_14: bitstring = catch-fail(hash(tls_h,zero)) in
                            {687}let v_135: bool = not-caught-fail(m_14) in
                            {688}let h_39: bitstring = (if v_135 then catch-fail(hash(tls_h,m_14)) else caught-fail) in
                            {689}let v_136: bool = not-caught-fail(h_39) in
                            {685}let l_39: label = tls13_derived in
                            {690}let x_44: bitstring = (if v_136 then (l_39,h_39) else caught-fail) in
                            {691}let extra_8: bitstring = catch-fail((if v_135 then (if v_136 then hmac(tls_h,handshake_secret_2,x_44) else fail-any) else fail-any)) in
                            {692}let v_137: bool = not-caught-fail(extra_8) in
                            {693}let k_11: bitstring = (if v_137 then zero else caught-fail) in
                            {694}let master_secret_11: bitstring = (if v_137 then catch-fail(hmac(tls_h,handshake_secret_2,k_11)) else caught-fail) in
                            {695}let v_138: bool = not-caught-fail(master_secret_11) in
                            {697}let h_40: bitstring = (if v_138 then catch-fail(hash(tls_h,cur_log2_7)) else caught-fail) in
                            {698}let v_139: bool = not-caught-fail(h_40) in
                            {696}let l_40: label = (if v_138 then tls13_client_handshake_traffic_secret else caught-fail) in
                            {699}let x_45: bitstring = (if v_139 then (l_40,h_40) else caught-fail) in
                            {700}let client_hts_2: bitstring = (if v_138 then catch-fail((if v_139 then hmac(tls_h,handshake_secret_2,x_45) else fail-any)) else caught-fail) in
                            {701}let v_140: bool = not-caught-fail(client_hts_2) in
                            {703}let h_41: bitstring = (if v_140 then catch-fail(hash(tls_h,cur_log2_7)) else caught-fail) in
                            {704}let v_141: bool = not-caught-fail(h_41) in
                            {702}let l_41: label = (if v_140 then tls13_server_handshake_traffic_secret else caught-fail) in
                            {705}let x_46: bitstring = (if v_141 then (l_41,h_41) else caught-fail) in
                            {706}let server_hts_2: bitstring = (if v_140 then catch-fail((if v_141 then hmac(tls_h,handshake_secret_2,x_46) else fail-any)) else caught-fail) in
                            {707}let v_142: bool = not-caught-fail(server_hts_2) in
                            {709}let h_42: bitstring = (if v_142 then zero else caught-fail) in
                            {708}let l_42: label = (if v_142 then tls13_key else caught-fail) in
                            {710}let x_47: bitstring = (if v_142 then (l_42,h_42) else caught-fail) in
                            {711}let client_wkh_2: bitstring = (if v_142 then catch-fail(hmac(tls_h,client_hts_2,x_47)) else caught-fail) in
                            {712}let v_143: bool = not-caught-fail(client_wkh_2) in
                            {714}let h_43: bitstring = (if v_143 then zero else caught-fail) in
                            {713}let l_43: label = (if v_143 then tls13_key else caught-fail) in
                            {715}let x_48: bitstring = (if v_143 then (l_43,h_43) else caught-fail) in
                            {716}let server_wkh_2: bitstring = (if v_143 then catch-fail(hmac(tls_h,server_hts_2,x_48)) else caught-fail) in
                            {717}let v_144: bool = not-caught-fail(server_wkh_2) in
                            {719}let h_44: bitstring = (if v_144 then zero else caught-fail) in
                            {718}let l_44: label = (if v_144 then tls13_finished else caught-fail) in
                            {720}let x_49: bitstring = (if v_144 then (l_44,h_44) else caught-fail) in
                            {721}let client_fk_2: bitstring = (if v_144 then catch-fail(hmac(tls_h,client_hts_2,x_49)) else caught-fail) in
                            {722}let v_145: bool = not-caught-fail(client_fk_2) in
                            {724}let h_45: bitstring = (if v_145 then zero else caught-fail) in
                            {723}let l_45: label = (if v_145 then tls13_finished else caught-fail) in
                            {725}let x_50: bitstring = (if v_145 then (l_45,h_45) else caught-fail) in
                            {726}let server_fk_2: bitstring = (if v_145 then catch-fail(hmac(tls_h,server_hts_2,x_50)) else caught-fail) in
                            {727}let v_146: bool = not-caught-fail(server_fk_2) in
                            {728}let (master_secret_12: bitstring,chk_9: aead_key,shk_9: aead_key,cfin_9: mac_key,sfin_9: mac_key) = (if v_137 then (if v_138 then (if v_140 then (if v_142 then (if v_143 then (if v_144 then (if v_145 then (if v_146 then (master_secret_11,client_wkh_2,server_wkh_2,client_fk_2,server_fk_2) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
                            {729}in(io, enc_ee_msg_1: bitstring);
                            {730}let ee_msg_2: msg = aead_dec(tls_a,shk_9,zero,zero,enc_ee_msg_1) in
                            {731}let EE(x_51: bitstring) = ee_msg_2 in
                            {732}let cur_log2_8: bitstring = (cur_log2_7,ee_msg_2) in
                            {733}out(ch_client_after_EE, (id_client_6,cr_10,sr_10,tls_h,tls_a,c_dom_5,s_dom_6,psk_22,master_secret_12,chk_9,shk_9,cfin_9,sfin_9,cur_log2_8))
                        )
                        else
                            {734}out(io, illegal_parameter)
                    )
                    else
                        {735}out(io, illegal_parameter)
                )
                else
                    {736}out(io, illegal_parameter)
        )
        else
            {737}out(io, unexpected_message)
    ) | (
        {739}!
        {743}in(io, (c_dom_6: domain,cfs_dom: domain,backend_dom: domain));
        {742}let send_kex_2: bool = true in
        {741}let use_psk_2: bool = false in
        {740}let use_grease: bool = false in
        {744}event Same((use_grease,use_psk_2,send_kex_2,c_dom_6,cfs_dom,backend_dom));
        {1092}get ech_configurations(ech_config(id_6: configId,g_3: group,pkR_1: element,=cfs_dom,h_alg_9: hash_alg,a_alg_9: aead_alg),skR_1: bitstring) in
        {748}new id_client_7[]: idProc;
        {749}event SanityClient(id_client_7,true,use_grease,use_psk_2,send_kex_2);
        {750}if not((use_grease && use_psk_2)) then
        {752}new s_17[]: seed;
        {753}let gx_6: element = dh_pub(tls_g,dh_k(s_17)) in
        {754}let v_147: bitstring = (dh_k(s_17),gx_6) in
        {755}let v_148: bool = success?(1-proj-2-tuple(v_147)) in
        {756}let i_gx: element = (if v_148 then 2-proj-2-tuple(v_147) else caught-fail) in
        {757}let i_x: bitstring = (if v_148 then 1-proj-2-tuple(v_147) else caught-fail) in
        {758}new s_18[]: seed;
        {759}let gx_7: element = (if v_148 then dh_pub(tls_g,dh_k(s_18)) else caught-fail) in
        {760}let v_149: bitstring = (if v_148 then catch-fail((dh_k(s_18),gx_7)) else caught-fail) in
        {761}let v_150: bool = (not-caught-fail(v_149) && success?(1-proj-2-tuple(v_149))) in
        {762}let o_gx: element = (if v_150 then 2-proj-2-tuple(v_149) else caught-fail) in
        {763}let o_x: bitstring = (if v_150 then 1-proj-2-tuple(v_149) else caught-fail) in
        {764}let v_151: bitstring = (if v_150 then catch-fail((if send_kex_2 then (DHE_kex(tls_g,i_gx),DHE_kex(tls_g,o_gx)) else (DHE_group(tls_g),DHE_group(tls_g)))) else caught-fail) in
        {765}let v_152: bool = (not-caught-fail(v_151) && success?(1-proj-2-tuple(v_151))) in
        {766}let o_kex: kex_alg = (if v_152 then 2-proj-2-tuple(v_151) else caught-fail) in
        {767}let i_kex: kex_alg = (if v_152 then 1-proj-2-tuple(v_151) else caught-fail) in
        {768}let (i_kex_ext: keyShareExt,o_kex_ext: keyShareExt,kex_data_3: bitstring) = (if v_148 then (if v_150 then (if v_152 then (client_kex_ext(i_kex),client_kex_ext(o_kex),(i_x,o_x,tls_g,send_kex_2)) else fail-any) else fail-any) else fail-any) in
        {769}new rand24_3[]: bytes24;
        {770}new rand8_3[]: bytes8;
        {1091}get pre_shared_keys(c_dom'_3: domain,s_dom'_3: domain,=tls_h,id_7: identityPsk,internal_psk_2: internal_preSharedKey) in
        {773}event Selected_psk(c_dom_6,c_dom'_3,backend_dom,s_dom'_3,id_7,internal_psk_2);
        {774}let v_153: bool = use_psk_2 in
        {775}let psk_23: preSharedKey = (if v_153 then PSK(internal_psk_2) else caught-fail) in
        {779}let k_12: bitstring = (if v_153 then catch-fail(psk2b(psk_23)) else caught-fail) in
        {780}let v_154: bool = not-caught-fail(k_12) in
        {778}let s_19: bitstring = (if v_153 then zero else caught-fail) in
        {781}let early_secret_13: bitstring = (if v_153 then catch-fail((if v_154 then hmac(tls_h,s_19,k_12) else fail-any)) else caught-fail) in
        {782}let v_155: bool = not-caught-fail(early_secret_13) in
        {784}let m_15: bitstring = (if v_155 then zero else caught-fail) in
        {785}let h_46: bitstring = (if v_155 then catch-fail(hash(tls_h,m_15)) else caught-fail) in
        {786}let v_156: bool = not-caught-fail(h_46) in
        {783}let l_46: label = (if v_155 then tls13_resumption_psk_binder_key else caught-fail) in
        {787}let x_52: bitstring = (if v_156 then (l_46,h_46) else caught-fail) in
        {788}let binder_key_9: bitstring = (if v_155 then catch-fail((if v_156 then hmac(tls_h,early_secret_13,x_52) else fail-any)) else caught-fail) in
        {789}let v_157: bool = not-caught-fail(binder_key_9) in
        {790}let v_158: bitstring = (if v_153 then catch-fail((if v_155 then (if v_157 then (early_secret_13,binder_key_9) else fail-any) else fail-any)) else caught-fail) in
        {791}let v_159: bool = (not-caught-fail(v_158) && success?(1-proj-2-tuple(v_158))) in
        {792}let kb_9: mac_key = (if v_159 then 2-proj-2-tuple(v_158) else caught-fail) in
        {793}let es_11: bitstring = (if v_159 then 1-proj-2-tuple(v_158) else caught-fail) in
        {796}let psk_24: preSharedKey = (if not(v_153) then NoPSK else caught-fail) in
        {798}let k_13: bitstring = (if not(v_153) then catch-fail(psk2b(psk_24)) else caught-fail) in
        {799}let v_161: bool = not-caught-fail(k_13) in
        {797}let s_20: bitstring = (if not(v_153) then zero else caught-fail) in
        {800}let early_secret_14: bitstring = (if not(v_153) then catch-fail((if v_161 then hmac(tls_h,s_20,k_13) else fail-any)) else caught-fail) in
        {801}let v_162: bool = not-caught-fail(early_secret_14) in
        {803}let m_16: bitstring = (if v_162 then zero else caught-fail) in
        {804}let h_47: bitstring = (if v_162 then catch-fail(hash(tls_h,m_16)) else caught-fail) in
        {805}let v_163: bool = not-caught-fail(h_47) in
        {802}let l_47: label = (if v_162 then tls13_resumption_psk_binder_key else caught-fail) in
        {806}let x_53: bitstring = (if v_163 then (l_47,h_47) else caught-fail) in
        {807}let binder_key_10: bitstring = (if v_162 then catch-fail((if v_163 then hmac(tls_h,early_secret_14,x_53) else fail-any)) else caught-fail) in
        {808}let v_164: bool = not-caught-fail(binder_key_10) in
        {809}let v_165: bitstring = (if not(v_153) then catch-fail((if v_162 then (if v_164 then (early_secret_14,binder_key_10) else fail-any) else fail-any)) else caught-fail) in
        {810}let v_166: bool = (not-caught-fail(v_165) && success?(1-proj-2-tuple(v_165))) in
        {811}let kb_10: mac_key = (if v_166 then 2-proj-2-tuple(v_165) else caught-fail) in
        {812}let es_12: bitstring = (if v_166 then 1-proj-2-tuple(v_165) else caught-fail) in
        {772}let ech_ext_4: echExt = ech_is_inner in
        {746}let i_extra: extraExt = empty_extra_ext in
        {776}let offer_6: params = (if v_153 then nego(TLS13,tls_h,tls_a,i_kex_ext,SNI(backend_dom),ech_ext_4,trunc_client_psk_ext(id_7),i_extra) else caught-fail) in
        {771}let i_cr: bytes32 = B32(rand24_3,rand8_3) in
        {751}let i_cur_log: bitstring = zero in
        {777}let cur_log'_4: bitstring = (if v_153 then (i_cur_log,CH(i_cr,offer_6)) else caught-fail) in
        {794}let binders_3: bitstring = (if v_159 then catch-fail(hmac(tls_h,kb_9,cur_log'_4)) else caught-fail) in
        {795}let v_160: bool = not-caught-fail(binders_3) in
        {813}let v_167: bitstring = catch-fail((if v_153 then (if v_159 then (if v_160 then (client_psk_ext(id_7,binders_3),(tls_h,psk_23,es_11)) else fail-any) else fail-any) else (if v_166 then (empty_psk_ext,(tls_h,NoPSK,es_12)) else fail-any))) in
        {814}let v_168: bool = (not-caught-fail(v_167) && success?(1-proj-2-tuple(v_167))) in
        {815}let psk_data_3: bitstring = (if v_168 then 2-proj-2-tuple(v_167) else caught-fail) in
        {816}let psk_ext_6: preSharedKeyExt = (if v_168 then 1-proj-2-tuple(v_167) else caught-fail) in
        {745}let ech_conf: echConfig = ech_config(id_6,g_3,pkR_1,cfs_dom,h_alg_9,a_alg_9) in
        {819}let v_169: echConfig = (if v_168 then catch-fail(ech_conf) else caught-fail) in
        {820}let v_170: bool = (not-caught-fail(v_169) && success?(1-proj-ech_config(v_169))) in
        {821}let a_alg_ech: aead_alg = (if v_170 then 6-proj-ech_config(v_169) else caught-fail) in
        {822}let h_alg_ech: hash_alg = (if v_170 then 5-proj-ech_config(v_169) else caught-fail) in
        {823}let o_dom_1: domain = (if v_170 then 4-proj-ech_config(v_169) else caught-fail) in
        {824}let pkR_2: element = (if v_170 then 3-proj-ech_config(v_169) else caught-fail) in
        {825}let g_ech: group = (if v_170 then 2-proj-ech_config(v_169) else caught-fail) in
        {826}let config_id: configId = (if v_170 then 1-proj-ech_config(v_169) else caught-fail) in
        {828}new s_21[]: seed;
        {829}let v_171: bitstring = (if v_170 then catch-fail((dh_xy(s_21,pkR_2),dh_encap_fun(g_ech,pkR_2,dh_xy(s_21,pkR_2)))) else caught-fail) in
        {830}let v_172: bool = (not-caught-fail(v_171) && success?(1-proj-2-tuple(v_171))) in
        {831}let enc: element = (if v_172 then 2-proj-2-tuple(v_171) else caught-fail) in
        {832}let shared_secret: element = (if v_172 then 1-proj-2-tuple(v_171) else caught-fail) in
        {827}let info: bitstring = (if v_170 then (tls_ech_str,ech_conf) else caught-fail) in
        {835}let k_14: bitstring = (if v_172 then (hpke_info_hash,info) else caught-fail) in
        {834}let s_22: bitstring = (if v_172 then zero else caught-fail) in
        {836}let info_hash: bitstring = (if v_172 then catch-fail(hmac(h_alg_ech,s_22,k_14)) else caught-fail) in
        {837}let v_173: bool = not-caught-fail(info_hash) in
        {838}let k_15: bitstring = (if v_173 then (hpke_secret,zero) else caught-fail) in
        {839}let xsecret: bitstring = (if v_173 then catch-fail(hmac(h_alg_ech,shared_secret,k_15)) else caught-fail) in
        {840}let v_174: bool = not-caught-fail(xsecret) in
        {841}let l_48: label = (if v_174 then hpke_key else caught-fail) in
        {842}let x_54: bitstring = (if v_174 then (l_48,info_hash) else caught-fail) in
        {843}let key: aead_key = (if v_174 then catch-fail(hmac(h_alg_ech,xsecret,x_54)) else caught-fail) in
        {844}let v_175: bool = not-caught-fail(key) in
        {845}let l_49: label = (if v_175 then hpke_base_nonce else caught-fail) in
        {846}let x_55: bitstring = (if v_175 then (l_49,info_hash) else caught-fail) in
        {847}let base_nonce: bitstring = (if v_175 then catch-fail(hmac(h_alg_ech,xsecret,x_55)) else caught-fail) in
        {848}let v_176: bool = not-caught-fail(base_nonce) in
        {849}let l_50: label = (if v_176 then hpke_exp else caught-fail) in
        {850}let x_56: bitstring = (if v_176 then (l_50,info_hash) else caught-fail) in
        {851}let exporter_secret: bitstring = (if v_176 then catch-fail(hmac(h_alg_ech,xsecret,x_56)) else caught-fail) in
        {852}let v_177: bool = not-caught-fail(exporter_secret) in
        {833}let m_17: hpkeMode = (if v_172 then S else caught-fail) in
        {853}let v_178: bitstring = (if v_170 then catch-fail((if v_172 then (enc,(if v_173 then (if v_174 then (if v_175 then (if v_176 then (if v_177 then hpke_context(m_17,key) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) else fail-any)) else caught-fail) in
        {854}let v_179: bool = (not-caught-fail(v_178) && success?(1-proj-2-tuple(v_178))) in
        {855}let context: hpkeContext = (if v_179 then 2-proj-2-tuple(v_178) else caught-fail) in
        {856}let enc_1: element = (if v_179 then 1-proj-2-tuple(v_178) else caught-fail) in
        {857}new rand24_4[]: bytes24;
        {858}new rand8_4[]: bytes8;
        {861}new payload[]: bitstring;
        {860}let v_180: bool = (if v_179 then catch-fail(use_grease) else caught-fail) in
        {864}let dummy_ech_ext: echExt = (if is-false(v_180) then client_ECH(h_alg_ech,a_alg_ech,config_id,enc_1,zero) else caught-fail) in
        {747}let o_extra: extraExt = empty_extra_ext in
        {865}let o_offer1: params = (if is-false(v_180) then nego(TLS13,tls_h,tls_a,o_kex_ext,SNI(o_dom_1),dummy_ech_ext,empty_psk_ext,o_extra) else caught-fail) in
        {859}let o_cr: bytes32 = (if v_179 then B32(rand24_4,rand8_4) else caught-fail) in
        {866}let o_client_hello1: msg = (if is-false(v_180) then CH(o_cr,o_offer1) else caught-fail) in
        {867}let v_181: msg = (if is-false(v_180) then catch-fail(o_client_hello1) else caught-fail) in
        {868}let v_182: bool = (not-caught-fail(v_181) && (success?(1-proj-nego(2-proj-CH(v_181))) && success?(1-proj-CH(v_181)))) in
        {869}let extra_9: extraExt = (if v_182 then 8-proj-nego(2-proj-CH(v_181)) else caught-fail) in
        {870}let psk_ext_7: preSharedKeyExt = (if v_182 then 7-proj-nego(2-proj-CH(v_181)) else caught-fail) in
        {871}let ech_ext_6: echExt = (if v_182 then 6-proj-nego(2-proj-CH(v_181)) else caught-fail) in
        {872}let sni_ext_2: sniExt = (if v_182 then 5-proj-nego(2-proj-CH(v_181)) else caught-fail) in
        {873}let kex_ext_4: keyShareExt = (if v_182 then 4-proj-nego(2-proj-CH(v_181)) else caught-fail) in
        {874}let a_alg_10: aead_alg = (if v_182 then 3-proj-nego(2-proj-CH(v_181)) else caught-fail) in
        {875}let h_alg_10: hash_alg = (if v_182 then 2-proj-nego(2-proj-CH(v_181)) else caught-fail) in
        {876}let version: TLS_version = (if v_182 then 1-proj-nego(2-proj-CH(v_181)) else caught-fail) in
        {877}let r: bytes32 = (if v_182 then 1-proj-CH(v_181) else caught-fail) in
        {878}let v_183: echExt = (if v_182 then catch-fail(ech_ext_6) else caught-fail) in
        {879}let v_184: bool = (not-caught-fail(v_183) && success?(1-proj-client_ECH(v_183))) in
        {880}let payload_1: bitstring = (if v_184 then 5-proj-client_ECH(v_183) else caught-fail) in
        {881}let enc_2: element = (if v_184 then 4-proj-client_ECH(v_183) else caught-fail) in
        {882}let config_id_1: configId = (if v_184 then 3-proj-client_ECH(v_183) else caught-fail) in
        {883}let a_alg_ech_1: aead_alg = (if v_184 then 2-proj-client_ECH(v_183) else caught-fail) in
        {884}let h_alg_ech_1: hash_alg = (if v_184 then 1-proj-client_ECH(v_183) else caught-fail) in
        {885}let client_hello_outer': msg = (if v_184 then CH(r,nego(version,h_alg_10,a_alg_10,kex_ext_4,sni_ext_2,empty_ech_ext,psk_ext_7,extra_9)) else caught-fail) in
        {886}let client_hello_AAD: ClientHelloOuterAAD = (if is-false(v_180) then catch-fail((if v_182 then (if v_184 then client_hello_outer_AAD(h_alg_ech_1,a_alg_ech_1,config_id_1,enc_2,client_hello_outer') else fail-any) else fail-any)) else caught-fail) in
        {887}let v_185: bool = not-caught-fail(client_hello_AAD) in
        {888}let v_186: hpkeContext = (if v_185 then catch-fail(context) else caught-fail) in
        {889}let v_187: bool = (not-caught-fail(v_186) && ((S =nf 1-proj-hpke_context(v_186)) && success?(1-proj-hpke_context(v_186)))) in
        {890}let key_1: aead_key = (if v_187 then 2-proj-hpke_context(v_186) else caught-fail) in
        {817}let i_offer: params = (if v_168 then nego(TLS13,tls_h,tls_a,i_kex_ext,SNI(backend_dom),ech_is_inner,psk_ext_6,i_extra) else caught-fail) in
        {818}let i_client_hello: msg = (if v_168 then CH(i_cr,i_offer) else caught-fail) in
        {891}let payload_2: bitstring = (if v_185 then catch-fail((if v_187 then aead_enc(a_alg_ech,key_1,nonce_for_seal_open,client_hello_AAD,i_client_hello) else fail-any)) else caught-fail) in
        {892}let v_188: bool = not-caught-fail(payload_2) in
        {893}let ech_ext_7: echExt = (if v_188 then client_ECH(h_alg_ech,a_alg_ech,config_id,enc_1,payload_2) else caught-fail) in
        {894}let o_offer_1: params = (if v_188 then nego(TLS13,tls_h,tls_a,o_kex_ext,SNI(o_dom_1),ech_ext_7,empty_psk_ext,o_extra) else caught-fail) in
        {862}let ech_ext_5: echExt = (if v_180 then client_ECH(h_alg_ech,a_alg_ech,config_id,enc_1,payload) else caught-fail) in
        {863}let o_offer: params = (if v_180 then nego(TLS13,tls_h,tls_a,o_kex_ext,SNI(o_dom_1),ech_ext_5,empty_psk_ext,o_extra) else caught-fail) in
        {895}let (o_client_hello: msg,i_client_hello_1: msg,i_cr_1: bytes32,o_cr_1: bytes32,i_kex_ext_1: keyShareExt,o_kex_ext_1: keyShareExt,kex_data_4: bitstring,psk_data_4: bitstring) = (if v_168 then (if v_170 then (if v_179 then (if undo-catch-fail(v_180) then (CH(o_cr,o_offer),CH(o_cr,o_offer),o_cr,o_cr,o_kex_ext,o_kex_ext,kex_data_3,psk_data_3) else (if v_185 then (if v_188 then (CH(o_cr,o_offer_1),i_client_hello,i_cr,o_cr,i_kex_ext,o_kex_ext,kex_data_3,psk_data_3) else fail-any) else fail-any)) else fail-any) else fail-any) else fail-any) in
        {896}out(io, o_client_hello);
        {897}let (=tls_h,psk_25: preSharedKey,es_13: bitstring) = psk_data_4 in
        {898}let v_189: echConfig = ech_conf in
        {899}let v_190: bool = success?(1-proj-ech_config(v_189)) in
        {900}let al: aead_alg = (if v_190 then 6-proj-ech_config(v_189) else caught-fail) in
        {901}let hl: hash_alg = (if v_190 then 5-proj-ech_config(v_189) else caught-fail) in
        {902}let dom: domain = (if v_190 then 4-proj-ech_config(v_189) else caught-fail) in
        {903}let public_key: element = (if v_190 then 3-proj-ech_config(v_189) else caught-fail) in
        {904}let g_4: group = (if v_190 then 2-proj-ech_config(v_189) else caught-fail) in
        {905}let id_8: configId = (if v_190 then 1-proj-ech_config(v_189) else caught-fail) in
        {906}let o_dom_2: domain = (if v_190 then dom else fail-any) in
        {907}let v_191: echConfig = ech_conf in
        {908}let v_192: bool = success?(1-proj-ech_config(v_191)) in
        {909}let al_1: aead_alg = (if v_192 then 6-proj-ech_config(v_191) else caught-fail) in
        {910}let hl_1: hash_alg = (if v_192 then 5-proj-ech_config(v_191) else caught-fail) in
        {911}let dom_1: domain = (if v_192 then 4-proj-ech_config(v_191) else caught-fail) in
        {912}let public_key_1: element = (if v_192 then 3-proj-ech_config(v_191) else caught-fail) in
        {913}let g_5: group = (if v_192 then 2-proj-ech_config(v_191) else caught-fail) in
        {914}let id_9: configId = (if v_192 then 1-proj-ech_config(v_191) else caught-fail) in
        {915}let ech_pk: element = (if v_192 then public_key_1 else fail-any) in
        {916}event SanityClientCH_ECH(id_client_7,zero32,i_cr_1,o_cr_1,c_dom_6,o_dom_2,backend_dom,ech_pk,psk_25,(zero,o_client_hello),(zero,i_client_hello_1));
        {917}in(io, server_hello_2: msg);
        {918}let SH(sr_11: bytes32,mode_3: params) = server_hello_2 in
        (
            {919}if (sr_11 = rand_HelloRetryRequest) then
                {920}out(io, illegal_parameter)
            else
                {921}let v_193: echConfig = ech_conf in
                {922}let v_194: bool = success?(1-proj-ech_config(v_193)) in
                {923}let al_2: aead_alg = (if v_194 then 6-proj-ech_config(v_193) else caught-fail) in
                {924}let hl_2: hash_alg = (if v_194 then 5-proj-ech_config(v_193) else caught-fail) in
                {925}let dom_2: domain = (if v_194 then 4-proj-ech_config(v_193) else caught-fail) in
                {926}let public_key_2: element = (if v_194 then 3-proj-ech_config(v_193) else caught-fail) in
                {927}let g_6: group = (if v_194 then 2-proj-ech_config(v_193) else caught-fail) in
                {928}let id_10: configId = (if v_194 then 1-proj-ech_config(v_193) else caught-fail) in
                {930}let o_dom_3: domain = (if v_194 then dom_2 else fail-any) in
                {933}let SH(B32(sr24_1: bytes24,sr8_1: bytes8),mode_4: params) = server_hello_2 in
                {934}let (i_x_1: bitstring,o_x_1: bitstring,g_7: group,=true) = kex_data_4 in
                {935}let nego(=TLS13,=tls_h,=tls_a,server_kex_ext(DHE_kex(=g_7,gy_srv: element)),=empty_sni_ext,=empty_ech_ext,psk_ext_8: preSharedKeyExt,extra_10: extraExt) = mode_4 in
                (
                    {936}let v_195: bool = (psk_ext_8 = empty_psk_ext) in
                    {937}let psk_26: preSharedKey = (if v_195 then NoPSK else caught-fail) in
                    {939}let k_16: bitstring = (if v_195 then catch-fail(psk2b(psk_26)) else caught-fail) in
                    {940}let v_196: bool = not-caught-fail(k_16) in
                    {938}let s_23: bitstring = (if v_195 then zero else caught-fail) in
                    {941}let early_secret_15: bitstring = (if v_195 then catch-fail((if v_196 then hmac(tls_h,s_23,k_16) else fail-any)) else caught-fail) in
                    {942}let v_197: bool = not-caught-fail(early_secret_15) in
                    {944}let m_18: bitstring = (if v_197 then zero else caught-fail) in
                    {945}let h_48: bitstring = (if v_197 then catch-fail(hash(tls_h,m_18)) else caught-fail) in
                    {946}let v_198: bool = not-caught-fail(h_48) in
                    {943}let l_51: label = (if v_197 then tls13_resumption_psk_binder_key else caught-fail) in
                    {947}let x_57: bitstring = (if v_198 then (l_51,h_48) else caught-fail) in
                    {948}let binder_key_11: bitstring = (if v_197 then catch-fail((if v_198 then hmac(tls_h,early_secret_15,x_57) else fail-any)) else caught-fail) in
                    {949}let v_199: bool = not-caught-fail(binder_key_11) in
                    {950}let v_200: bitstring = (if v_195 then catch-fail((if v_197 then (if v_199 then (early_secret_15,binder_key_11) else fail-any) else fail-any)) else caught-fail) in
                    {951}let v_201: bool = (not-caught-fail(v_200) && success?(1-proj-2-tuple(v_200))) in
                    {952}let kb_11: mac_key = (if v_201 then 2-proj-2-tuple(v_200) else caught-fail) in
                    {953}let es_14: bitstring = (if v_201 then 1-proj-2-tuple(v_200) else caught-fail) in
                    {954}let v_202: bitstring = (if not(v_195) then catch-fail(psk_data_4) else caught-fail) in
                    {955}let v_203: bool = (not-caught-fail(v_202) && success?(1-proj-3-tuple(v_202))) in
                    {956}let es_15: bitstring = (if v_203 then 3-proj-3-tuple(v_202) else caught-fail) in
                    {957}let psk_27: preSharedKey = (if v_203 then 2-proj-3-tuple(v_202) else caught-fail) in
                    {958}let h'_alg_2: hash_alg = (if v_203 then 1-proj-3-tuple(v_202) else caught-fail) in
                    {959}let (psk_28: preSharedKey,early_secret_16: bitstring,valid_2: bool) = (if v_195 then (if v_201 then (NoPSK,es_14,true) else fail-any) else (if v_203 then (psk_27,es_15,((h'_alg_2 = tls_h) && ((server_psk_ext(1) = psk_ext_8) && use_psk_2))) else fail-any)) in
                    {960}if valid_2 then
                    (
                        {964}new s_24[]: seed;
                        {961}let v_204: bool = use_grease in
                        {967}let m_19: bitstring = (if not(v_204) then catch-fail(hash(tls_h,zero)) else caught-fail) in
                        {968}let v_206: bool = not-caught-fail(m_19) in
                        {969}let h_49: bitstring = (if v_206 then catch-fail(hash(tls_h,m_19)) else caught-fail) in
                        {970}let v_207: bool = not-caught-fail(h_49) in
                        {966}let l_52: label = (if not(v_204) then tls13_derived else caught-fail) in
                        {971}let x_58: bitstring = (if v_207 then (l_52,h_49) else caught-fail) in
                        {972}let extra_11: bitstring = (if not(v_204) then catch-fail((if v_206 then (if v_207 then hmac(tls_h,early_secret_16,x_58) else fail-any) else fail-any)) else caught-fail) in
                        {973}let v_208: bool = not-caught-fail(extra_11) in
                        {962}let gxy_5: element = (if not(v_204) then catch-fail(dh_decap_fun(g_7,gy_srv,i_x_1)) else caught-fail) in
                        {963}let v_205: bool = not-caught-fail(gxy_5) in
                        {965}let i_gxy: element = (if not(v_204) then (if v_205 then gxy_5 else dh_f(s_24)) else caught-fail) in
                        {974}let i_handshake_secret: bitstring = (if not(v_204) then catch-fail((if v_208 then hmac(tls_h,extra_11,i_gxy) else fail-any)) else caught-fail) in
                        {975}let v_209: bool = not-caught-fail(i_handshake_secret) in
                        {976}let SH_ECHConf_1: msg = (if v_209 then SH(B32(sr24_1,zero8),mode_4) else caught-fail) in
                        {931}let i_cur_log_1: bitstring = (zero,i_client_hello_1) in
                        {978}let m_20: bitstring = (if v_209 then (i_cur_log_1,SH_ECHConf_1) else caught-fail) in
                        {979}let h_50: bitstring = (if v_209 then catch-fail(hash(tls_h,m_20)) else caught-fail) in
                        {980}let v_210: bool = not-caught-fail(h_50) in
                        {977}let l_53: label = (if v_209 then ech_accept_confirmation else caught-fail) in
                        {981}let x_59: bitstring = (if v_210 then (l_53,h_50) else caught-fail) in
                        {982}let accept_confirmation_1: bitstring = (if v_209 then catch-fail((if v_210 then hmac(tls_h,i_handshake_secret,x_59) else fail-any)) else caught-fail) in
                        {983}let v_211: bool = not-caught-fail(accept_confirmation_1) in
                        {984}let is_accepted: bool = (if v_204 then false else (if v_209 then (if v_211 then (sr8_1 = crop_into_bytes8(accept_confirmation_1)) else fail-any) else fail-any)) in
                        {988}new s_25[]: seed;
                        {1002}new s_26[]: seed;
                        {985}let v_212: bool = is_accepted in
                        {1004}let psk_29: preSharedKey = (if not(v_212) then NoPSK else caught-fail) in
                        {1006}let k_17: bitstring = (if not(v_212) then catch-fail(psk2b(psk_29)) else caught-fail) in
                        {1007}let v_219: bool = not-caught-fail(k_17) in
                        {1005}let s_27: bitstring = (if not(v_212) then zero else caught-fail) in
                        {1008}let early_secret_17: bitstring = (if not(v_212) then catch-fail((if v_219 then hmac(tls_h,s_27,k_17) else fail-any)) else caught-fail) in
                        {1009}let v_220: bool = not-caught-fail(early_secret_17) in
                        {1011}let m_22: bitstring = (if v_220 then zero else caught-fail) in
                        {1012}let h_52: bitstring = (if v_220 then catch-fail(hash(tls_h,m_22)) else caught-fail) in
                        {1013}let v_221: bool = not-caught-fail(h_52) in
                        {1010}let l_55: label = (if v_220 then tls13_resumption_psk_binder_key else caught-fail) in
                        {1014}let x_61: bitstring = (if v_221 then (l_55,h_52) else caught-fail) in
                        {1015}let binder_key_12: bitstring = (if v_220 then catch-fail((if v_221 then hmac(tls_h,early_secret_17,x_61) else fail-any)) else caught-fail) in
                        {1016}let v_222: bool = not-caught-fail(binder_key_12) in
                        {1017}let v_223: bitstring = (if not(v_212) then catch-fail((if v_220 then (if v_222 then (early_secret_17,binder_key_12) else fail-any) else fail-any)) else caught-fail) in
                        {1018}let v_224: bool = (not-caught-fail(v_223) && success?(1-proj-2-tuple(v_223))) in
                        {1019}let kb_12: mac_key = (if v_224 then 2-proj-2-tuple(v_223) else caught-fail) in
                        {1020}let es_16: bitstring = (if v_224 then 1-proj-2-tuple(v_223) else caught-fail) in
                        {1022}let m_23: bitstring = (if v_224 then catch-fail(hash(tls_h,zero)) else caught-fail) in
                        {1023}let v_225: bool = not-caught-fail(m_23) in
                        {1024}let h_53: bitstring = (if v_225 then catch-fail(hash(tls_h,m_23)) else caught-fail) in
                        {1025}let v_226: bool = not-caught-fail(h_53) in
                        {1021}let l_56: label = (if v_224 then tls13_derived else caught-fail) in
                        {1026}let x_62: bitstring = (if v_226 then (l_56,h_53) else caught-fail) in
                        {1027}let extra_13: bitstring = (if v_224 then catch-fail((if v_225 then (if v_226 then hmac(tls_h,es_16,x_62) else fail-any) else fail-any)) else caught-fail) in
                        {1028}let v_227: bool = not-caught-fail(extra_13) in
                        {1000}let gxy_7: element = (if not(v_212) then catch-fail(dh_decap_fun(g_7,gy_srv,o_x_1)) else caught-fail) in
                        {1001}let v_218: bool = not-caught-fail(gxy_7) in
                        {1003}let o_gxy: element = (if not(v_212) then (if v_218 then gxy_7 else dh_f(s_26)) else caught-fail) in
                        {991}let m_21: bitstring = (if v_212 then catch-fail(hash(tls_h,zero)) else caught-fail) in
                        {992}let v_214: bool = not-caught-fail(m_21) in
                        {993}let h_51: bitstring = (if v_214 then catch-fail(hash(tls_h,m_21)) else caught-fail) in
                        {994}let v_215: bool = not-caught-fail(h_51) in
                        {990}let l_54: label = (if v_212 then tls13_derived else caught-fail) in
                        {995}let x_60: bitstring = (if v_215 then (l_54,h_51) else caught-fail) in
                        {996}let extra_12: bitstring = (if v_212 then catch-fail((if v_214 then (if v_215 then hmac(tls_h,early_secret_16,x_60) else fail-any) else fail-any)) else caught-fail) in
                        {997}let v_216: bool = not-caught-fail(extra_12) in
                        {986}let gxy_6: element = (if v_212 then catch-fail(dh_decap_fun(g_7,gy_srv,i_x_1)) else caught-fail) in
                        {987}let v_213: bool = not-caught-fail(gxy_6) in
                        {989}let i_gxy_1: element = (if v_212 then (if v_213 then gxy_6 else dh_f(s_25)) else caught-fail) in
                        {998}let i_handshake_secret_1: bitstring = (if v_212 then catch-fail((if v_216 then hmac(tls_h,extra_12,i_gxy_1) else fail-any)) else caught-fail) in
                        {999}let v_217: bool = not-caught-fail(i_handshake_secret_1) in
                        {932}let o_cur_log: bitstring = (zero,o_client_hello) in
                        {1029}let (cr_12: bytes32,handshake_secret_3: bitstring,s_dom_7: domain,cur_log_9: bitstring) = (if v_212 then (if v_217 then (i_cr_1,i_handshake_secret_1,backend_dom,(i_cur_log_1,server_hello_2)) else fail-any) else (if v_224 then (o_cr_1,(if v_227 then hmac(tls_h,extra_13,o_gxy) else fail-any),o_dom_3,(o_cur_log,server_hello_2)) else fail-any)) in
                        {1031}let m_24: bitstring = catch-fail(hash(tls_h,zero)) in
                        {1032}let v_228: bool = not-caught-fail(m_24) in
                        {1033}let h_54: bitstring = (if v_228 then catch-fail(hash(tls_h,m_24)) else caught-fail) in
                        {1034}let v_229: bool = not-caught-fail(h_54) in
                        {1030}let l_57: label = tls13_derived in
                        {1035}let x_63: bitstring = (if v_229 then (l_57,h_54) else caught-fail) in
                        {1036}let extra_14: bitstring = catch-fail((if v_228 then (if v_229 then hmac(tls_h,handshake_secret_3,x_63) else fail-any) else fail-any)) in
                        {1037}let v_230: bool = not-caught-fail(extra_14) in
                        {1038}let k_18: bitstring = (if v_230 then zero else caught-fail) in
                        {1039}let master_secret_13: bitstring = (if v_230 then catch-fail(hmac(tls_h,handshake_secret_3,k_18)) else caught-fail) in
                        {1040}let v_231: bool = not-caught-fail(master_secret_13) in
                        {1042}let h_55: bitstring = (if v_231 then catch-fail(hash(tls_h,cur_log_9)) else caught-fail) in
                        {1043}let v_232: bool = not-caught-fail(h_55) in
                        {1041}let l_58: label = (if v_231 then tls13_client_handshake_traffic_secret else caught-fail) in
                        {1044}let x_64: bitstring = (if v_232 then (l_58,h_55) else caught-fail) in
                        {1045}let client_hts_3: bitstring = (if v_231 then catch-fail((if v_232 then hmac(tls_h,handshake_secret_3,x_64) else fail-any)) else caught-fail) in
                        {1046}let v_233: bool = not-caught-fail(client_hts_3) in
                        {1048}let h_56: bitstring = (if v_233 then catch-fail(hash(tls_h,cur_log_9)) else caught-fail) in
                        {1049}let v_234: bool = not-caught-fail(h_56) in
                        {1047}let l_59: label = (if v_233 then tls13_server_handshake_traffic_secret else caught-fail) in
                        {1050}let x_65: bitstring = (if v_234 then (l_59,h_56) else caught-fail) in
                        {1051}let server_hts_3: bitstring = (if v_233 then catch-fail((if v_234 then hmac(tls_h,handshake_secret_3,x_65) else fail-any)) else caught-fail) in
                        {1052}let v_235: bool = not-caught-fail(server_hts_3) in
                        {1054}let h_57: bitstring = (if v_235 then zero else caught-fail) in
                        {1053}let l_60: label = (if v_235 then tls13_key else caught-fail) in
                        {1055}let x_66: bitstring = (if v_235 then (l_60,h_57) else caught-fail) in
                        {1056}let client_wkh_3: bitstring = (if v_235 then catch-fail(hmac(tls_h,client_hts_3,x_66)) else caught-fail) in
                        {1057}let v_236: bool = not-caught-fail(client_wkh_3) in
                        {1059}let h_58: bitstring = (if v_236 then zero else caught-fail) in
                        {1058}let l_61: label = (if v_236 then tls13_key else caught-fail) in
                        {1060}let x_67: bitstring = (if v_236 then (l_61,h_58) else caught-fail) in
                        {1061}let server_wkh_3: bitstring = (if v_236 then catch-fail(hmac(tls_h,server_hts_3,x_67)) else caught-fail) in
                        {1062}let v_237: bool = not-caught-fail(server_wkh_3) in
                        {1064}let h_59: bitstring = (if v_237 then zero else caught-fail) in
                        {1063}let l_62: label = (if v_237 then tls13_finished else caught-fail) in
                        {1065}let x_68: bitstring = (if v_237 then (l_62,h_59) else caught-fail) in
                        {1066}let client_fk_3: bitstring = (if v_237 then catch-fail(hmac(tls_h,client_hts_3,x_68)) else caught-fail) in
                        {1067}let v_238: bool = not-caught-fail(client_fk_3) in
                        {1069}let h_60: bitstring = (if v_238 then zero else caught-fail) in
                        {1068}let l_63: label = (if v_238 then tls13_finished else caught-fail) in
                        {1070}let x_69: bitstring = (if v_238 then (l_63,h_60) else caught-fail) in
                        {1071}let server_fk_3: bitstring = (if v_238 then catch-fail(hmac(tls_h,server_hts_3,x_69)) else caught-fail) in
                        {1072}let v_239: bool = not-caught-fail(server_fk_3) in
                        {1073}let (master_secret_14: bitstring,chk_10: aead_key,shk_10: aead_key,cfin_10: mac_key,sfin_10: mac_key) = (if v_230 then (if v_231 then (if v_233 then (if v_235 then (if v_236 then (if v_237 then (if v_238 then (if v_239 then (master_secret_13,client_wkh_3,server_wkh_3,client_fk_3,server_fk_3) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
                        {929}let id_client_8: idProc = id_client_7 in
                        {1074}event SanityClientSH(id_client_8,cr_12,B32(sr24_1,sr8_1),c_dom_6,s_dom_7,handshake_secret_3,psk_28,cur_log_9);
                        {1075}if (is_accepted || (psk_ext_8 = empty_psk_ext)) then
                        (
                            {1077}in(io, enc_ee_msg_2: bitstring);
                            {1078}let ee_msg_3: msg = aead_dec(tls_a,shk_10,zero,zero,enc_ee_msg_2) in
                            {1079}let EE(x_70: bitstring) = ee_msg_3 in
                            {1080}let v_240: bool = not(is_accepted) in
                            {1081}let v_241: bitstring = (if v_240 then catch-fail(x_70) else caught-fail) in
                            {1082}let v_242: bool = (not-caught-fail(v_241) && success?(1-proj-server_ECH(v_241))) in
                            {1083}let ech_conf_1: echConfig = (if v_242 then 1-proj-server_ECH(v_241) else caught-fail) in
                            {1085}let cur_log2_9: bitstring = (cur_log_9,ee_msg_3) in
                            {1076}let sr_12: bytes32 = B32(sr24_1,sr8_1) in
                            {1086}out(ch_client_after_EE, (id_client_8,cr_12,sr_12,tls_h,tls_a,c_dom_6,s_dom_7,psk_28,master_secret_14,chk_10,shk_10,cfin_10,sfin_10,cur_log2_9))
                        )
                        else
                            {1087}out(io, illegal_parameter)
                    )
                    else
                        {1088}out(io, illegal_parameter)
                )
                else
                    {1089}out(io, illegal_parameter)
        )
        else
            {1090}out(io, unexpected_message)
    ) | (
        {1093}!
        {1096}in(io, (use_ech: bool,s_dom_8: domain));
        {1095}let cert_req_5: bool = true in
        {1094}let use_psk_3: bool = false in
        {1097}event Same((use_ech,use_psk_3,cert_req_5,s_dom_8));
        {1099}new id_server_4[]: idProc;
        {1100}event SanityServer(id_server_4,use_ech,use_psk_3,cert_req_5);
        {1101}if not((use_psk_3 && cert_req_5)) then
        {1102}in(io, x_client_hello: msg);
        {1103}let CH(cr_13: bytes32,offer_7: params) = x_client_hello in
        (
            {1104}let nego(=TLS13,c_h_alg: hash_alg,c_a_alg: aead_alg,kex_ext_5: keyShareExt,sni_ext_3: sniExt,ech_ext_8: echExt,psk_ext_9: preSharedKeyExt,extra_ext_2: extraExt) = offer_7 in
            {1105}if ((c_h_alg = tls_h) && (c_a_alg = tls_a)) then
            (
                {1098}let s_extra_1: extraExt = empty_extra_ext in
                {1106}let client_kex_ext(DHE_group(=tls_g)) = kex_ext_5 in
                (
                    {1107}if (sni_ext_3 = SNI(s_dom_8)) then
                    (
                        {1108}if use_ech then
                            {1109}out(io, abort_error)
                        else
                            {1110}let hrr_mode: params = nego(TLS13,tls_h,tls_a,hrr_kex_ext(tls_g),empty_sni_ext,empty_ech_ext,empty_psk_ext,empty_extra_ext) in
                            {1111}let hello_retry_request: msg = SH(rand_HelloRetryRequest,hrr_mode) in
                            {1112}out(io, hello_retry_request);
                            {1113}let cur_log_HRR: bitstring = ((zero,x_client_hello),hello_retry_request) in
                            {1114}event SanityServerHRR(id_server_4,cr_13,s_dom_8,cur_log_HRR);
                            {1115}in(io, client_hello'_1: msg);
                            {1116}let CH(cr'_1: bytes32,offer': params) = client_hello'_1 in
                                {1117}out(ch_server_SH, (id_server_4,use_psk_3,false,cert_req_5,s_dom_8,tls_g,tls_h,tls_a,s_extra_1,zero,client_hello'_1,cur_log_HRR))
                            else
                                {1118}out(io, unexpected_message)
                    )
                    else
                        {1119}out(io, illegal_parameter)
                )
                else
                    {1120}let client_kex_ext(DHE_kex(=tls_g,gx_8: element)) = kex_ext_5 in
                    (
                        {1121}let (client_ECH(ech_h_alg: hash_alg,ech_aead_alg: aead_alg,config_id_2: configId,enc_3: element,payload_3: bitstring),=true) = (ech_ext_8,use_ech) in
                        (
                            {1123}let CH(r_1: bytes32,offer_8: params) = x_client_hello in
                            {1124}let nego(=TLS13,=tls_h,=tls_a,kex_ext_6: keyShareExt,sni_ext_4: sniExt,ech_ext_9: echExt,=empty_psk_ext,extra_ext_3: extraExt) = offer_8 in
                            {1125}let client_ECH(ech_h_alg_1: hash_alg,ech_a_alg: aead_alg,config_id_3: configId,enc_4: element,payload_4: bitstring) = ech_ext_9 in
                            {1122}let id_server_5: idProc = id_server_4 in
                            {1249}get ech_configurations(ech_config(=config_id_3,ech_g_1: group,pkR_3: element,=s_dom_8,=ech_h_alg_1,=ech_a_alg),skR_2: bitstring) in
                            (
                                {1127}let v_243: msg = x_client_hello in
                                {1128}let v_244: bool = (success?(1-proj-nego(2-proj-CH(v_243))) && success?(1-proj-CH(v_243))) in
                                {1129}let extra_15: extraExt = (if v_244 then 8-proj-nego(2-proj-CH(v_243)) else caught-fail) in
                                {1130}let psk_ext_10: preSharedKeyExt = (if v_244 then 7-proj-nego(2-proj-CH(v_243)) else caught-fail) in
                                {1131}let ech_ext_10: echExt = (if v_244 then 6-proj-nego(2-proj-CH(v_243)) else caught-fail) in
                                {1132}let sni_ext_5: sniExt = (if v_244 then 5-proj-nego(2-proj-CH(v_243)) else caught-fail) in
                                {1133}let kex_ext_7: keyShareExt = (if v_244 then 4-proj-nego(2-proj-CH(v_243)) else caught-fail) in
                                {1134}let a_alg_11: aead_alg = (if v_244 then 3-proj-nego(2-proj-CH(v_243)) else caught-fail) in
                                {1135}let h_alg_11: hash_alg = (if v_244 then 2-proj-nego(2-proj-CH(v_243)) else caught-fail) in
                                {1136}let version_1: TLS_version = (if v_244 then 1-proj-nego(2-proj-CH(v_243)) else caught-fail) in
                                {1137}let r_2: bytes32 = (if v_244 then 1-proj-CH(v_243) else caught-fail) in
                                {1138}let v_245: echExt = (if v_244 then catch-fail(ech_ext_10) else caught-fail) in
                                {1139}let v_246: bool = (not-caught-fail(v_245) && success?(1-proj-client_ECH(v_245))) in
                                {1140}let payload_5: bitstring = (if v_246 then 5-proj-client_ECH(v_245) else caught-fail) in
                                {1141}let enc_5: element = (if v_246 then 4-proj-client_ECH(v_245) else caught-fail) in
                                {1142}let config_id_4: configId = (if v_246 then 3-proj-client_ECH(v_245) else caught-fail) in
                                {1143}let a_alg_ech_2: aead_alg = (if v_246 then 2-proj-client_ECH(v_245) else caught-fail) in
                                {1144}let h_alg_ech_2: hash_alg = (if v_246 then 1-proj-client_ECH(v_245) else caught-fail) in
                                {1151}new s_28[]: seed;
                                {1145}let client_hello_outer'_1: msg = (if v_246 then CH(r_2,nego(version_1,h_alg_11,a_alg_11,kex_ext_7,sni_ext_5,empty_ech_ext,psk_ext_10,extra_15)) else caught-fail) in
                                {1146}let client_hello_AAD_1: ClientHelloOuterAAD = catch-fail((if v_244 then (if v_246 then client_hello_outer_AAD(h_alg_ech_2,a_alg_ech_2,config_id_4,enc_5,client_hello_outer'_1) else fail-any) else fail-any)) in
                                {1147}let v_247: bool = not-caught-fail(client_hello_AAD_1) in
                                {1126}let ech_conf_2: echConfig = ech_config(config_id_3,ech_g_1,pkR_3,s_dom_8,ech_h_alg_1,ech_a_alg) in
                                {1148}let info_1: bitstring = (if v_247 then (tls_ech_str,ech_conf_2) else caught-fail) in
                                {1155}let k_19: bitstring = (if v_247 then (hpke_info_hash,info_1) else caught-fail) in
                                {1154}let s_29: bitstring = (if v_247 then zero else caught-fail) in
                                {1156}let info_hash_1: bitstring = (if v_247 then catch-fail(hmac(ech_h_alg_1,s_29,k_19)) else caught-fail) in
                                {1157}let v_249: bool = not-caught-fail(info_hash_1) in
                                {1158}let k_20: bitstring = (if v_249 then (hpke_secret,zero) else caught-fail) in
                                {1149}let gxy_8: element = (if v_247 then catch-fail(dh_decap_fun(ech_g_1,enc_4,skR_2)) else caught-fail) in
                                {1150}let v_248: bool = not-caught-fail(gxy_8) in
                                {1152}let shared_secret_1: element = (if v_247 then (if v_248 then gxy_8 else dh_f(s_28)) else caught-fail) in
                                {1159}let xsecret_1: bitstring = (if v_249 then catch-fail(hmac(ech_h_alg_1,shared_secret_1,k_20)) else caught-fail) in
                                {1160}let v_250: bool = not-caught-fail(xsecret_1) in
                                {1161}let l_64: label = (if v_250 then hpke_key else caught-fail) in
                                {1162}let x_71: bitstring = (if v_250 then (l_64,info_hash_1) else caught-fail) in
                                {1163}let key_2: aead_key = (if v_250 then catch-fail(hmac(ech_h_alg_1,xsecret_1,x_71)) else caught-fail) in
                                {1164}let v_251: bool = not-caught-fail(key_2) in
                                {1165}let l_65: label = (if v_251 then hpke_base_nonce else caught-fail) in
                                {1166}let x_72: bitstring = (if v_251 then (l_65,info_hash_1) else caught-fail) in
                                {1167}let base_nonce_1: bitstring = (if v_251 then catch-fail(hmac(ech_h_alg_1,xsecret_1,x_72)) else caught-fail) in
                                {1168}let v_252: bool = not-caught-fail(base_nonce_1) in
                                {1169}let l_66: label = (if v_252 then hpke_exp else caught-fail) in
                                {1170}let x_73: bitstring = (if v_252 then (l_66,info_hash_1) else caught-fail) in
                                {1171}let exporter_secret_1: bitstring = (if v_252 then catch-fail(hmac(ech_h_alg_1,xsecret_1,x_73)) else caught-fail) in
                                {1172}let v_253: bool = not-caught-fail(exporter_secret_1) in
                                {1153}let m_25: hpkeMode = (if v_247 then R else caught-fail) in
                                {1173}let context_1: hpkeContext = (if v_247 then catch-fail((if v_249 then (if v_250 then (if v_251 then (if v_252 then (if v_253 then hpke_context(m_25,key_2) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) else caught-fail) in
                                {1174}let v_254: bool = not-caught-fail(context_1) in
                                {1175}let v_255: hpkeContext = (if v_254 then catch-fail(context_1) else caught-fail) in
                                {1176}let v_256: bool = (not-caught-fail(v_255) && ((R =nf 1-proj-hpke_context(v_255)) && success?(1-proj-hpke_context(v_255)))) in
                                {1177}let key_3: aead_key = (if v_256 then 2-proj-hpke_context(v_255) else caught-fail) in
                                {1178}let i_client_hello_2: msg = (if v_254 then catch-fail((if v_256 then aead_dec(ech_a_alg,key_3,nonce_for_seal_open,client_hello_AAD_1,payload_4) else fail-any)) else caught-fail) in
                                {1179}let v_257: bool = not-caught-fail(i_client_hello_2) in
                                {1180}let v_258: msg = (if v_257 then catch-fail(i_client_hello_2) else caught-fail) in
                                {1181}let v_259: bool = (not-caught-fail(v_258) && ((((TLS13 =nf 1-proj-nego(2-proj-CH(v_258))) && success?(1-proj-SNI(5-proj-nego(2-proj-CH(v_258))))) && success?(1-proj-nego(2-proj-CH(v_258)))) && success?(1-proj-CH(v_258)))) in
                                {1182}let extra_ext': extraExt = (if v_259 then 8-proj-nego(2-proj-CH(v_258)) else caught-fail) in
                                {1183}let empty_psk_ext': preSharedKeyExt = (if v_259 then 7-proj-nego(2-proj-CH(v_258)) else caught-fail) in
                                {1184}let ech_ext': echExt = (if v_259 then 6-proj-nego(2-proj-CH(v_258)) else caught-fail) in
                                {1185}let i_dom: domain = (if v_259 then 1-proj-SNI(5-proj-nego(2-proj-CH(v_258))) else caught-fail) in
                                {1186}let kex_ext'_1: keyShareExt = (if v_259 then 4-proj-nego(2-proj-CH(v_258)) else caught-fail) in
                                {1187}let a_alg': aead_alg = (if v_259 then 3-proj-nego(2-proj-CH(v_258)) else caught-fail) in
                                {1188}let h_alg': hash_alg = (if v_259 then 2-proj-nego(2-proj-CH(v_258)) else caught-fail) in
                                {1189}let cr'_2: bytes32 = (if v_259 then 1-proj-CH(v_258) else caught-fail) in
                                {1190}let v_260: bool = (v_257 && not(v_259)) in
                                {1191}let v_261: echConfig = (if v_260 then catch-fail(ech_conf_2) else caught-fail) in
                                {1192}let v_262: bool = (not-caught-fail(v_261) && success?(1-proj-ech_config(v_261))) in
                                {1193}let a_alg_12: aead_alg = (if v_262 then 6-proj-ech_config(v_261) else caught-fail) in
                                {1194}let h_alg_12: hash_alg = (if v_262 then 5-proj-ech_config(v_261) else caught-fail) in
                                {1195}let s_dom_9: domain = (if v_262 then 4-proj-ech_config(v_261) else caught-fail) in
                                {1196}let pkR_4: element = (if v_262 then 3-proj-ech_config(v_261) else caught-fail) in
                                {1197}let g_8: group = (if v_262 then 2-proj-ech_config(v_261) else caught-fail) in
                                {1198}let config_id_5: configId = (if v_262 then 1-proj-ech_config(v_261) else caught-fail) in
                                {1199}new s_30[]: seed;
                                {1200}let gx_9: element = (if v_262 then dh_pub(g_8,dh_k(s_30)) else caught-fail) in
                                {1201}let v_263: bitstring = (if v_262 then catch-fail((dh_k(s_30),gx_9)) else caught-fail) in
                                {1202}let v_264: bool = (not-caught-fail(v_263) && success?(1-proj-2-tuple(v_263))) in
                                {1203}let pkR': element = (if v_264 then 2-proj-2-tuple(v_263) else caught-fail) in
                                {1204}let skR': bitstring = (if v_264 then 1-proj-2-tuple(v_263) else caught-fail) in
                                {1205}new config_id'[]: configId;
                                {1208}let v_266: bool = (v_254 && not(v_257)) in
                                {1209}let v_267: echConfig = (if v_266 then catch-fail(ech_conf_2) else caught-fail) in
                                {1210}let v_268: bool = (not-caught-fail(v_267) && success?(1-proj-ech_config(v_267))) in
                                {1211}let a_alg_13: aead_alg = (if v_268 then 6-proj-ech_config(v_267) else caught-fail) in
                                {1212}let h_alg_13: hash_alg = (if v_268 then 5-proj-ech_config(v_267) else caught-fail) in
                                {1213}let s_dom_10: domain = (if v_268 then 4-proj-ech_config(v_267) else caught-fail) in
                                {1214}let pkR_5: element = (if v_268 then 3-proj-ech_config(v_267) else caught-fail) in
                                {1215}let g_9: group = (if v_268 then 2-proj-ech_config(v_267) else caught-fail) in
                                {1216}let config_id_6: configId = (if v_268 then 1-proj-ech_config(v_267) else caught-fail) in
                                {1217}new s_31[]: seed;
                                {1218}let gx_10: element = (if v_268 then dh_pub(g_9,dh_k(s_31)) else caught-fail) in
                                {1219}let v_269: bitstring = (if v_268 then catch-fail((dh_k(s_31),gx_10)) else caught-fail) in
                                {1220}let v_270: bool = (not-caught-fail(v_269) && success?(1-proj-2-tuple(v_269))) in
                                {1221}let pkR'_1: element = (if v_270 then 2-proj-2-tuple(v_269) else caught-fail) in
                                {1222}let skR'_1: bitstring = (if v_270 then 1-proj-2-tuple(v_269) else caught-fail) in
                                {1223}new config_id'_1[]: configId;
                                {1224}let retry_config_1: echConfig = (if v_266 then catch-fail((if v_268 then (if v_270 then ech_config(config_id'_1,g_9,pkR'_1,s_dom_10,h_alg_13,a_alg_13) else fail-any) else fail-any)) else caught-fail) in
                                {1225}let v_271: bool = not-caught-fail(retry_config_1) in
                                {1206}let retry_config: echConfig = (if v_260 then catch-fail((if v_262 then (if v_264 then ech_config(config_id',g_8,pkR',s_dom_9,h_alg_12,a_alg_12) else fail-any) else fail-any)) else caught-fail) in
                                {1207}let v_265: bool = not-caught-fail(retry_config) in
                                {1226}let (s_dom_11: domain,client_hello_2: msg,encrypted_ext_1: bitstring,is_backend_1: bool) = (if v_247 then (if v_254 then (if v_257 then (if v_259 then (i_dom,i_client_hello_2,zero,true) else (if v_265 then (s_dom_8,x_client_hello,server_ECH(retry_config),false) else fail-any)) else (if v_271 then (s_dom_8,x_client_hello,server_ECH(retry_config_1),false) else fail-any)) else fail-any) else fail-any) in
                                {1227}out(ch_server_SH, (id_server_5,use_psk_3,is_backend_1,cert_req_5,s_dom_11,tls_g,tls_h,tls_a,s_extra_1,encrypted_ext_1,client_hello_2,zero))
                            )
                            else
                                {1248}get ech_configurations(ech_config(config_id'_2: configId,ech_g': group,pkR'_2: element,=s_dom_8,ech_h_alg': hash_alg,ech_a_alg': aead_alg),skR'_2: bitstring) in
                                {1228}let config_2: echConfig = ech_config(config_id'_2,ech_g',pkR'_2,s_dom_8,ech_h_alg',ech_a_alg') in
                                {1229}let v_272: echConfig = config_2 in
                                {1230}let v_273: bool = success?(1-proj-ech_config(v_272)) in
                                {1231}let a_alg_14: aead_alg = (if v_273 then 6-proj-ech_config(v_272) else caught-fail) in
                                {1232}let h_alg_14: hash_alg = (if v_273 then 5-proj-ech_config(v_272) else caught-fail) in
                                {1233}let s_dom_12: domain = (if v_273 then 4-proj-ech_config(v_272) else caught-fail) in
                                {1234}let pkR_6: element = (if v_273 then 3-proj-ech_config(v_272) else caught-fail) in
                                {1235}let g_10: group = (if v_273 then 2-proj-ech_config(v_272) else caught-fail) in
                                {1236}let config_id_7: configId = (if v_273 then 1-proj-ech_config(v_272) else caught-fail) in
                                {1237}new s_32[]: seed;
                                {1238}let gx_11: element = (if v_273 then dh_pub(g_10,dh_k(s_32)) else caught-fail) in
                                {1239}let v_274: bitstring = (if v_273 then catch-fail((dh_k(s_32),gx_11)) else caught-fail) in
                                {1240}let v_275: bool = (not-caught-fail(v_274) && success?(1-proj-2-tuple(v_274))) in
                                {1241}let pkR'_3: element = (if v_275 then 2-proj-2-tuple(v_274) else caught-fail) in
                                {1242}let skR'_3: bitstring = (if v_275 then 1-proj-2-tuple(v_274) else caught-fail) in
                                {1243}new config_id'_3[]: configId;
                                {1244}let retry_config_2: echConfig = catch-fail((if v_273 then (if v_275 then ech_config(config_id'_3,g_10,pkR'_3,s_dom_12,h_alg_14,a_alg_14) else fail-any) else fail-any)) in
                                {1245}let v_276: bool = not-caught-fail(retry_config_2) in
                                {1246}let (s_dom_13: domain,client_hello_3: msg,encrypted_ext_2: bitstring,is_backend_2: bool) = (if v_276 then (s_dom_8,x_client_hello,server_ECH(retry_config_2),false) else fail-any) in
                                {1247}out(ch_server_SH, (id_server_5,use_psk_3,is_backend_2,cert_req_5,s_dom_13,tls_g,tls_h,tls_a,s_extra_1,encrypted_ext_2,client_hello_3,zero))
                        )
                        else
                            {1250}if ((ech_ext_8 = empty_ech_ext) || not(use_ech)) then
                                {1251}out(ch_server_SH, (id_server_4,use_psk_3,false,cert_req_5,s_dom_8,tls_g,tls_h,tls_a,s_extra_1,zero,x_client_hello,zero))
                            else
                                {1252}out(io, illegal_parameter)
                    )
                    else
                        {1253}out(io, handshake_failure)
            )
            else
                {1254}out(io, handshake_failure)
        )
        else
            {1255}out(io, unexpected_message)
    ) | (
        {1259}in(io, (s_dom_14: domain,cfs_dom_1: domain));
        {1257}let use_psk_4: bool = false in
        {1256}let use_grease_1: bool = false in
        {1260}event Same((use_grease_1,use_psk_4,s_dom_14));
        {1609}get ech_configurations(ech_config(id_11: configId,g_11: group,pkR_7: element,=cfs_dom_1,h_alg_15: hash_alg,a_alg_15: aead_alg),skR_3: bitstring) in
        {1265}new id_client_9[]: idProc;
        {1258}let send_kex_3: bool = true in
        {1266}event SanityClient(id_client_9,true,use_grease_1,use_psk_4,send_kex_3);
        {1267}if not((use_grease_1 && use_psk_4)) then
        {1269}new s_33[]: seed;
        {1270}let gx_12: element = dh_pub(tls_g,dh_k(s_33)) in
        {1271}let v_277: bitstring = (dh_k(s_33),gx_12) in
        {1272}let v_278: bool = success?(1-proj-2-tuple(v_277)) in
        {1273}let i_gx_1: element = (if v_278 then 2-proj-2-tuple(v_277) else caught-fail) in
        {1274}let i_x_2: bitstring = (if v_278 then 1-proj-2-tuple(v_277) else caught-fail) in
        {1275}new s_34[]: seed;
        {1276}let gx_13: element = (if v_278 then dh_pub(tls_g,dh_k(s_34)) else caught-fail) in
        {1277}let v_279: bitstring = (if v_278 then catch-fail((dh_k(s_34),gx_13)) else caught-fail) in
        {1278}let v_280: bool = (not-caught-fail(v_279) && success?(1-proj-2-tuple(v_279))) in
        {1279}let o_gx_1: element = (if v_280 then 2-proj-2-tuple(v_279) else caught-fail) in
        {1280}let o_x_2: bitstring = (if v_280 then 1-proj-2-tuple(v_279) else caught-fail) in
        {1281}let v_281: bitstring = (if v_280 then catch-fail((if send_kex_3 then (DHE_kex(tls_g,i_gx_1),DHE_kex(tls_g,o_gx_1)) else (DHE_group(tls_g),DHE_group(tls_g)))) else caught-fail) in
        {1282}let v_282: bool = (not-caught-fail(v_281) && success?(1-proj-2-tuple(v_281))) in
        {1283}let o_kex_1: kex_alg = (if v_282 then 2-proj-2-tuple(v_281) else caught-fail) in
        {1284}let i_kex_1: kex_alg = (if v_282 then 1-proj-2-tuple(v_281) else caught-fail) in
        {1285}let (i_kex_ext_2: keyShareExt,o_kex_ext_2: keyShareExt,kex_data_5: bitstring) = (if v_278 then (if v_280 then (if v_282 then (client_kex_ext(i_kex_1),client_kex_ext(o_kex_1),(i_x_2,o_x_2,tls_g,send_kex_3)) else fail-any) else fail-any) else fail-any) in
        {1286}new rand24_5[]: bytes24;
        {1287}new rand8_5[]: bytes8;
        {1608}get pre_shared_keys(c_dom'_4: domain,s_dom'_4: domain,=tls_h,id_12: identityPsk,internal_psk_3: internal_preSharedKey) in
        {1262}let c_dom_7: domain = choice[ClientA,ClientB] in
        {1290}event Selected_psk(c_dom_7,c_dom'_4,s_dom_14,s_dom'_4,id_12,internal_psk_3);
        {1291}let v_283: bool = use_psk_4 in
        {1292}let psk_30: preSharedKey = (if v_283 then PSK(internal_psk_3) else caught-fail) in
        {1296}let k_21: bitstring = (if v_283 then catch-fail(psk2b(psk_30)) else caught-fail) in
        {1297}let v_284: bool = not-caught-fail(k_21) in
        {1295}let s_35: bitstring = (if v_283 then zero else caught-fail) in
        {1298}let early_secret_18: bitstring = (if v_283 then catch-fail((if v_284 then hmac(tls_h,s_35,k_21) else fail-any)) else caught-fail) in
        {1299}let v_285: bool = not-caught-fail(early_secret_18) in
        {1301}let m_26: bitstring = (if v_285 then zero else caught-fail) in
        {1302}let h_61: bitstring = (if v_285 then catch-fail(hash(tls_h,m_26)) else caught-fail) in
        {1303}let v_286: bool = not-caught-fail(h_61) in
        {1300}let l_67: label = (if v_285 then tls13_resumption_psk_binder_key else caught-fail) in
        {1304}let x_74: bitstring = (if v_286 then (l_67,h_61) else caught-fail) in
        {1305}let binder_key_13: bitstring = (if v_285 then catch-fail((if v_286 then hmac(tls_h,early_secret_18,x_74) else fail-any)) else caught-fail) in
        {1306}let v_287: bool = not-caught-fail(binder_key_13) in
        {1307}let v_288: bitstring = (if v_283 then catch-fail((if v_285 then (if v_287 then (early_secret_18,binder_key_13) else fail-any) else fail-any)) else caught-fail) in
        {1308}let v_289: bool = (not-caught-fail(v_288) && success?(1-proj-2-tuple(v_288))) in
        {1309}let kb_13: mac_key = (if v_289 then 2-proj-2-tuple(v_288) else caught-fail) in
        {1310}let es_17: bitstring = (if v_289 then 1-proj-2-tuple(v_288) else caught-fail) in
        {1313}let psk_31: preSharedKey = (if not(v_283) then NoPSK else caught-fail) in
        {1315}let k_22: bitstring = (if not(v_283) then catch-fail(psk2b(psk_31)) else caught-fail) in
        {1316}let v_291: bool = not-caught-fail(k_22) in
        {1314}let s_36: bitstring = (if not(v_283) then zero else caught-fail) in
        {1317}let early_secret_19: bitstring = (if not(v_283) then catch-fail((if v_291 then hmac(tls_h,s_36,k_22) else fail-any)) else caught-fail) in
        {1318}let v_292: bool = not-caught-fail(early_secret_19) in
        {1320}let m_27: bitstring = (if v_292 then zero else caught-fail) in
        {1321}let h_62: bitstring = (if v_292 then catch-fail(hash(tls_h,m_27)) else caught-fail) in
        {1322}let v_293: bool = not-caught-fail(h_62) in
        {1319}let l_68: label = (if v_292 then tls13_resumption_psk_binder_key else caught-fail) in
        {1323}let x_75: bitstring = (if v_293 then (l_68,h_62) else caught-fail) in
        {1324}let binder_key_14: bitstring = (if v_292 then catch-fail((if v_293 then hmac(tls_h,early_secret_19,x_75) else fail-any)) else caught-fail) in
        {1325}let v_294: bool = not-caught-fail(binder_key_14) in
        {1326}let v_295: bitstring = (if not(v_283) then catch-fail((if v_292 then (if v_294 then (early_secret_19,binder_key_14) else fail-any) else fail-any)) else caught-fail) in
        {1327}let v_296: bool = (not-caught-fail(v_295) && success?(1-proj-2-tuple(v_295))) in
        {1328}let kb_14: mac_key = (if v_296 then 2-proj-2-tuple(v_295) else caught-fail) in
        {1329}let es_18: bitstring = (if v_296 then 1-proj-2-tuple(v_295) else caught-fail) in
        {1289}let ech_ext_11: echExt = ech_is_inner in
        {1263}let i_extra_1: extraExt = empty_extra_ext in
        {1293}let offer_9: params = (if v_283 then nego(TLS13,tls_h,tls_a,i_kex_ext_2,SNI(s_dom_14),ech_ext_11,trunc_client_psk_ext(id_12),i_extra_1) else caught-fail) in
        {1288}let i_cr_2: bytes32 = B32(rand24_5,rand8_5) in
        {1268}let i_cur_log_2: bitstring = zero in
        {1294}let cur_log'_5: bitstring = (if v_283 then (i_cur_log_2,CH(i_cr_2,offer_9)) else caught-fail) in
        {1311}let binders_4: bitstring = (if v_289 then catch-fail(hmac(tls_h,kb_13,cur_log'_5)) else caught-fail) in
        {1312}let v_290: bool = not-caught-fail(binders_4) in
        {1330}let v_297: bitstring = catch-fail((if v_283 then (if v_289 then (if v_290 then (client_psk_ext(id_12,binders_4),(tls_h,psk_30,es_17)) else fail-any) else fail-any) else (if v_296 then (empty_psk_ext,(tls_h,NoPSK,es_18)) else fail-any))) in
        {1331}let v_298: bool = (not-caught-fail(v_297) && success?(1-proj-2-tuple(v_297))) in
        {1332}let psk_data_5: bitstring = (if v_298 then 2-proj-2-tuple(v_297) else caught-fail) in
        {1333}let psk_ext_11: preSharedKeyExt = (if v_298 then 1-proj-2-tuple(v_297) else caught-fail) in
        {1261}let ech_conf_3: echConfig = ech_config(id_11,g_11,pkR_7,cfs_dom_1,h_alg_15,a_alg_15) in
        {1336}let v_299: echConfig = (if v_298 then catch-fail(ech_conf_3) else caught-fail) in
        {1337}let v_300: bool = (not-caught-fail(v_299) && success?(1-proj-ech_config(v_299))) in
        {1338}let a_alg_ech_3: aead_alg = (if v_300 then 6-proj-ech_config(v_299) else caught-fail) in
        {1339}let h_alg_ech_3: hash_alg = (if v_300 then 5-proj-ech_config(v_299) else caught-fail) in
        {1340}let o_dom_4: domain = (if v_300 then 4-proj-ech_config(v_299) else caught-fail) in
        {1341}let pkR_8: element = (if v_300 then 3-proj-ech_config(v_299) else caught-fail) in
        {1342}let g_ech_1: group = (if v_300 then 2-proj-ech_config(v_299) else caught-fail) in
        {1343}let config_id_8: configId = (if v_300 then 1-proj-ech_config(v_299) else caught-fail) in
        {1345}new s_37[]: seed;
        {1346}let v_301: bitstring = (if v_300 then catch-fail((dh_xy(s_37,pkR_8),dh_encap_fun(g_ech_1,pkR_8,dh_xy(s_37,pkR_8)))) else caught-fail) in
        {1347}let v_302: bool = (not-caught-fail(v_301) && success?(1-proj-2-tuple(v_301))) in
        {1348}let enc_6: element = (if v_302 then 2-proj-2-tuple(v_301) else caught-fail) in
        {1349}let shared_secret_2: element = (if v_302 then 1-proj-2-tuple(v_301) else caught-fail) in
        {1344}let info_2: bitstring = (if v_300 then (tls_ech_str,ech_conf_3) else caught-fail) in
        {1352}let k_23: bitstring = (if v_302 then (hpke_info_hash,info_2) else caught-fail) in
        {1351}let s_38: bitstring = (if v_302 then zero else caught-fail) in
        {1353}let info_hash_2: bitstring = (if v_302 then catch-fail(hmac(h_alg_ech_3,s_38,k_23)) else caught-fail) in
        {1354}let v_303: bool = not-caught-fail(info_hash_2) in
        {1355}let k_24: bitstring = (if v_303 then (hpke_secret,zero) else caught-fail) in
        {1356}let xsecret_2: bitstring = (if v_303 then catch-fail(hmac(h_alg_ech_3,shared_secret_2,k_24)) else caught-fail) in
        {1357}let v_304: bool = not-caught-fail(xsecret_2) in
        {1358}let l_69: label = (if v_304 then hpke_key else caught-fail) in
        {1359}let x_76: bitstring = (if v_304 then (l_69,info_hash_2) else caught-fail) in
        {1360}let key_4: aead_key = (if v_304 then catch-fail(hmac(h_alg_ech_3,xsecret_2,x_76)) else caught-fail) in
        {1361}let v_305: bool = not-caught-fail(key_4) in
        {1362}let l_70: label = (if v_305 then hpke_base_nonce else caught-fail) in
        {1363}let x_77: bitstring = (if v_305 then (l_70,info_hash_2) else caught-fail) in
        {1364}let base_nonce_2: bitstring = (if v_305 then catch-fail(hmac(h_alg_ech_3,xsecret_2,x_77)) else caught-fail) in
        {1365}let v_306: bool = not-caught-fail(base_nonce_2) in
        {1366}let l_71: label = (if v_306 then hpke_exp else caught-fail) in
        {1367}let x_78: bitstring = (if v_306 then (l_71,info_hash_2) else caught-fail) in
        {1368}let exporter_secret_2: bitstring = (if v_306 then catch-fail(hmac(h_alg_ech_3,xsecret_2,x_78)) else caught-fail) in
        {1369}let v_307: bool = not-caught-fail(exporter_secret_2) in
        {1350}let m_28: hpkeMode = (if v_302 then S else caught-fail) in
        {1370}let v_308: bitstring = (if v_300 then catch-fail((if v_302 then (enc_6,(if v_303 then (if v_304 then (if v_305 then (if v_306 then (if v_307 then hpke_context(m_28,key_4) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any)) else fail-any)) else caught-fail) in
        {1371}let v_309: bool = (not-caught-fail(v_308) && success?(1-proj-2-tuple(v_308))) in
        {1372}let context_2: hpkeContext = (if v_309 then 2-proj-2-tuple(v_308) else caught-fail) in
        {1373}let enc_7: element = (if v_309 then 1-proj-2-tuple(v_308) else caught-fail) in
        {1374}new rand24_6[]: bytes24;
        {1375}new rand8_6[]: bytes8;
        {1378}new payload_6[]: bitstring;
        {1377}let v_310: bool = (if v_309 then catch-fail(use_grease_1) else caught-fail) in
        {1381}let dummy_ech_ext_1: echExt = (if is-false(v_310) then client_ECH(h_alg_ech_3,a_alg_ech_3,config_id_8,enc_7,zero) else caught-fail) in
        {1264}let o_extra_1: extraExt = empty_extra_ext in
        {1382}let o_offer1_1: params = (if is-false(v_310) then nego(TLS13,tls_h,tls_a,o_kex_ext_2,SNI(o_dom_4),dummy_ech_ext_1,empty_psk_ext,o_extra_1) else caught-fail) in
        {1376}let o_cr_2: bytes32 = (if v_309 then B32(rand24_6,rand8_6) else caught-fail) in
        {1383}let o_client_hello1_1: msg = (if is-false(v_310) then CH(o_cr_2,o_offer1_1) else caught-fail) in
        {1384}let v_311: msg = (if is-false(v_310) then catch-fail(o_client_hello1_1) else caught-fail) in
        {1385}let v_312: bool = (not-caught-fail(v_311) && (success?(1-proj-nego(2-proj-CH(v_311))) && success?(1-proj-CH(v_311)))) in
        {1386}let extra_16: extraExt = (if v_312 then 8-proj-nego(2-proj-CH(v_311)) else caught-fail) in
        {1387}let psk_ext_12: preSharedKeyExt = (if v_312 then 7-proj-nego(2-proj-CH(v_311)) else caught-fail) in
        {1388}let ech_ext_13: echExt = (if v_312 then 6-proj-nego(2-proj-CH(v_311)) else caught-fail) in
        {1389}let sni_ext_6: sniExt = (if v_312 then 5-proj-nego(2-proj-CH(v_311)) else caught-fail) in
        {1390}let kex_ext_8: keyShareExt = (if v_312 then 4-proj-nego(2-proj-CH(v_311)) else caught-fail) in
        {1391}let a_alg_16: aead_alg = (if v_312 then 3-proj-nego(2-proj-CH(v_311)) else caught-fail) in
        {1392}let h_alg_16: hash_alg = (if v_312 then 2-proj-nego(2-proj-CH(v_311)) else caught-fail) in
        {1393}let version_2: TLS_version = (if v_312 then 1-proj-nego(2-proj-CH(v_311)) else caught-fail) in
        {1394}let r_3: bytes32 = (if v_312 then 1-proj-CH(v_311) else caught-fail) in
        {1395}let v_313: echExt = (if v_312 then catch-fail(ech_ext_13) else caught-fail) in
        {1396}let v_314: bool = (not-caught-fail(v_313) && success?(1-proj-client_ECH(v_313))) in
        {1397}let payload_7: bitstring = (if v_314 then 5-proj-client_ECH(v_313) else caught-fail) in
        {1398}let enc_8: element = (if v_314 then 4-proj-client_ECH(v_313) else caught-fail) in
        {1399}let config_id_9: configId = (if v_314 then 3-proj-client_ECH(v_313) else caught-fail) in
        {1400}let a_alg_ech_4: aead_alg = (if v_314 then 2-proj-client_ECH(v_313) else caught-fail) in
        {1401}let h_alg_ech_4: hash_alg = (if v_314 then 1-proj-client_ECH(v_313) else caught-fail) in
        {1402}let client_hello_outer'_2: msg = (if v_314 then CH(r_3,nego(version_2,h_alg_16,a_alg_16,kex_ext_8,sni_ext_6,empty_ech_ext,psk_ext_12,extra_16)) else caught-fail) in
        {1403}let client_hello_AAD_2: ClientHelloOuterAAD = (if is-false(v_310) then catch-fail((if v_312 then (if v_314 then client_hello_outer_AAD(h_alg_ech_4,a_alg_ech_4,config_id_9,enc_8,client_hello_outer'_2) else fail-any) else fail-any)) else caught-fail) in
        {1404}let v_315: bool = not-caught-fail(client_hello_AAD_2) in
        {1405}let v_316: hpkeContext = (if v_315 then catch-fail(context_2) else caught-fail) in
        {1406}let v_317: bool = (not-caught-fail(v_316) && ((S =nf 1-proj-hpke_context(v_316)) && success?(1-proj-hpke_context(v_316)))) in
        {1407}let key_5: aead_key = (if v_317 then 2-proj-hpke_context(v_316) else caught-fail) in
        {1334}let i_offer_1: params = (if v_298 then nego(TLS13,tls_h,tls_a,i_kex_ext_2,SNI(s_dom_14),ech_is_inner,psk_ext_11,i_extra_1) else caught-fail) in
        {1335}let i_client_hello_3: msg = (if v_298 then CH(i_cr_2,i_offer_1) else caught-fail) in
        {1408}let payload_8: bitstring = (if v_315 then catch-fail((if v_317 then aead_enc(a_alg_ech_3,key_5,nonce_for_seal_open,client_hello_AAD_2,i_client_hello_3) else fail-any)) else caught-fail) in
        {1409}let v_318: bool = not-caught-fail(payload_8) in
        {1410}let ech_ext_14: echExt = (if v_318 then client_ECH(h_alg_ech_3,a_alg_ech_3,config_id_8,enc_7,payload_8) else caught-fail) in
        {1411}let o_offer_3: params = (if v_318 then nego(TLS13,tls_h,tls_a,o_kex_ext_2,SNI(o_dom_4),ech_ext_14,empty_psk_ext,o_extra_1) else caught-fail) in
        {1379}let ech_ext_12: echExt = (if v_310 then client_ECH(h_alg_ech_3,a_alg_ech_3,config_id_8,enc_7,payload_6) else caught-fail) in
        {1380}let o_offer_2: params = (if v_310 then nego(TLS13,tls_h,tls_a,o_kex_ext_2,SNI(o_dom_4),ech_ext_12,empty_psk_ext,o_extra_1) else caught-fail) in
        {1412}let (o_client_hello_1: msg,i_client_hello_4: msg,i_cr_3: bytes32,o_cr_3: bytes32,i_kex_ext_3: keyShareExt,o_kex_ext_3: keyShareExt,kex_data_6: bitstring,psk_data_6: bitstring) = (if v_298 then (if v_300 then (if v_309 then (if undo-catch-fail(v_310) then (CH(o_cr_2,o_offer_2),CH(o_cr_2,o_offer_2),o_cr_2,o_cr_2,o_kex_ext_2,o_kex_ext_2,kex_data_5,psk_data_5) else (if v_315 then (if v_318 then (CH(o_cr_2,o_offer_3),i_client_hello_3,i_cr_2,o_cr_2,i_kex_ext_2,o_kex_ext_2,kex_data_5,psk_data_5) else fail-any) else fail-any)) else fail-any) else fail-any) else fail-any) in
        {1413}out(io, o_client_hello_1);
        {1414}let (=tls_h,psk_32: preSharedKey,es_19: bitstring) = psk_data_6 in
        {1415}let v_319: echConfig = ech_conf_3 in
        {1416}let v_320: bool = success?(1-proj-ech_config(v_319)) in
        {1417}let al_3: aead_alg = (if v_320 then 6-proj-ech_config(v_319) else caught-fail) in
        {1418}let hl_3: hash_alg = (if v_320 then 5-proj-ech_config(v_319) else caught-fail) in
        {1419}let dom_3: domain = (if v_320 then 4-proj-ech_config(v_319) else caught-fail) in
        {1420}let public_key_3: element = (if v_320 then 3-proj-ech_config(v_319) else caught-fail) in
        {1421}let g_12: group = (if v_320 then 2-proj-ech_config(v_319) else caught-fail) in
        {1422}let id_13: configId = (if v_320 then 1-proj-ech_config(v_319) else caught-fail) in
        {1423}let o_dom_5: domain = (if v_320 then dom_3 else fail-any) in
        {1424}let v_321: echConfig = ech_conf_3 in
        {1425}let v_322: bool = success?(1-proj-ech_config(v_321)) in
        {1426}let al_4: aead_alg = (if v_322 then 6-proj-ech_config(v_321) else caught-fail) in
        {1427}let hl_4: hash_alg = (if v_322 then 5-proj-ech_config(v_321) else caught-fail) in
        {1428}let dom_4: domain = (if v_322 then 4-proj-ech_config(v_321) else caught-fail) in
        {1429}let public_key_4: element = (if v_322 then 3-proj-ech_config(v_321) else caught-fail) in
        {1430}let g_13: group = (if v_322 then 2-proj-ech_config(v_321) else caught-fail) in
        {1431}let id_14: configId = (if v_322 then 1-proj-ech_config(v_321) else caught-fail) in
        {1432}let ech_pk_1: element = (if v_322 then public_key_4 else fail-any) in
        {1433}event SanityClientCH_ECH(id_client_9,zero32,i_cr_3,o_cr_3,c_dom_7,o_dom_5,s_dom_14,ech_pk_1,psk_32,(zero,o_client_hello_1),(zero,i_client_hello_4));
        {1434}in(io, server_hello_3: msg);
        {1435}let SH(sr_13: bytes32,mode_5: params) = server_hello_3 in
        (
            {1436}if (sr_13 = rand_HelloRetryRequest) then
                {1437}out(io, illegal_parameter)
            else
                {1438}let v_323: echConfig = ech_conf_3 in
                {1439}let v_324: bool = success?(1-proj-ech_config(v_323)) in
                {1440}let al_5: aead_alg = (if v_324 then 6-proj-ech_config(v_323) else caught-fail) in
                {1441}let hl_5: hash_alg = (if v_324 then 5-proj-ech_config(v_323) else caught-fail) in
                {1442}let dom_5: domain = (if v_324 then 4-proj-ech_config(v_323) else caught-fail) in
                {1443}let public_key_5: element = (if v_324 then 3-proj-ech_config(v_323) else caught-fail) in
                {1444}let g_14: group = (if v_324 then 2-proj-ech_config(v_323) else caught-fail) in
                {1445}let id_15: configId = (if v_324 then 1-proj-ech_config(v_323) else caught-fail) in
                {1447}let o_dom_6: domain = (if v_324 then dom_5 else fail-any) in
                {1450}let SH(B32(sr24_2: bytes24,sr8_2: bytes8),mode_6: params) = server_hello_3 in
                {1451}let (i_x_3: bitstring,o_x_3: bitstring,g_15: group,=true) = kex_data_6 in
                {1452}let nego(=TLS13,=tls_h,=tls_a,server_kex_ext(DHE_kex(=g_15,gy_srv_1: element)),=empty_sni_ext,=empty_ech_ext,psk_ext_13: preSharedKeyExt,extra_17: extraExt) = mode_6 in
                (
                    {1453}let v_325: bool = (psk_ext_13 = empty_psk_ext) in
                    {1454}let psk_33: preSharedKey = (if v_325 then NoPSK else caught-fail) in
                    {1456}let k_25: bitstring = (if v_325 then catch-fail(psk2b(psk_33)) else caught-fail) in
                    {1457}let v_326: bool = not-caught-fail(k_25) in
                    {1455}let s_39: bitstring = (if v_325 then zero else caught-fail) in
                    {1458}let early_secret_20: bitstring = (if v_325 then catch-fail((if v_326 then hmac(tls_h,s_39,k_25) else fail-any)) else caught-fail) in
                    {1459}let v_327: bool = not-caught-fail(early_secret_20) in
                    {1461}let m_29: bitstring = (if v_327 then zero else caught-fail) in
                    {1462}let h_63: bitstring = (if v_327 then catch-fail(hash(tls_h,m_29)) else caught-fail) in
                    {1463}let v_328: bool = not-caught-fail(h_63) in
                    {1460}let l_72: label = (if v_327 then tls13_resumption_psk_binder_key else caught-fail) in
                    {1464}let x_79: bitstring = (if v_328 then (l_72,h_63) else caught-fail) in
                    {1465}let binder_key_15: bitstring = (if v_327 then catch-fail((if v_328 then hmac(tls_h,early_secret_20,x_79) else fail-any)) else caught-fail) in
                    {1466}let v_329: bool = not-caught-fail(binder_key_15) in
                    {1467}let v_330: bitstring = (if v_325 then catch-fail((if v_327 then (if v_329 then (early_secret_20,binder_key_15) else fail-any) else fail-any)) else caught-fail) in
                    {1468}let v_331: bool = (not-caught-fail(v_330) && success?(1-proj-2-tuple(v_330))) in
                    {1469}let kb_15: mac_key = (if v_331 then 2-proj-2-tuple(v_330) else caught-fail) in
                    {1470}let es_20: bitstring = (if v_331 then 1-proj-2-tuple(v_330) else caught-fail) in
                    {1471}let v_332: bitstring = (if not(v_325) then catch-fail(psk_data_6) else caught-fail) in
                    {1472}let v_333: bool = (not-caught-fail(v_332) && success?(1-proj-3-tuple(v_332))) in
                    {1473}let es_21: bitstring = (if v_333 then 3-proj-3-tuple(v_332) else caught-fail) in
                    {1474}let psk_34: preSharedKey = (if v_333 then 2-proj-3-tuple(v_332) else caught-fail) in
                    {1475}let h'_alg_3: hash_alg = (if v_333 then 1-proj-3-tuple(v_332) else caught-fail) in
                    {1476}let (psk_35: preSharedKey,early_secret_21: bitstring,valid_3: bool) = (if v_325 then (if v_331 then (NoPSK,es_20,true) else fail-any) else (if v_333 then (psk_34,es_21,((h'_alg_3 = tls_h) && ((server_psk_ext(1) = psk_ext_13) && use_psk_4))) else fail-any)) in
                    {1477}if valid_3 then
                    (
                        {1481}new s_40[]: seed;
                        {1478}let v_334: bool = use_grease_1 in
                        {1484}let m_30: bitstring = (if not(v_334) then catch-fail(hash(tls_h,zero)) else caught-fail) in
                        {1485}let v_336: bool = not-caught-fail(m_30) in
                        {1486}let h_64: bitstring = (if v_336 then catch-fail(hash(tls_h,m_30)) else caught-fail) in
                        {1487}let v_337: bool = not-caught-fail(h_64) in
                        {1483}let l_73: label = (if not(v_334) then tls13_derived else caught-fail) in
                        {1488}let x_80: bitstring = (if v_337 then (l_73,h_64) else caught-fail) in
                        {1489}let extra_18: bitstring = (if not(v_334) then catch-fail((if v_336 then (if v_337 then hmac(tls_h,early_secret_21,x_80) else fail-any) else fail-any)) else caught-fail) in
                        {1490}let v_338: bool = not-caught-fail(extra_18) in
                        {1479}let gxy_9: element = (if not(v_334) then catch-fail(dh_decap_fun(g_15,gy_srv_1,i_x_3)) else caught-fail) in
                        {1480}let v_335: bool = not-caught-fail(gxy_9) in
                        {1482}let i_gxy_2: element = (if not(v_334) then (if v_335 then gxy_9 else dh_f(s_40)) else caught-fail) in
                        {1491}let i_handshake_secret_2: bitstring = (if not(v_334) then catch-fail((if v_338 then hmac(tls_h,extra_18,i_gxy_2) else fail-any)) else caught-fail) in
                        {1492}let v_339: bool = not-caught-fail(i_handshake_secret_2) in
                        {1493}let SH_ECHConf_2: msg = (if v_339 then SH(B32(sr24_2,zero8),mode_6) else caught-fail) in
                        {1448}let i_cur_log_3: bitstring = (zero,i_client_hello_4) in
                        {1495}let m_31: bitstring = (if v_339 then (i_cur_log_3,SH_ECHConf_2) else caught-fail) in
                        {1496}let h_65: bitstring = (if v_339 then catch-fail(hash(tls_h,m_31)) else caught-fail) in
                        {1497}let v_340: bool = not-caught-fail(h_65) in
                        {1494}let l_74: label = (if v_339 then ech_accept_confirmation else caught-fail) in
                        {1498}let x_81: bitstring = (if v_340 then (l_74,h_65) else caught-fail) in
                        {1499}let accept_confirmation_2: bitstring = (if v_339 then catch-fail((if v_340 then hmac(tls_h,i_handshake_secret_2,x_81) else fail-any)) else caught-fail) in
                        {1500}let v_341: bool = not-caught-fail(accept_confirmation_2) in
                        {1501}let is_accepted_1: bool = (if v_334 then false else (if v_339 then (if v_341 then (sr8_2 = crop_into_bytes8(accept_confirmation_2)) else fail-any) else fail-any)) in
                        {1505}new s_41[]: seed;
                        {1519}new s_42[]: seed;
                        {1502}let v_342: bool = is_accepted_1 in
                        {1521}let psk_36: preSharedKey = (if not(v_342) then NoPSK else caught-fail) in
                        {1523}let k_26: bitstring = (if not(v_342) then catch-fail(psk2b(psk_36)) else caught-fail) in
                        {1524}let v_349: bool = not-caught-fail(k_26) in
                        {1522}let s_43: bitstring = (if not(v_342) then zero else caught-fail) in
                        {1525}let early_secret_22: bitstring = (if not(v_342) then catch-fail((if v_349 then hmac(tls_h,s_43,k_26) else fail-any)) else caught-fail) in
                        {1526}let v_350: bool = not-caught-fail(early_secret_22) in
                        {1528}let m_33: bitstring = (if v_350 then zero else caught-fail) in
                        {1529}let h_67: bitstring = (if v_350 then catch-fail(hash(tls_h,m_33)) else caught-fail) in
                        {1530}let v_351: bool = not-caught-fail(h_67) in
                        {1527}let l_76: label = (if v_350 then tls13_resumption_psk_binder_key else caught-fail) in
                        {1531}let x_83: bitstring = (if v_351 then (l_76,h_67) else caught-fail) in
                        {1532}let binder_key_16: bitstring = (if v_350 then catch-fail((if v_351 then hmac(tls_h,early_secret_22,x_83) else fail-any)) else caught-fail) in
                        {1533}let v_352: bool = not-caught-fail(binder_key_16) in
                        {1534}let v_353: bitstring = (if not(v_342) then catch-fail((if v_350 then (if v_352 then (early_secret_22,binder_key_16) else fail-any) else fail-any)) else caught-fail) in
                        {1535}let v_354: bool = (not-caught-fail(v_353) && success?(1-proj-2-tuple(v_353))) in
                        {1536}let kb_16: mac_key = (if v_354 then 2-proj-2-tuple(v_353) else caught-fail) in
                        {1537}let es_22: bitstring = (if v_354 then 1-proj-2-tuple(v_353) else caught-fail) in
                        {1539}let m_34: bitstring = (if v_354 then catch-fail(hash(tls_h,zero)) else caught-fail) in
                        {1540}let v_355: bool = not-caught-fail(m_34) in
                        {1541}let h_68: bitstring = (if v_355 then catch-fail(hash(tls_h,m_34)) else caught-fail) in
                        {1542}let v_356: bool = not-caught-fail(h_68) in
                        {1538}let l_77: label = (if v_354 then tls13_derived else caught-fail) in
                        {1543}let x_84: bitstring = (if v_356 then (l_77,h_68) else caught-fail) in
                        {1544}let extra_20: bitstring = (if v_354 then catch-fail((if v_355 then (if v_356 then hmac(tls_h,es_22,x_84) else fail-any) else fail-any)) else caught-fail) in
                        {1545}let v_357: bool = not-caught-fail(extra_20) in
                        {1517}let gxy_11: element = (if not(v_342) then catch-fail(dh_decap_fun(g_15,gy_srv_1,o_x_3)) else caught-fail) in
                        {1518}let v_348: bool = not-caught-fail(gxy_11) in
                        {1520}let o_gxy_1: element = (if not(v_342) then (if v_348 then gxy_11 else dh_f(s_42)) else caught-fail) in
                        {1508}let m_32: bitstring = (if v_342 then catch-fail(hash(tls_h,zero)) else caught-fail) in
                        {1509}let v_344: bool = not-caught-fail(m_32) in
                        {1510}let h_66: bitstring = (if v_344 then catch-fail(hash(tls_h,m_32)) else caught-fail) in
                        {1511}let v_345: bool = not-caught-fail(h_66) in
                        {1507}let l_75: label = (if v_342 then tls13_derived else caught-fail) in
                        {1512}let x_82: bitstring = (if v_345 then (l_75,h_66) else caught-fail) in
                        {1513}let extra_19: bitstring = (if v_342 then catch-fail((if v_344 then (if v_345 then hmac(tls_h,early_secret_21,x_82) else fail-any) else fail-any)) else caught-fail) in
                        {1514}let v_346: bool = not-caught-fail(extra_19) in
                        {1503}let gxy_10: element = (if v_342 then catch-fail(dh_decap_fun(g_15,gy_srv_1,i_x_3)) else caught-fail) in
                        {1504}let v_343: bool = not-caught-fail(gxy_10) in
                        {1506}let i_gxy_3: element = (if v_342 then (if v_343 then gxy_10 else dh_f(s_41)) else caught-fail) in
                        {1515}let i_handshake_secret_3: bitstring = (if v_342 then catch-fail((if v_346 then hmac(tls_h,extra_19,i_gxy_3) else fail-any)) else caught-fail) in
                        {1516}let v_347: bool = not-caught-fail(i_handshake_secret_3) in
                        {1449}let o_cur_log_1: bitstring = (zero,o_client_hello_1) in
                        {1546}let (cr_14: bytes32,handshake_secret_4: bitstring,s_dom_15: domain,cur_log_10: bitstring) = (if v_342 then (if v_347 then (i_cr_3,i_handshake_secret_3,s_dom_14,(i_cur_log_3,server_hello_3)) else fail-any) else (if v_354 then (o_cr_3,(if v_357 then hmac(tls_h,extra_20,o_gxy_1) else fail-any),o_dom_6,(o_cur_log_1,server_hello_3)) else fail-any)) in
                        {1548}let m_35: bitstring = catch-fail(hash(tls_h,zero)) in
                        {1549}let v_358: bool = not-caught-fail(m_35) in
                        {1550}let h_69: bitstring = (if v_358 then catch-fail(hash(tls_h,m_35)) else caught-fail) in
                        {1551}let v_359: bool = not-caught-fail(h_69) in
                        {1547}let l_78: label = tls13_derived in
                        {1552}let x_85: bitstring = (if v_359 then (l_78,h_69) else caught-fail) in
                        {1553}let extra_21: bitstring = catch-fail((if v_358 then (if v_359 then hmac(tls_h,handshake_secret_4,x_85) else fail-any) else fail-any)) in
                        {1554}let v_360: bool = not-caught-fail(extra_21) in
                        {1555}let k_27: bitstring = (if v_360 then zero else caught-fail) in
                        {1556}let master_secret_15: bitstring = (if v_360 then catch-fail(hmac(tls_h,handshake_secret_4,k_27)) else caught-fail) in
                        {1557}let v_361: bool = not-caught-fail(master_secret_15) in
                        {1559}let h_70: bitstring = (if v_361 then catch-fail(hash(tls_h,cur_log_10)) else caught-fail) in
                        {1560}let v_362: bool = not-caught-fail(h_70) in
                        {1558}let l_79: label = (if v_361 then tls13_client_handshake_traffic_secret else caught-fail) in
                        {1561}let x_86: bitstring = (if v_362 then (l_79,h_70) else caught-fail) in
                        {1562}let client_hts_4: bitstring = (if v_361 then catch-fail((if v_362 then hmac(tls_h,handshake_secret_4,x_86) else fail-any)) else caught-fail) in
                        {1563}let v_363: bool = not-caught-fail(client_hts_4) in
                        {1565}let h_71: bitstring = (if v_363 then catch-fail(hash(tls_h,cur_log_10)) else caught-fail) in
                        {1566}let v_364: bool = not-caught-fail(h_71) in
                        {1564}let l_80: label = (if v_363 then tls13_server_handshake_traffic_secret else caught-fail) in
                        {1567}let x_87: bitstring = (if v_364 then (l_80,h_71) else caught-fail) in
                        {1568}let server_hts_4: bitstring = (if v_363 then catch-fail((if v_364 then hmac(tls_h,handshake_secret_4,x_87) else fail-any)) else caught-fail) in
                        {1569}let v_365: bool = not-caught-fail(server_hts_4) in
                        {1571}let h_72: bitstring = (if v_365 then zero else caught-fail) in
                        {1570}let l_81: label = (if v_365 then tls13_key else caught-fail) in
                        {1572}let x_88: bitstring = (if v_365 then (l_81,h_72) else caught-fail) in
                        {1573}let client_wkh_4: bitstring = (if v_365 then catch-fail(hmac(tls_h,client_hts_4,x_88)) else caught-fail) in
                        {1574}let v_366: bool = not-caught-fail(client_wkh_4) in
                        {1576}let h_73: bitstring = (if v_366 then zero else caught-fail) in
                        {1575}let l_82: label = (if v_366 then tls13_key else caught-fail) in
                        {1577}let x_89: bitstring = (if v_366 then (l_82,h_73) else caught-fail) in
                        {1578}let server_wkh_4: bitstring = (if v_366 then catch-fail(hmac(tls_h,server_hts_4,x_89)) else caught-fail) in
                        {1579}let v_367: bool = not-caught-fail(server_wkh_4) in
                        {1581}let h_74: bitstring = (if v_367 then zero else caught-fail) in
                        {1580}let l_83: label = (if v_367 then tls13_finished else caught-fail) in
                        {1582}let x_90: bitstring = (if v_367 then (l_83,h_74) else caught-fail) in
                        {1583}let client_fk_4: bitstring = (if v_367 then catch-fail(hmac(tls_h,client_hts_4,x_90)) else caught-fail) in
                        {1584}let v_368: bool = not-caught-fail(client_fk_4) in
                        {1586}let h_75: bitstring = (if v_368 then zero else caught-fail) in
                        {1585}let l_84: label = (if v_368 then tls13_finished else caught-fail) in
                        {1587}let x_91: bitstring = (if v_368 then (l_84,h_75) else caught-fail) in
                        {1588}let server_fk_4: bitstring = (if v_368 then catch-fail(hmac(tls_h,server_hts_4,x_91)) else caught-fail) in
                        {1589}let v_369: bool = not-caught-fail(server_fk_4) in
                        {1590}let (master_secret_16: bitstring,chk_11: aead_key,shk_11: aead_key,cfin_11: mac_key,sfin_11: mac_key) = (if v_360 then (if v_361 then (if v_363 then (if v_365 then (if v_366 then (if v_367 then (if v_368 then (if v_369 then (master_secret_15,client_wkh_4,server_wkh_4,client_fk_4,server_fk_4) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) else fail-any) in
                        {1446}let id_client_10: idProc = id_client_9 in
                        {1591}event SanityClientSH(id_client_10,cr_14,B32(sr24_2,sr8_2),c_dom_7,s_dom_15,handshake_secret_4,psk_35,cur_log_10);
                        {1592}if (is_accepted_1 || (psk_ext_13 = empty_psk_ext)) then
                        (
                            {1594}in(io, enc_ee_msg_3: bitstring);
                            {1595}let ee_msg_4: msg = aead_dec(tls_a,shk_11,zero,zero,enc_ee_msg_3) in
                            {1596}let EE(x_92: bitstring) = ee_msg_4 in
                            {1597}let v_370: bool = not(is_accepted_1) in
                            {1598}let v_371: bitstring = (if v_370 then catch-fail(x_92) else caught-fail) in
                            {1599}let v_372: bool = (not-caught-fail(v_371) && success?(1-proj-server_ECH(v_371))) in
                            {1600}let ech_conf_4: echConfig = (if v_372 then 1-proj-server_ECH(v_371) else caught-fail) in
                            {1602}let cur_log2_10: bitstring = (cur_log_10,ee_msg_4) in
                            {1593}let sr_14: bytes32 = B32(sr24_2,sr8_2) in
                            {1603}out(ch_client_after_EE, (id_client_10,cr_14,sr_14,tls_h,tls_a,c_dom_7,s_dom_15,psk_35,master_secret_16,chk_11,shk_11,cfin_11,sfin_11,cur_log2_10))
                        )
                        else
                            {1604}out(io, illegal_parameter)
                    )
                    else
                        {1605}out(io, illegal_parameter)
                )
                else
                    {1606}out(io, illegal_parameter)
        )
        else
            {1607}out(io, unexpected_message)
    )
)

Declared: select mess2(ch_server_SH[],*x_93,ch_server_SH[],*x')/3000
Declared: select mess2(ch_server_CRT[],*x_93,ch_server_CRT[],*x')/3000
Declared: select mess2(ch_server_FIN[],*x_93,ch_server_FIN[],*x')/3000
Declared: select mess2(ch_server_CFIN[],*x_93,ch_server_CFIN[],*x')/3000
Declared: select mess2(ch_client_after_EE[],*x_93,ch_client_after_EE[],*x')/3000
Declared: select mess2(ch_client_CRT[],*x_93,ch_client_CRT[],*x')/3000
Declared: select mess2(ch_client_FIN[],*x_93,ch_client_FIN[],*x')/3000
Declared: select mess2(ch_client_CFIN[],*x_93,ch_client_CFIN[],*x')/3000
Declared: select table2(ech_configurations(*config_3,*skR_4),ech_configurations(*config',*skR'_4))/5000
Declared: select table2(long_term_keys(*c_dom_8,*sk_d_1,*pkr,*crt_5),long_term_keys(*c_dom'_5,*sk_d',*pkr',*crt'))/5000
Declared: select table2(pre_shared_keys(*c_dom_8,*s_dom_16,*h_76,*id_16,*x_93),pre_shared_keys(*c_dom'_5,*s_dom'_5,*h',*id',*x'))/5000
-- Restriction event(Same(choice[x_93,x'])) ==> x_93 = x' encoded as event2(Same(x_93),Same(x')) ==> x_93 = x' in biprocess 1.
-- Axiom event(PreciseMess(ch,choice[id_16,id2_1],choice[st1,st2],choice[x1,x2])) && event(PreciseMess(ch,choice[id_16,id2'],choice[st1',st2'],choice[x1',x2'])) ==> st1 = st1' && x1 = x1'; event(PreciseMess(ch,choice[id1_1,id_16],choice[st1,st2],choice[x1,x2])) && event(PreciseMess(ch,choice[id1',id_16],choice[st1',st2'],choice[x1',x2'])) ==> st2 = st2' && x2 = x2'; event(PreciseMess(ch,choice[id1_1,id2_1],choice[st_4,st2],choice[x1,x2])) && event(PreciseMess(ch,choice[id1',id2'],choice[st_4,st2'],choice[x1',x2'])) ==> id1_1 = id1' && x1 = x1'; event(PreciseMess(ch,choice[id1_1,id2_1],choice[st1,st_4],choice[x1,x2])) && event(PreciseMess(ch,choice[id1',id2'],choice[st1',st_4],choice[x1',x2'])) ==> id2_1 = id2' && x2 = x2'
Encoding: 
axiom event(PreciseMess(ch,choice[id_16,id2_1],choice[st1,st2],choice[x1,x2])) && event(PreciseMess(ch,choice[id_16,id2'],choice[st1',st2'],choice[x1',x2'])) ==> st1 = st1' && x1 = x1' encoded as event2(PreciseMess(ch,id_16,st1,x1),PreciseMess(ch,id2_1,st2,x2)) && event2(PreciseMess(ch,id_16,st1',x1'),PreciseMess(ch,id2',st2',x2')) ==> st1 = st1' && x1 = x1'
axiom event(PreciseMess(ch,choice[id1_1,id_16],choice[st1,st2],choice[x1,x2])) && event(PreciseMess(ch,choice[id1',id_16],choice[st1',st2'],choice[x1',x2'])) ==> st2 = st2' && x2 = x2' encoded as event2(PreciseMess(ch,id1_1,st1,x1),PreciseMess(ch,id_16,st2,x2)) && event2(PreciseMess(ch,id1',st1',x1'),PreciseMess(ch,id_16,st2',x2')) ==> st2 = st2' && x2 = x2'
axiom event(PreciseMess(ch,choice[id1_1,id2_1],choice[st_4,st2],choice[x1,x2])) && event(PreciseMess(ch,choice[id1',id2'],choice[st_4,st2'],choice[x1',x2'])) ==> id1_1 = id1' && x1 = x1' encoded as event2(PreciseMess(ch,id1_1,st_4,x1),PreciseMess(ch,id2_1,st2,x2)) && event2(PreciseMess(ch,id1',st_4,x1'),PreciseMess(ch,id2',st2',x2')) ==> id1_1 = id1' && x1 = x1'
axiom event(PreciseMess(ch,choice[id1_1,id2_1],choice[st1,st_4],choice[x1,x2])) && event(PreciseMess(ch,choice[id1',id2'],choice[st1',st_4],choice[x1',x2'])) ==> id2_1 = id2' && x2 = x2' encoded as event2(PreciseMess(ch,id1_1,st1,x1),PreciseMess(ch,id2_1,st_4,x2)) && event2(PreciseMess(ch,id1',st1',x1'),PreciseMess(ch,id2',st_4,x2')) ==> id2_1 = id2' && x2 = x2'
in biprocess 1.
-- Restriction event(Selected_lgt(choice[c_dom1_1,c_dom1'],choice[c_dom2_1,c_dom2'],choice[sk_2,sk'],choice[spkey,spkey'],choice[crt_5,crt'])) ==> c_dom1_1 = c_dom2_1 && c_dom1' = c_dom2' && ((c_dom1_1 = c_dom1' && sk_2 = sk' && spkey = spkey' && crt_5 = crt') || c_dom1_1 ≠ c_dom1') encoded as event2(Selected_lgt(c_dom1_1,c_dom2_1,sk_2,spkey,crt_5),Selected_lgt(c_dom1',c_dom2',sk',spkey',crt')) ==> c_dom1_1 = c_dom2_1 && c_dom1' = c_dom2' && ((c_dom1_1 = c_dom1' && sk_2 = sk' && spkey = spkey' && crt_5 = crt') || c_dom1_1 ≠ c_dom1') in biprocess 1.
-- Restriction event(Selected_psk(choice[c_dom1_1,c_dom1'],choice[c_dom2_1,c_dom2'],choice[s_dom1_1,s_dom1'],choice[s_dom2_1,s_dom2'],choice[id_16,id'],choice[ipsk,ipsk'])) ==> s_dom1_1 = s_dom2_1 && s_dom1' = s_dom2' && c_dom1_1 = c_dom2_1 && c_dom1' = c_dom2' && s_dom1_1 = s_dom1' && ((c_dom1_1 = c_dom1' && id_16 = id' && ipsk = ipsk') || c_dom1_1 ≠ c_dom1') encoded as event2(Selected_psk(c_dom1_1,c_dom2_1,s_dom1_1,s_dom2_1,id_16,ipsk),Selected_psk(c_dom1',c_dom2',s_dom1',s_dom2',id',ipsk')) ==> s_dom1_1 = s_dom2_1 && s_dom1' = s_dom2' && c_dom1_1 = c_dom2_1 && c_dom1' = c_dom2' && s_dom1_1 = s_dom1' && ((c_dom1_1 = c_dom1' && id_16 = id' && ipsk = ipsk') || c_dom1_1 ≠ c_dom1') in biprocess 1.
-- Diff-equivalence in biprocess 1.
Translating the process into Horn clauses...
Termination warning: v_373 ≠ v_374 && attacker2(v_375,v_373) && attacker2(v_375,v_374) -> bad
Selecting 0
Termination warning: v_373 ≠ v_374 && attacker2(v_373,v_375) && attacker2(v_374,v_375) -> bad
Selecting 0
Completing...
200 rules inserted. Base: 200 rules (86 with conclusion selected). Queue: 7850 rules.
Termination warning: v_373 ≠ v_374 && attacker2(v_375,v_373) && attacker2(v_375,v_374) -> bad
Selecting 0
Termination warning: v_373 ≠ v_374 && attacker2(v_373,v_375) && attacker2(v_374,v_375) -> bad
Selecting 0
400 rules inserted. Base: 400 rules (119 with conclusion selected). Queue: 7748 rules.
600 rules inserted. Base: 600 rules (119 with conclusion selected). Queue: 7548 rules.
800 rules inserted. Base: 800 rules (120 with conclusion selected). Queue: 7350 rules.
1000 rules inserted. Base: 1000 rules (122 with conclusion selected). Queue: 7154 rules.
1200 rules inserted. Base: 1200 rules (123 with conclusion selected). Queue: 6956 rules.
1400 rules inserted. Base: 1400 rules (123 with conclusion selected). Queue: 6756 rules.
1600 rules inserted. Base: 1600 rules (124 with conclusion selected). Queue: 6558 rules.
1800 rules inserted. Base: 1800 rules (125 with conclusion selected). Queue: 6360 rules.
2000 rules inserted. Base: 2000 rules (125 with conclusion selected). Queue: 6160 rules.
2200 rules inserted. Base: 2200 rules (125 with conclusion selected). Queue: 5960 rules.
2400 rules inserted. Base: 2400 rules (125 with conclusion selected). Queue: 5760 rules.
2600 rules inserted. Base: 2600 rules (125 with conclusion selected). Queue: 5560 rules.
2800 rules inserted. Base: 2800 rules (125 with conclusion selected). Queue: 5360 rules.
3000 rules inserted. Base: 3000 rules (125 with conclusion selected). Queue: 5160 rules.
3200 rules inserted. Base: 3200 rules (125 with conclusion selected). Queue: 4960 rules.
3400 rules inserted. Base: 3400 rules (125 with conclusion selected). Queue: 4760 rules.
3600 rules inserted. Base: 3600 rules (125 with conclusion selected). Queue: 4560 rules.
3800 rules inserted. Base: 3800 rules (125 with conclusion selected). Queue: 4360 rules.
4000 rules inserted. Base: 4000 rules (125 with conclusion selected). Queue: 4160 rules.
4200 rules inserted. Base: 4200 rules (125 with conclusion selected). Queue: 3960 rules.
4400 rules inserted. Base: 4400 rules (125 with conclusion selected). Queue: 3760 rules.
4600 rules inserted. Base: 4600 rules (125 with conclusion selected). Queue: 3560 rules.
4800 rules inserted. Base: 4800 rules (125 with conclusion selected). Queue: 3360 rules.
5000 rules inserted. Base: 5000 rules (125 with conclusion selected). Queue: 3160 rules.
5200 rules inserted. Base: 5200 rules (125 with conclusion selected). Queue: 2960 rules.
5400 rules inserted. Base: 5400 rules (125 with conclusion selected). Queue: 2760 rules.
5600 rules inserted. Base: 5600 rules (125 with conclusion selected). Queue: 2560 rules.
5800 rules inserted. Base: 5800 rules (125 with conclusion selected). Queue: 2360 rules.
6000 rules inserted. Base: 6000 rules (125 with conclusion selected). Queue: 2160 rules.
6200 rules inserted. Base: 6200 rules (125 with conclusion selected). Queue: 1960 rules.
6400 rules inserted. Base: 6400 rules (125 with conclusion selected). Queue: 1760 rules.
6600 rules inserted. Base: 6600 rules (136 with conclusion selected). Queue: 1707 rules.
6800 rules inserted. Base: 6800 rules (136 with conclusion selected). Queue: 1907 rules.
7000 rules inserted. Base: 6998 rules (137 with conclusion selected). Queue: 1809 rules.
7200 rules inserted. Base: 7198 rules (137 with conclusion selected). Queue: 1681 rules.
7400 rules inserted. Base: 7398 rules (137 with conclusion selected). Queue: 1511 rules.
7600 rules inserted. Base: 7598 rules (137 with conclusion selected). Queue: 1311 rules.
7800 rules inserted. Base: 7797 rules (140 with conclusion selected). Queue: 1133 rules.
8000 rules inserted. Base: 7997 rules (140 with conclusion selected). Queue: 935 rules.
8200 rules inserted. Base: 8197 rules (140 with conclusion selected). Queue: 753 rules.
8400 rules inserted. Base: 8371 rules (147 with conclusion selected). Queue: 566 rules.
8600 rules inserted. Base: 8571 rules (147 with conclusion selected). Queue: 370 rules.
8800 rules inserted. Base: 8770 rules (176 with conclusion selected). Queue: 297 rules.
9000 rules inserted. Base: 8969 rules (206 with conclusion selected). Queue: 1306 rules.
9200 rules inserted. Base: 9161 rules (228 with conclusion selected). Queue: 1309 rules.
9400 rules inserted. Base: 9361 rules (228 with conclusion selected). Queue: 1162 rules.
9600 rules inserted. Base: 9561 rules (228 with conclusion selected). Queue: 1015 rules.
9800 rules inserted. Base: 9761 rules (228 with conclusion selected). Queue: 861 rules.
10000 rules inserted. Base: 9961 rules (228 with conclusion selected). Queue: 668 rules.
10200 rules inserted. Base: 10157 rules (228 with conclusion selected). Queue: 588 rules.
10400 rules inserted. Base: 10347 rules (243 with conclusion selected). Queue: 587 rules.
10600 rules inserted. Base: 10539 rules (259 with conclusion selected). Queue: 604 rules.
10800 rules inserted. Base: 10735 rules (269 with conclusion selected). Queue: 629 rules.
11000 rules inserted. Base: 10928 rules (278 with conclusion selected). Queue: 667 rules.
11200 rules inserted. Base: 11120 rules (278 with conclusion selected). Queue: 621 rules.
11400 rules inserted. Base: 11300 rules (278 with conclusion selected). Queue: 575 rules.
11600 rules inserted. Base: 11489 rules (301 with conclusion selected). Queue: 588 rules.
11800 rules inserted. Base: 11671 rules (303 with conclusion selected). Queue: 580 rules.
12000 rules inserted. Base: 11841 rules (305 with conclusion selected). Queue: 584 rules.
12200 rules inserted. Base: 12018 rules (317 with conclusion selected). Queue: 596 rules.
12400 rules inserted. Base: 12204 rules (331 with conclusion selected). Queue: 597 rules.
12600 rules inserted. Base: 12366 rules (345 with conclusion selected). Queue: 621 rules.
12800 rules inserted. Base: 12551 rules (351 with conclusion selected). Queue: 625 rules.
13000 rules inserted. Base: 12710 rules (359 with conclusion selected). Queue: 638 rules.
13200 rules inserted. Base: 12875 rules (367 with conclusion selected). Queue: 652 rules.
13400 rules inserted. Base: 13055 rules (369 with conclusion selected). Queue: 694 rules.
13600 rules inserted. Base: 13230 rules (376 with conclusion selected). Queue: 743 rules.
13800 rules inserted. Base: 13391 rules (382 with conclusion selected). Queue: 746 rules.
14000 rules inserted. Base: 13568 rules (396 with conclusion selected). Queue: 770 rules.
14200 rules inserted. Base: 13756 rules (438 with conclusion selected). Queue: 944 rules.
14400 rules inserted. Base: 13933 rules (441 with conclusion selected). Queue: 936 rules.
14600 rules inserted. Base: 14107 rules (446 with conclusion selected). Queue: 954 rules.
14800 rules inserted. Base: 14286 rules (454 with conclusion selected). Queue: 945 rules.
15000 rules inserted. Base: 14458 rules (470 with conclusion selected). Queue: 981 rules.
15200 rules inserted. Base: 14622 rules (487 with conclusion selected). Queue: 1014 rules.
15400 rules inserted. Base: 14801 rules (508 with conclusion selected). Queue: 1050 rules.
15600 rules inserted. Base: 14972 rules (509 with conclusion selected). Queue: 1014 rules.
15800 rules inserted. Base: 15146 rules (510 with conclusion selected). Queue: 981 rules.
16000 rules inserted. Base: 15346 rules (519 with conclusion selected). Queue: 975 rules.
16200 rules inserted. Base: 15487 rules (526 with conclusion selected). Queue: 963 rules.
16400 rules inserted. Base: 15651 rules (534 with conclusion selected). Queue: 952 rules.
16600 rules inserted. Base: 15805 rules (538 with conclusion selected). Queue: 1026 rules.
16800 rules inserted. Base: 15972 rules (538 with conclusion selected). Queue: 949 rules.
17000 rules inserted. Base: 16172 rules (538 with conclusion selected). Queue: 899 rules.
17200 rules inserted. Base: 16303 rules (539 with conclusion selected). Queue: 866 rules.
17400 rules inserted. Base: 16464 rules (542 with conclusion selected). Queue: 801 rules.
17600 rules inserted. Base: 16547 rules (542 with conclusion selected). Queue: 729 rules.
17800 rules inserted. Base: 16721 rules (544 with conclusion selected). Queue: 736 rules.
18000 rules inserted. Base: 16865 rules (544 with conclusion selected). Queue: 728 rules.
18200 rules inserted. Base: 17000 rules (544 with conclusion selected). Queue: 720 rules.
18400 rules inserted. Base: 17149 rules (556 with conclusion selected). Queue: 740 rules.
18600 rules inserted. Base: 17332 rules (556 with conclusion selected). Queue: 715 rules.
18800 rules inserted. Base: 17432 rules (567 with conclusion selected). Queue: 769 rules.
19000 rules inserted. Base: 17525 rules (568 with conclusion selected). Queue: 787 rules.
19200 rules inserted. Base: 17691 rules (576 with conclusion selected). Queue: 814 rules.
19400 rules inserted. Base: 17847 rules (582 with conclusion selected). Queue: 840 rules.
19600 rules inserted. Base: 18011 rules (594 with conclusion selected). Queue: 840 rules.
19800 rules inserted. Base: 18157 rules (600 with conclusion selected). Queue: 902 rules.
20000 rules inserted. Base: 18332 rules (612 with conclusion selected). Queue: 855 rules.
20200 rules inserted. Base: 18496 rules (615 with conclusion selected). Queue: 865 rules.
20400 rules inserted. Base: 18678 rules (629 with conclusion selected). Queue: 836 rules.
20600 rules inserted. Base: 18843 rules (633 with conclusion selected). Queue: 809 rules.
20800 rules inserted. Base: 19016 rules (633 with conclusion selected). Queue: 762 rules.
21000 rules inserted. Base: 19172 rules (634 with conclusion selected). Queue: 776 rules.
21200 rules inserted. Base: 19343 rules (643 with conclusion selected). Queue: 786 rules.
21400 rules inserted. Base: 19493 rules (657 with conclusion selected). Queue: 850 rules.
21600 rules inserted. Base: 19641 rules (662 with conclusion selected). Queue: 854 rules.
21800 rules inserted. Base: 19825 rules (663 with conclusion selected). Queue: 829 rules.
22000 rules inserted. Base: 19967 rules (664 with conclusion selected). Queue: 790 rules.
22200 rules inserted. Base: 20127 rules (664 with conclusion selected). Queue: 710 rules.
22400 rules inserted. Base: 20253 rules (668 with conclusion selected). Queue: 681 rules.
22600 rules inserted. Base: 20415 rules (668 with conclusion selected). Queue: 633 rules.
22800 rules inserted. Base: 20560 rules (673 with conclusion selected). Queue: 634 rules.
23000 rules inserted. Base: 20691 rules (684 with conclusion selected). Queue: 739 rules.
23200 rules inserted. Base: 20837 rules (695 with conclusion selected). Queue: 732 rules.
23400 rules inserted. Base: 20976 rules (699 with conclusion selected). Queue: 738 rules.
23600 rules inserted. Base: 21120 rules (707 with conclusion selected). Queue: 725 rules.
23800 rules inserted. Base: 21291 rules (711 with conclusion selected). Queue: 642 rules.
24000 rules inserted. Base: 21392 rules (716 with conclusion selected). Queue: 663 rules.
24200 rules inserted. Base: 21545 rules (739 with conclusion selected). Queue: 782 rules.
24400 rules inserted. Base: 21687 rules (748 with conclusion selected). Queue: 877 rules.
24600 rules inserted. Base: 21829 rules (755 with conclusion selected). Queue: 884 rules.
24800 rules inserted. Base: 21991 rules (757 with conclusion selected). Queue: 843 rules.
25000 rules inserted. Base: 22157 rules (761 with conclusion selected). Queue: 757 rules.
25200 rules inserted. Base: 22325 rules (763 with conclusion selected). Queue: 674 rules.
25400 rules inserted. Base: 22463 rules (763 with conclusion selected). Queue: 662 rules.
25600 rules inserted. Base: 22609 rules (763 with conclusion selected). Queue: 646 rules.
25800 rules inserted. Base: 22754 rules (771 with conclusion selected). Queue: 631 rules.
26000 rules inserted. Base: 22865 rules (771 with conclusion selected). Queue: 626 rules.
26200 rules inserted. Base: 23019 rules (771 with conclusion selected). Queue: 622 rules.
26400 rules inserted. Base: 23133 rules (771 with conclusion selected). Queue: 618 rules.
26600 rules inserted. Base: 23256 rules (771 with conclusion selected). Queue: 611 rules.
26800 rules inserted. Base: 23403 rules (771 with conclusion selected). Queue: 600 rules.
27000 rules inserted. Base: 23507 rules (771 with conclusion selected). Queue: 586 rules.
27200 rules inserted. Base: 23571 rules (771 with conclusion selected). Queue: 565 rules.
27400 rules inserted. Base: 23715 rules (771 with conclusion selected). Queue: 547 rules.
27600 rules inserted. Base: 23804 rules (779 with conclusion selected). Queue: 553 rules.
27800 rules inserted. Base: 23914 rules (791 with conclusion selected). Queue: 612 rules.
28000 rules inserted. Base: 24022 rules (798 with conclusion selected). Queue: 611 rules.
28200 rules inserted. Base: 24048 rules (799 with conclusion selected). Queue: 582 rules.
28400 rules inserted. Base: 24176 rules (807 with conclusion selected). Queue: 598 rules.
28600 rules inserted. Base: 24311 rules (819 with conclusion selected). Queue: 603 rules.
28800 rules inserted. Base: 24385 rules (831 with conclusion selected). Queue: 657 rules.
29000 rules inserted. Base: 24538 rules (841 with conclusion selected). Queue: 631 rules.
29200 rules inserted. Base: 24689 rules (855 with conclusion selected). Queue: 624 rules.
29400 rules inserted. Base: 24803 rules (873 with conclusion selected). Queue: 670 rules.
29600 rules inserted. Base: 24959 rules (879 with conclusion selected). Queue: 684 rules.
29800 rules inserted. Base: 25097 rules (885 with conclusion selected). Queue: 705 rules.
30000 rules inserted. Base: 25260 rules (905 with conclusion selected). Queue: 659 rules.
30200 rules inserted. Base: 25429 rules (925 with conclusion selected). Queue: 621 rules.
30400 rules inserted. Base: 25581 rules (925 with conclusion selected). Queue: 599 rules.
30600 rules inserted. Base: 25749 rules (931 with conclusion selected). Queue: 601 rules.
30800 rules inserted. Base: 25923 rules (931 with conclusion selected). Queue: 589 rules.
31000 rules inserted. Base: 26074 rules (931 with conclusion selected). Queue: 571 rules.
31200 rules inserted. Base: 26210 rules (931 with conclusion selected). Queue: 541 rules.
31400 rules inserted. Base: 26342 rules (931 with conclusion selected). Queue: 523 rules.
31600 rules inserted. Base: 26504 rules (936 with conclusion selected). Queue: 523 rules.
31800 rules inserted. Base: 26637 rules (938 with conclusion selected). Queue: 498 rules.
32000 rules inserted. Base: 26736 rules (942 with conclusion selected). Queue: 497 rules.
32200 rules inserted. Base: 26917 rules (942 with conclusion selected). Queue: 479 rules.
32400 rules inserted. Base: 27040 rules (944 with conclusion selected). Queue: 461 rules.
32600 rules inserted. Base: 27210 rules (944 with conclusion selected). Queue: 441 rules.
32800 rules inserted. Base: 27266 rules (944 with conclusion selected). Queue: 442 rules.
33000 rules inserted. Base: 27379 rules (944 with conclusion selected). Queue: 440 rules.
33200 rules inserted. Base: 27529 rules (944 with conclusion selected). Queue: 434 rules.
33400 rules inserted. Base: 27681 rules (966 with conclusion selected). Queue: 534 rules.
33600 rules inserted. Base: 27794 rules (970 with conclusion selected). Queue: 545 rules.
33800 rules inserted. Base: 27895 rules (970 with conclusion selected). Queue: 519 rules.
34000 rules inserted. Base: 28064 rules (970 with conclusion selected). Queue: 495 rules.
34200 rules inserted. Base: 28220 rules (1014 with conclusion selected). Queue: 670 rules.
34400 rules inserted. Base: 28372 rules (1022 with conclusion selected). Queue: 694 rules.
34600 rules inserted. Base: 28538 rules (1023 with conclusion selected). Queue: 686 rules.
34800 rules inserted. Base: 28722 rules (1023 with conclusion selected). Queue: 620 rules.
35000 rules inserted. Base: 28892 rules (1023 with conclusion selected). Queue: 576 rules.
35200 rules inserted. Base: 29051 rules (1023 with conclusion selected). Queue: 574 rules.
35400 rules inserted. Base: 29211 rules (1023 with conclusion selected). Queue: 580 rules.
35600 rules inserted. Base: 29360 rules (1023 with conclusion selected). Queue: 578 rules.
35800 rules inserted. Base: 29537 rules (1023 with conclusion selected). Queue: 585 rules.
36000 rules inserted. Base: 29701 rules (1023 with conclusion selected). Queue: 581 rules.
36200 rules inserted. Base: 29854 rules (1023 with conclusion selected). Queue: 577 rules.
36400 rules inserted. Base: 29969 rules (1023 with conclusion selected). Queue: 576 rules.
36600 rules inserted. Base: 30133 rules (1023 with conclusion selected). Queue: 576 rules.
36800 rules inserted. Base: 30281 rules (1023 with conclusion selected). Queue: 576 rules.
37000 rules inserted. Base: 30417 rules (1023 with conclusion selected). Queue: 591 rules.
37200 rules inserted. Base: 30578 rules (1023 with conclusion selected). Queue: 591 rules.
37400 rules inserted. Base: 30721 rules (1029 with conclusion selected). Queue: 601 rules.
37600 rules inserted. Base: 30887 rules (1029 with conclusion selected). Queue: 595 rules.
37800 rules inserted. Base: 31036 rules (1029 with conclusion selected). Queue: 595 rules.
38000 rules inserted. Base: 31203 rules (1041 with conclusion selected). Queue: 623 rules.
38200 rules inserted. Base: 31349 rules (1049 with conclusion selected). Queue: 628 rules.
38400 rules inserted. Base: 31474 rules (1058 with conclusion selected). Queue: 641 rules.
38600 rules inserted. Base: 31643 rules (1063 with conclusion selected). Queue: 634 rules.
38800 rules inserted. Base: 31785 rules (1065 with conclusion selected). Queue: 603 rules.
39000 rules inserted. Base: 31985 rules (1095 with conclusion selected). Queue: 650 rules.
39200 rules inserted. Base: 32145 rules (1105 with conclusion selected). Queue: 693 rules.
39400 rules inserted. Base: 32327 rules (1105 with conclusion selected). Queue: 672 rules.
39600 rules inserted. Base: 32519 rules (1109 with conclusion selected). Queue: 652 rules.
39800 rules inserted. Base: 32667 rules (1113 with conclusion selected). Queue: 632 rules.
40000 rules inserted. Base: 32792 rules (1113 with conclusion selected). Queue: 628 rules.
40200 rules inserted. Base: 32963 rules (1113 with conclusion selected). Queue: 662 rules.
40400 rules inserted. Base: 33109 rules (1113 with conclusion selected). Queue: 684 rules.
40600 rules inserted. Base: 33288 rules (1113 with conclusion selected). Queue: 686 rules.
40800 rules inserted. Base: 33455 rules (1113 with conclusion selected). Queue: 680 rules.
41000 rules inserted. Base: 33635 rules (1113 with conclusion selected). Queue: 680 rules.
41200 rules inserted. Base: 33797 rules (1117 with conclusion selected). Queue: 674 rules.
41400 rules inserted. Base: 33911 rules (1117 with conclusion selected). Queue: 668 rules.
41600 rules inserted. Base: 34087 rules (1117 with conclusion selected). Queue: 668 rules.
41800 rules inserted. Base: 34241 rules (1125 with conclusion selected). Queue: 706 rules.
42000 rules inserted. Base: 34435 rules (1161 with conclusion selected). Queue: 892 rules.
42200 rules inserted. Base: 34619 rules (1161 with conclusion selected). Queue: 886 rules.
42400 rules inserted. Base: 34799 rules (1161 with conclusion selected). Queue: 884 rules.
42600 rules inserted. Base: 34971 rules (1163 with conclusion selected). Queue: 880 rules.
42800 rules inserted. Base: 35169 rules (1163 with conclusion selected). Queue: 826 rules.
43000 rules inserted. Base: 35354 rules (1163 with conclusion selected). Queue: 812 rules.
43200 rules inserted. Base: 35524 rules (1163 with conclusion selected). Queue: 851 rules.
43400 rules inserted. Base: 35679 rules (1167 with conclusion selected). Queue: 844 rules.
43600 rules inserted. Base: 35847 rules (1167 with conclusion selected). Queue: 844 rules.
43800 rules inserted. Base: 36033 rules (1171 with conclusion selected). Queue: 842 rules.
44000 rules inserted. Base: 36198 rules (1171 with conclusion selected). Queue: 840 rules.
44200 rules inserted. Base: 36353 rules (1171 with conclusion selected). Queue: 826 rules.
44400 rules inserted. Base: 36552 rules (1171 with conclusion selected). Queue: 826 rules.
44600 rules inserted. Base: 36727 rules (1171 with conclusion selected). Queue: 814 rules.
44800 rules inserted. Base: 36875 rules (1179 with conclusion selected). Queue: 822 rules.
45000 rules inserted. Base: 37020 rules (1187 with conclusion selected). Queue: 830 rules.
45200 rules inserted. Base: 37209 rules (1187 with conclusion selected). Queue: 830 rules.
45400 rules inserted. Base: 37405 rules (1187 with conclusion selected). Queue: 826 rules.
45600 rules inserted. Base: 37589 rules (1187 with conclusion selected). Queue: 810 rules.
45800 rules inserted. Base: 37768 rules (1187 with conclusion selected). Queue: 794 rules.
46000 rules inserted. Base: 37949 rules (1187 with conclusion selected). Queue: 758 rules.
46200 rules inserted. Base: 38140 rules (1187 with conclusion selected). Queue: 752 rules.
46400 rules inserted. Base: 38307 rules (1187 with conclusion selected). Queue: 752 rules.
46600 rules inserted. Base: 38471 rules (1187 with conclusion selected). Queue: 748 rules.
46800 rules inserted. Base: 38647 rules (1187 with conclusion selected). Queue: 748 rules.
47000 rules inserted. Base: 38839 rules (1187 with conclusion selected). Queue: 730 rules.
47200 rules inserted. Base: 39023 rules (1187 with conclusion selected). Queue: 694 rules.
47400 rules inserted. Base: 39183 rules (1187 with conclusion selected). Queue: 673 rules.
47600 rules inserted. Base: 39381 rules (1187 with conclusion selected). Queue: 638 rules.
47800 rules inserted. Base: 39571 rules (1187 with conclusion selected). Queue: 630 rules.
48000 rules inserted. Base: 39749 rules (1187 with conclusion selected). Queue: 630 rules.
48200 rules inserted. Base: 39864 rules (1187 with conclusion selected). Queue: 624 rules.
48400 rules inserted. Base: 40050 rules (1187 with conclusion selected). Queue: 610 rules.
48600 rules inserted. Base: 40229 rules (1187 with conclusion selected). Queue: 562 rules.
48800 rules inserted. Base: 40347 rules (1193 with conclusion selected). Queue: 618 rules.
49000 rules inserted. Base: 40535 rules (1193 with conclusion selected). Queue: 618 rules.
49200 rules inserted. Base: 40631 rules (1194 with conclusion selected). Queue: 611 rules.
49400 rules inserted. Base: 40783 rules (1195 with conclusion selected). Queue: 615 rules.
49600 rules inserted. Base: 40983 rules (1195 with conclusion selected). Queue: 680 rules.
49800 rules inserted. Base: 41063 rules (1195 with conclusion selected). Queue: 673 rules.
50000 rules inserted. Base: 41175 rules (1195 with conclusion selected). Queue: 660 rules.
50200 rules inserted. Base: 41375 rules (1195 with conclusion selected). Queue: 660 rules.
50400 rules inserted. Base: 41551 rules (1195 with conclusion selected). Queue: 666 rules.
50600 rules inserted. Base: 41684 rules (1201 with conclusion selected). Queue: 650 rules.
50800 rules inserted. Base: 41853 rules (1201 with conclusion selected). Queue: 624 rules.
51000 rules inserted. Base: 42025 rules (1201 with conclusion selected). Queue: 624 rules.
51200 rules inserted. Base: 42139 rules (1201 with conclusion selected). Queue: 624 rules.
51400 rules inserted. Base: 42301 rules (1215 with conclusion selected). Queue: 664 rules.
51600 rules inserted. Base: 42472 rules (1217 with conclusion selected). Queue: 639 rules.
51800 rules inserted. Base: 42549 rules (1227 with conclusion selected). Queue: 560 rules.
52000 rules inserted. Base: 42735 rules (1231 with conclusion selected). Queue: 542 rules.
52200 rules inserted. Base: 42931 rules (1231 with conclusion selected). Queue: 534 rules.
52400 rules inserted. Base: 43051 rules (1259 with conclusion selected). Queue: 610 rules.
52600 rules inserted. Base: 43245 rules (1259 with conclusion selected). Queue: 613 rules.
52800 rules inserted. Base: 43445 rules (1261 with conclusion selected). Queue: 668 rules.
53000 rules inserted. Base: 43597 rules (1267 with conclusion selected). Queue: 658 rules.
53200 rules inserted. Base: 43785 rules (1267 with conclusion selected). Queue: 652 rules.
53400 rules inserted. Base: 43983 rules (1267 with conclusion selected). Queue: 652 rules.
53600 rules inserted. Base: 44181 rules (1267 with conclusion selected). Queue: 624 rules.
53800 rules inserted. Base: 44356 rules (1267 with conclusion selected). Queue: 620 rules.
54000 rules inserted. Base: 44493 rules (1267 with conclusion selected). Queue: 620 rules.
54200 rules inserted. Base: 44659 rules (1267 with conclusion selected). Queue: 618 rules.
54400 rules inserted. Base: 44781 rules (1267 with conclusion selected). Queue: 652 rules.
54600 rules inserted. Base: 44981 rules (1267 with conclusion selected). Queue: 652 rules.
54800 rules inserted. Base: 45158 rules (1267 with conclusion selected). Queue: 652 rules.
55000 rules inserted. Base: 45327 rules (1291 with conclusion selected). Queue: 732 rules.
55200 rules inserted. Base: 45523 rules (1291 with conclusion selected). Queue: 732 rules.
55400 rules inserted. Base: 45712 rules (1291 with conclusion selected). Queue: 754 rules.
55600 rules inserted. Base: 45891 rules (1291 with conclusion selected). Queue: 763 rules.
55800 rules inserted. Base: 46065 rules (1291 with conclusion selected). Queue: 718 rules.
56000 rules inserted. Base: 46265 rules (1291 with conclusion selected). Queue: 652 rules.
56200 rules inserted. Base: 46447 rules (1291 with conclusion selected). Queue: 644 rules.
56400 rules inserted. Base: 46628 rules (1291 with conclusion selected). Queue: 636 rules.
56600 rules inserted. Base: 46815 rules (1291 with conclusion selected). Queue: 636 rules.
56800 rules inserted. Base: 47002 rules (1291 with conclusion selected). Queue: 585 rules.
57000 rules inserted. Base: 47169 rules (1291 with conclusion selected). Queue: 546 rules.
57200 rules inserted. Base: 47315 rules (1291 with conclusion selected). Queue: 544 rules.
57400 rules inserted. Base: 47503 rules (1291 with conclusion selected). Queue: 546 rules.
57600 rules inserted. Base: 47666 rules (1291 with conclusion selected). Queue: 546 rules.
57800 rules inserted. Base: 47865 rules (1291 with conclusion selected). Queue: 542 rules.
58000 rules inserted. Base: 47972 rules (1291 with conclusion selected). Queue: 542 rules.
58200 rules inserted. Base: 48115 rules (1291 with conclusion selected). Queue: 542 rules.
58400 rules inserted. Base: 48315 rules (1291 with conclusion selected). Queue: 542 rules.
58600 rules inserted. Base: 48467 rules (1291 with conclusion selected). Queue: 536 rules.
58800 rules inserted. Base: 48651 rules (1301 with conclusion selected). Queue: 632 rules.
59000 rules inserted. Base: 48829 rules (1301 with conclusion selected). Queue: 632 rules.
59200 rules inserted. Base: 48959 rules (1302 with conclusion selected). Queue: 633 rules.
59400 rules inserted. Base: 49122 rules (1305 with conclusion selected). Queue: 610 rules.
59600 rules inserted. Base: 49263 rules (1305 with conclusion selected). Queue: 548 rules.
ok, secrecy assumption verified: fact unreachable attacker2(uc_privkey(s_44),x_93)
ok, secrecy assumption verified: fact unreachable attacker2(x_93,uc_privkey(s_44))
ok, secrecy assumption verified: fact unreachable attacker2(uc_psk(s_44),x_93)
ok, secrecy assumption verified: fact unreachable attacker2(x_93,uc_psk(s_44))
ok, secrecy assumption verified: fact unreachable attacker2(x_93,dh_k(s_44))
ok, secrecy assumption verified: fact unreachable attacker2(dh_k(s_44),x_93)
ok, secrecy assumption verified: fact unreachable attacker2(ch_client_CFIN[],ch_client_CFIN[])
ok, secrecy assumption verified: fact unreachable attacker2(ch_client_FIN[],ch_client_FIN[])
ok, secrecy assumption verified: fact unreachable attacker2(ch_client_CRT[],ch_client_CRT[])
ok, secrecy assumption verified: fact unreachable attacker2(ch_client_after_EE[],ch_client_after_EE[])
ok, secrecy assumption verified: fact unreachable attacker2(ch_server_CFIN[],ch_server_CFIN[])
ok, secrecy assumption verified: fact unreachable attacker2(ch_server_FIN[],ch_server_FIN[])
ok, secrecy assumption verified: fact unreachable attacker2(ch_server_CRT[],ch_server_CRT[])
ok, secrecy assumption verified: fact unreachable attacker2(ch_server_SH[],ch_server_SH[])
ok, secrecy assumption verified: fact unreachable attacker2(x_93,hmac_ideal(i,zero,uc_psk(s_44)))
ok, secrecy assumption verified: fact unreachable attacker2(hmac_ideal(i,zero,uc_psk(s_44)),x_93)
ok, secrecy assumption verified: fact unreachable attacker2(x_93,hmac_ideal(i,hmac_ideal(i,zero,uc_psk(s_44)),(tls13_resumption_psk_binder_key,hash_ideal(i,zero))))
ok, secrecy assumption verified: fact unreachable attacker2(hmac_ideal(i,hmac_ideal(i,zero,uc_psk(s_44)),(tls13_resumption_psk_binder_key,hash_ideal(i,zero))),x_93)
ok, secrecy assumption verified: fact unreachable attacker2(x_93,dh_f(s_44))
ok, secrecy assumption verified: fact unreachable attacker2(dh_f(s_44),x_93)
ok, secrecy assumption verified: fact unreachable attacker2(x_93,dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex))))
ok, secrecy assumption verified: fact unreachable attacker2(dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex))),x_93)
ok, secrecy assumption verified: fact unreachable attacker2(x_93,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,zero,uc_psk(s_44)),(tls13_derived,hash_ideal(i,hash_ideal(i,zero)))),e))
ok, secrecy assumption verified: fact unreachable attacker2(hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,zero,uc_psk(s_44)),(tls13_derived,hash_ideal(i,hash_ideal(i,zero)))),e),x_93)
ok, secrecy assumption verified: fact unreachable attacker2(x_93,hmac_ideal(i,extra_es,dh_f(s_44)))
ok, secrecy assumption verified: fact unreachable attacker2(hmac_ideal(i,extra_es,dh_f(s_44)),x_93)
ok, secrecy assumption verified: fact unreachable attacker2(x_93,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,zero,uc_psk(s_44)),(tls13_derived,hash_ideal(i,hash_ideal(i,zero)))),e),(tls13_client_handshake_traffic_secret,hash_ideal(i,log))),(tls13_key,zero)))
ok, secrecy assumption verified: fact unreachable attacker2(hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,zero,uc_psk(s_44)),(tls13_derived,hash_ideal(i,hash_ideal(i,zero)))),e),(tls13_client_handshake_traffic_secret,hash_ideal(i,log))),(tls13_key,zero)),x_93)
ok, secrecy assumption verified: fact unreachable attacker2(x_93,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,zero,uc_psk(s_44)),(tls13_derived,hash_ideal(i,hash_ideal(i,zero)))),e),(tls13_client_handshake_traffic_secret,hash_ideal(i,log))),(tls13_finished,zero)))
ok, secrecy assumption verified: fact unreachable attacker2(hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,zero,uc_psk(s_44)),(tls13_derived,hash_ideal(i,hash_ideal(i,zero)))),e),(tls13_client_handshake_traffic_secret,hash_ideal(i,log))),(tls13_finished,zero)),x_93)
ok, secrecy assumption verified: fact unreachable attacker2(x_93,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,zero,uc_psk(s_44)),(tls13_derived,hash_ideal(i,hash_ideal(i,zero)))),e),(tls13_server_handshake_traffic_secret,hash_ideal(i,log))),(tls13_key,zero)))
ok, secrecy assumption verified: fact unreachable attacker2(hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,zero,uc_psk(s_44)),(tls13_derived,hash_ideal(i,hash_ideal(i,zero)))),e),(tls13_server_handshake_traffic_secret,hash_ideal(i,log))),(tls13_key,zero)),x_93)
ok, secrecy assumption verified: fact unreachable attacker2(x_93,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,zero,uc_psk(s_44)),(tls13_derived,hash_ideal(i,hash_ideal(i,zero)))),e),(tls13_server_handshake_traffic_secret,hash_ideal(i,log))),(tls13_finished,zero)))
ok, secrecy assumption verified: fact unreachable attacker2(hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,zero,uc_psk(s_44)),(tls13_derived,hash_ideal(i,hash_ideal(i,zero)))),e),(tls13_server_handshake_traffic_secret,hash_ideal(i,log))),(tls13_finished,zero)),x_93)
ok, secrecy assumption verified: fact unreachable attacker2(t,aead_enc(a_2,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,extra_es,dh_f(s_44)),(tls13_client_handshake_traffic_secret,hash_ideal(i,log))),(tls13_key,zero)),x_93,y,z))
ok, secrecy assumption verified: fact unreachable attacker2(aead_enc(a_2,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,extra_es,dh_f(s_44)),(tls13_client_handshake_traffic_secret,hash_ideal(i,log))),(tls13_key,zero)),x_93,y,z),t)
ok, secrecy assumption verified: fact unreachable attacker2(t,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,extra_es,dh_f(s_44)),(tls13_client_handshake_traffic_secret,hash_ideal(i,log))),(tls13_finished,zero)))
ok, secrecy assumption verified: fact unreachable attacker2(hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,extra_es,dh_f(s_44)),(tls13_client_handshake_traffic_secret,hash_ideal(i,log))),(tls13_finished,zero)),t)
ok, secrecy assumption verified: fact unreachable attacker2(t,aead_enc(a_2,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,extra_es,dh_f(s_44)),(tls13_server_handshake_traffic_secret,hash_ideal(i,log))),(tls13_key,zero)),x_93,y,z))
ok, secrecy assumption verified: fact unreachable attacker2(aead_enc(a_2,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,extra_es,dh_f(s_44)),(tls13_server_handshake_traffic_secret,hash_ideal(i,log))),(tls13_key,zero)),x_93,y,z),t)
ok, secrecy assumption verified: fact unreachable attacker2(t,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,extra_es,dh_f(s_44)),(tls13_server_handshake_traffic_secret,hash_ideal(i,log))),(tls13_finished,zero)))
ok, secrecy assumption verified: fact unreachable attacker2(hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,extra_es,dh_f(s_44)),(tls13_server_handshake_traffic_secret,hash_ideal(i,log))),(tls13_finished,zero)),t)
ok, secrecy assumption verified: fact unreachable attacker2(t,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,extra_es,dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex)))),(tls13_client_handshake_traffic_secret,hash_ideal(i,((log,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex))),SH(r',nego(v',h',a',server_kex_ext(DHE_kex(id_g(StrongDH,i),dh_encap_fun(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)),dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex)))))),sn',e',p',ex')))))),(tls13_key,zero)))
ok, secrecy assumption verified: fact unreachable attacker2(hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,extra_es,dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex)))),(tls13_client_handshake_traffic_secret,hash_ideal(i,((log,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex))),SH(r',nego(v',h',a',server_kex_ext(DHE_kex(id_g(StrongDH,i),dh_encap_fun(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)),dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex)))))),sn',e',p',ex')))))),(tls13_key,zero)),t)
ok, secrecy assumption verified: fact unreachable attacker2(t,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,extra_es,dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex)))),(tls13_client_handshake_traffic_secret,hash_ideal(i,((log,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex))),SH(r',nego(v',h',a',server_kex_ext(DHE_kex(id_g(StrongDH,i),dh_encap_fun(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)),dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex)))))),sn',e',p',ex')))))),(tls13_finished,zero)))
ok, secrecy assumption verified: fact unreachable attacker2(hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,extra_es,dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex)))),(tls13_client_handshake_traffic_secret,hash_ideal(i,((log,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex))),SH(r',nego(v',h',a',server_kex_ext(DHE_kex(id_g(StrongDH,i),dh_encap_fun(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)),dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex)))))),sn',e',p',ex')))))),(tls13_finished,zero)),t)
ok, secrecy assumption verified: fact unreachable attacker2(t,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,extra_es,dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex)))),(tls13_server_handshake_traffic_secret,hash_ideal(i,((log,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex))),SH(r',nego(v',h',a',server_kex_ext(DHE_kex(id_g(StrongDH,i),dh_encap_fun(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)),dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex)))))),sn',e',p',ex')))))),(tls13_key,zero)))
ok, secrecy assumption verified: fact unreachable attacker2(hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,extra_es,dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex)))),(tls13_server_handshake_traffic_secret,hash_ideal(i,((log,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex))),SH(r',nego(v',h',a',server_kex_ext(DHE_kex(id_g(StrongDH,i),dh_encap_fun(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)),dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex)))))),sn',e',p',ex')))))),(tls13_key,zero)),t)
ok, secrecy assumption verified: fact unreachable attacker2(t,hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,extra_es,dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex)))),(tls13_server_handshake_traffic_secret,hash_ideal(i,((log,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex))),SH(r',nego(v',h',a',server_kex_ext(DHE_kex(id_g(StrongDH,i),dh_encap_fun(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)),dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex)))))),sn',e',p',ex')))))),(tls13_finished,zero)))
ok, secrecy assumption verified: fact unreachable attacker2(hmac_ideal(i,hmac_ideal(i,hmac_ideal(i,extra_es,dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex)))),(tls13_server_handshake_traffic_secret,hash_ideal(i,((log,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex))),SH(r',nego(v',h',a',server_kex_ext(DHE_kex(id_g(StrongDH,i),dh_encap_fun(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)),dh_xy(s_xy,CH(r_4,nego(v_373,h_76,a_2,client_kex_ext(DHE_kex(id_g(StrongDH,i),dh_pub(id_g(StrongDH,i),dh_k(s_x)))),sn,e,p,ex)))))),sn',e',p',ex')))))),(tls13_finished,zero)),t)
ok, secrecy assumption verified: fact unreachable attacker2(x_93,dh_xy(s',dh_pub(id_g(StrongDH,2),dh_k(s_44))))
ok, secrecy assumption verified: fact unreachable attacker2(dh_xy(s',dh_pub(id_g(StrongDH,2),dh_k(s_44))),x_93)
ok, secrecy assumption verified: fact unreachable attacker2(x_93,hmac_ideal(2,hmac_ideal(2,dh_xy(s',dh_pub(id_g(StrongDH,2),dh_k(s_44))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,info_3)))))
ok, secrecy assumption verified: fact unreachable attacker2(hmac_ideal(2,hmac_ideal(2,dh_xy(s',dh_pub(id_g(StrongDH,2),dh_k(s_44))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,info_3)))),x_93)
ok, secrecy assumption verified: fact unreachable attacker2(x_93,hmac_ideal(2,hmac_ideal(2,dh_f(s'),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,info_3)))))
ok, secrecy assumption verified: fact unreachable attacker2(hmac_ideal(2,hmac_ideal(2,dh_f(s'),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,info_3)))),x_93)
goal reachable: bad

Derivation:
Abbreviations:
s_44 = s_4[a = choice[ClientA[],ClientA[]],!1 = @sid]
rand24_7 = rand24_4[!1 = @sid_1]
rand8_7 = rand8_4[!1 = @sid_1]
s_45 = s_18[!1 = @sid_1]
id_16 = id_2[o_dom = choice[d,d],!1 = @sid_2]
s_46 = s_6[!1 = @sid_2]
s_47 = s_21[!1 = @sid_1]
rand24_8 = rand24_3[!1 = @sid_1]
rand8_8 = rand8_3[!1 = @sid_1]
s_48 = s_17[!1 = @sid_1]
@occ70_1 = @occ70[!1 = @sid_3]
sk_d_1 = sk_d[a_1 = choice[d,d],!1 = @sid_4]
id_client_11 = id_client_7[!1 = @sid_1]
st_4 = st[!1 = @sid_3]
st_5 = st_1[!1 = @sid_5]
id_17 = id_2[o_dom = choice[d,d],!1 = @sid_6]
s_49 = s_6[!1 = @sid_6]
s_50 = s_5[s_dom_4 = choice[s_dom'_5,s_dom'_5],c_dom_3 = choice[ClientA[],ClientA[]],!1 = @sid_7]
@occ1091_1 = @occ1091[!1 = @sid_1]
id_18 = id_2[o_dom = choice[d,d],!1 = @sid_8]
s_51 = s_6[!1 = @sid_8]
s_52 = s_24[!1 = @sid_1]
s_53 = s_4[a = choice[ClientB[],ClientB[]],!1 = @sid_9]
id_19 = id_2[o_dom = choice[d_1,d_1],!1 = @sid_10]
s_54 = s_6[!1 = @sid_10]
@occ70_2 = @occ70[!1 = @sid_11]
sk_d_2 = sk_d[a_1 = choice[d_1,d_1],!1 = @sid_12]
st_6 = st[!1 = @sid_11]
st_7 = st_1[!1 = @sid_13]
psk_d_1 = psk_d[s_dom_5 = choice[s_dom'_6,s_dom'_6],c_dom_4 = choice[ClientA[],ClientA[]],!1 = @sid_14]
s_55 = s_5[s_dom_4 = choice[s_dom'_6,s_dom'_6],c_dom_3 = choice[ClientB[],ClientB[]],!1 = @sid_15]

1. The attacker has some term d_1 (resp. d_1).
attacker2(d_1,d_1).

2. The attacker has some term s_dom'_6 (resp. s_dom'_6).
attacker2(s_dom'_6,s_dom'_6).

3. By 2, the attacker may know s_dom'_6 (resp. s_dom'_6).
By 1, the attacker may know d_1 (resp. d_1).
Using the function 2-tuple the attacker may obtain (s_dom'_6,d_1) (resp. (s_dom'_6,d_1)).
attacker2((s_dom'_6,d_1),(s_dom'_6,d_1)).

4. The message d_1 (resp. d_1) that the attacker may have by 1 may be received at input {367}.
So the entry ech_configurations(ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_54)) (resp. ech_configurations(ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_54))) may be inserted in a table at insert {373}.
table2(ech_configurations(ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_54)),ech_configurations(ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_54))).

5. The attacker initially knows ClientA[] (resp. ClientA[]).
attacker2(ClientA[],ClientA[]).

6. By 5, the attacker may know ClientA[] (resp. ClientA[]).
By 2, the attacker may know s_dom'_6 (resp. s_dom'_6).
Using the function 2-tuple the attacker may obtain (ClientA[],s_dom'_6) (resp. (ClientA[],s_dom'_6)).
attacker2((ClientA[],s_dom'_6),(ClientA[],s_dom'_6)).

7. The message (ClientA[],s_dom'_6) (resp. (ClientA[],s_dom'_6)) that the attacker may have by 6 may be received at input {392}.
The event Same((ClientA[],s_dom'_6)) (resp. Same((ClientA[],s_dom'_6))) may be executed at {393}.
So the entry pre_shared_keys(ClientA[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1) (resp. pre_shared_keys(ClientA[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1)) may be inserted in a table at insert {396}.
table2(pre_shared_keys(ClientA[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1),pre_shared_keys(ClientA[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1)).

8. The attacker initially knows ClientB[] (resp. ClientB[]).
attacker2(ClientB[],ClientB[]).

9. By 8, the attacker may know ClientB[] (resp. ClientB[]).
By 2, the attacker may know s_dom'_6 (resp. s_dom'_6).
Using the function 2-tuple the attacker may obtain (ClientB[],s_dom'_6) (resp. (ClientB[],s_dom'_6)).
attacker2((ClientB[],s_dom'_6),(ClientB[],s_dom'_6)).

10. The message (ClientB[],s_dom'_6) (resp. (ClientB[],s_dom'_6)) that the attacker may have by 9 may be received at input {359}.
The event Same((ClientB[],s_dom'_6)) (resp. Same((ClientB[],s_dom'_6))) may be executed at {360}.
So the entry pre_shared_keys(ClientB[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55)) (resp. pre_shared_keys(ClientB[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55))) may be inserted in a table at insert {365}.
table2(pre_shared_keys(ClientB[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55)),pre_shared_keys(ClientB[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55))).

11. The entry pre_shared_keys(ClientA[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1) (resp. pre_shared_keys(ClientA[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1)) that may be in a table by 7 may be read at get {380}.
The entry pre_shared_keys(ClientB[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55)) (resp. pre_shared_keys(ClientB[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55))) that may be in a table by 10 may be read at get {379}.
So the entry pre_shared_keys(ClientA[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1) (resp. pre_shared_keys(ClientB[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55))) may be inserted in a table at insert {377}.
table2(pre_shared_keys(ClientA[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1),pre_shared_keys(ClientB[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55))).

12. The attacker has some term extra_22 (resp. extra_23).
attacker2(extra_22,extra_23).

13. Using the function empty_psk_ext the attacker may obtain empty_psk_ext (resp. empty_psk_ext).
attacker2(empty_psk_ext,empty_psk_ext).

14. Using the function empty_ech_ext the attacker may obtain empty_ech_ext (resp. empty_ech_ext).
attacker2(empty_ech_ext,empty_ech_ext).

15. Using the function empty_sni_ext the attacker may obtain empty_sni_ext (resp. empty_sni_ext).
attacker2(empty_sni_ext,empty_sni_ext).

16. The attacker has some term x_93 (resp. x_94).
attacker2(x_93,x_94).

17. The entry pre_shared_keys(ClientA[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1) (resp. pre_shared_keys(ClientA[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1)) that may be in a table by 7 may be read at get {380}.
The entry pre_shared_keys(ClientB[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55)) (resp. pre_shared_keys(ClientB[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55))) that may be in a table by 10 may be read at get {379}.
So the entry pre_shared_keys(ClientA[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1) (resp. pre_shared_keys(ClientB[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55))) may be inserted in a table at insert {377}.
table2(pre_shared_keys(ClientA[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1),pre_shared_keys(ClientB[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55))).

18. The event @p_act(@occ1259[],(s_dom'_6,d_1)) (resp. event @p_act(@occ1259[],(s_dom'_6,d_1))) records how variables are instantiated at {1259}.
The message (s_dom'_6,d_1) (resp. (s_dom'_6,d_1)) that the attacker may have by 3 may be received at input {1259}.
The event Same((false,false,s_dom'_6)) (resp. Same((false,false,s_dom'_6))) may be executed at {1260}.
The event @p_act(@occ1609[],ech_configurations(ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_54))) (resp. event @p_act(@occ1609[],ech_configurations(ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_54)))) records how variables are instantiated at {1609}.
The entry ech_configurations(ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_54)) (resp. ech_configurations(ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_54))) that may be in a table by 4 may be read at get {1609}.
The event @p_act(@occ1608[],pre_shared_keys(ClientA[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1)) (resp. event @p_act(@occ1608[],pre_shared_keys(ClientB[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55)))) records how variables are instantiated at {1608}.
The entry pre_shared_keys(ClientA[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1) (resp. pre_shared_keys(ClientB[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55))) that may be in a table by 17 may be read at get {1608}.
The event Selected_psk(ClientA[],ClientA[],s_dom'_6,s_dom'_6,mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1) (resp. Selected_psk(ClientB[],ClientB[],s_dom'_6,s_dom'_6,mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55))) may be executed at {1290}.
So the message CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)) (resp. CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))) may be sent to the attacker at output {1413}.
attacker2(CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))).

19. By 18, the attacker may know CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)) (resp. CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))).
Using the function 2-proj-CH the attacker may obtain nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext) (resp. nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)).
attacker2(nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)).

20. By 19, the attacker may know nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext) (resp. nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)).
Using the function 4-proj-nego the attacker may obtain client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))) (resp. client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[]))))).
attacker2(client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[]))))).

21. By 20, the attacker may know client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))) (resp. client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[]))))).
Using the function 1-proj-client_kex_ext the attacker may obtain DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[]))) (resp. DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))).
attacker2(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[]))),DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))).

22. By 21, the attacker may know DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[]))) (resp. DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))).
Using the function 2-proj-DHE_kex the attacker may obtain dh_pub(id_g(StrongDH,1),dh_k(s_34[])) (resp. dh_pub(id_g(StrongDH,1),dh_k(s_34[]))).
attacker2(dh_pub(id_g(StrongDH,1),dh_k(s_34[])),dh_pub(id_g(StrongDH,1),dh_k(s_34[]))).

23. Using the function 0 the attacker may obtain 0 (resp. 0).
attacker2(0,0).

24. By 23, the attacker may know 0 (resp. 0).
Using the function + the attacker may obtain 1 (resp. 1).
attacker2(1,1).

25. Using the function StrongDH the attacker may obtain StrongDH (resp. StrongDH).
attacker2(StrongDH,StrongDH).

26. By 25, the attacker may know StrongDH (resp. StrongDH).
By 24, the attacker may know 1 (resp. 1).
Using the function id_g the attacker may obtain id_g(StrongDH,1) (resp. id_g(StrongDH,1)).
attacker2(id_g(StrongDH,1),id_g(StrongDH,1)).

27. By 26, the attacker may know id_g(StrongDH,1) (resp. id_g(StrongDH,1)).
By 22, the attacker may know dh_pub(id_g(StrongDH,1),dh_k(s_34[])) (resp. dh_pub(id_g(StrongDH,1),dh_k(s_34[]))).
By 16, the attacker may know x_93 (resp. x_94).
Using the function dh_encap_fun the attacker may obtain dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93) (resp. dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94)).
attacker2(dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94)).

28. By 26, the attacker may know id_g(StrongDH,1) (resp. id_g(StrongDH,1)).
By 27, the attacker may know dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93) (resp. dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94)).
Using the function DHE_kex the attacker may obtain DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93)) (resp. DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))).
attacker2(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93)),DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))).

29. By 28, the attacker may know DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93)) (resp. DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))).
Using the function server_kex_ext the attacker may obtain server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))) (resp. server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94)))).
attacker2(server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94)))).

30. Using the function StrongAE the attacker may obtain StrongAE (resp. StrongAE).
attacker2(StrongAE,StrongAE).

31. By 30, the attacker may know StrongAE (resp. StrongAE).
By 24, the attacker may know 1 (resp. 1).
Using the function id_aead the attacker may obtain id_aead(StrongAE,1) (resp. id_aead(StrongAE,1)).
attacker2(id_aead(StrongAE,1),id_aead(StrongAE,1)).

32. Using the function StrongHash the attacker may obtain StrongHash (resp. StrongHash).
attacker2(StrongHash,StrongHash).

33. By 32, the attacker may know StrongHash (resp. StrongHash).
By 24, the attacker may know 1 (resp. 1).
Using the function id_hash the attacker may obtain id_hash(StrongHash,1) (resp. id_hash(StrongHash,1)).
attacker2(id_hash(StrongHash,1),id_hash(StrongHash,1)).

34. Using the function TLS13 the attacker may obtain TLS13 (resp. TLS13).
attacker2(TLS13,TLS13).

35. By 34, the attacker may know TLS13 (resp. TLS13).
By 33, the attacker may know id_hash(StrongHash,1) (resp. id_hash(StrongHash,1)).
By 31, the attacker may know id_aead(StrongAE,1) (resp. id_aead(StrongAE,1)).
By 29, the attacker may know server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))) (resp. server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94)))).
By 15, the attacker may know empty_sni_ext (resp. empty_sni_ext).
By 14, the attacker may know empty_ech_ext (resp. empty_ech_ext).
By 13, the attacker may know empty_psk_ext (resp. empty_psk_ext).
By 12, the attacker may know extra_22 (resp. extra_23).
Using the function nego the attacker may obtain nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22) (resp. nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)).
attacker2(nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)).

36. The attacker has some term sr8_3 (resp. sr8_4).
attacker2(sr8_3,sr8_4).

37. The attacker has some term sr24_3 (resp. sr24_4).
attacker2(sr24_3,sr24_4).

38. By 37, the attacker may know sr24_3 (resp. sr24_4).
By 36, the attacker may know sr8_3 (resp. sr8_4).
Using the function B32 the attacker may obtain B32(sr24_3,sr8_3) (resp. B32(sr24_4,sr8_4)).
attacker2(B32(sr24_3,sr8_3),B32(sr24_4,sr8_4)).

39. By 38, the attacker may know B32(sr24_3,sr8_3) (resp. B32(sr24_4,sr8_4)).
By 35, the attacker may know nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22) (resp. nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)).
Using the function SH the attacker may obtain SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)) (resp. SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))).
attacker2(SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))).

40. The attacker has some term ech_conf_5 (resp. ech_conf_6).
attacker2(ech_conf_5,ech_conf_6).

41. By 40, the attacker may know ech_conf_5 (resp. ech_conf_6).
Using the function server_ECH the attacker may obtain server_ECH(ech_conf_5) (resp. server_ECH(ech_conf_6)).
attacker2(server_ECH(ech_conf_5),server_ECH(ech_conf_6)).

42. By 41, the attacker may know server_ECH(ech_conf_5) (resp. server_ECH(ech_conf_6)).
Using the function EE the attacker may obtain EE(server_ECH(ech_conf_5)) (resp. EE(server_ECH(ech_conf_6))).
attacker2(EE(server_ECH(ech_conf_5)),EE(server_ECH(ech_conf_6))).

43. Using the function zero the attacker may obtain zero (resp. zero).
attacker2(zero,zero).

44. Using the function tls13_key the attacker may obtain tls13_key (resp. tls13_key).
attacker2(tls13_key,tls13_key).

45. By 44, the attacker may know tls13_key (resp. tls13_key).
By 43, the attacker may know zero (resp. zero).
Using the function 2-tuple the attacker may obtain (tls13_key,zero) (resp. (tls13_key,zero)).
attacker2((tls13_key,zero),(tls13_key,zero)).

46. By 43, the attacker may know zero (resp. zero).
By 18, the attacker may know CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)) (resp. CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))).
Using the function 2-tuple the attacker may obtain (zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))) (resp. (zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)))).
attacker2((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),(zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)))).

47. By 46, the attacker may know (zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))) (resp. (zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)))).
By 39, the attacker may know SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)) (resp. SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))).
Using the function 2-tuple the attacker may obtain ((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))) (resp. ((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))).
attacker2(((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))).

48. By 24, the attacker may know 1 (resp. 1).
By 47, the attacker may know ((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))) (resp. ((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))).
Using the function hash_ideal the attacker may obtain hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))) (resp. hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))))).
attacker2(hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))),hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))))).

49. Using the function tls13_server_handshake_traffic_secret the attacker may obtain tls13_server_handshake_traffic_secret (resp. tls13_server_handshake_traffic_secret).
attacker2(tls13_server_handshake_traffic_secret,tls13_server_handshake_traffic_secret).

50. By 49, the attacker may know tls13_server_handshake_traffic_secret (resp. tls13_server_handshake_traffic_secret).
By 48, the attacker may know hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))) (resp. hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))))).
Using the function 2-tuple the attacker may obtain (tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))))) (resp. (tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))).
attacker2((tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))))),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))).

51. By 24, the attacker may know 1 (resp. 1).
By 43, the attacker may know zero (resp. zero).
Using the function hash_ideal the attacker may obtain hash_ideal(1,zero) (resp. hash_ideal(1,zero)).
attacker2(hash_ideal(1,zero),hash_ideal(1,zero)).

52. By 24, the attacker may know 1 (resp. 1).
By 51, the attacker may know hash_ideal(1,zero) (resp. hash_ideal(1,zero)).
Using the function hash_ideal the attacker may obtain hash_ideal(1,hash_ideal(1,zero)) (resp. hash_ideal(1,hash_ideal(1,zero))).
attacker2(hash_ideal(1,hash_ideal(1,zero)),hash_ideal(1,hash_ideal(1,zero))).

53. Using the function tls13_derived the attacker may obtain tls13_derived (resp. tls13_derived).
attacker2(tls13_derived,tls13_derived).

54. By 53, the attacker may know tls13_derived (resp. tls13_derived).
By 52, the attacker may know hash_ideal(1,hash_ideal(1,zero)) (resp. hash_ideal(1,hash_ideal(1,zero))).
Using the function 2-tuple the attacker may obtain (tls13_derived,hash_ideal(1,hash_ideal(1,zero))) (resp. (tls13_derived,hash_ideal(1,hash_ideal(1,zero)))).
attacker2((tls13_derived,hash_ideal(1,hash_ideal(1,zero))),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))).

55. By 24, the attacker may know 1 (resp. 1).
By 43, the attacker may know zero (resp. zero).
By 43, the attacker may know zero (resp. zero).
Using the function hmac_ideal the attacker may obtain hmac_ideal(1,zero,zero) (resp. hmac_ideal(1,zero,zero)).
attacker2(hmac_ideal(1,zero,zero),hmac_ideal(1,zero,zero)).

56. By 24, the attacker may know 1 (resp. 1).
By 55, the attacker may know hmac_ideal(1,zero,zero) (resp. hmac_ideal(1,zero,zero)).
By 54, the attacker may know (tls13_derived,hash_ideal(1,hash_ideal(1,zero))) (resp. (tls13_derived,hash_ideal(1,hash_ideal(1,zero)))).
Using the function hmac_ideal the attacker may obtain hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))) (resp. hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero))))).
attacker2(hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero))))).

57. By 24, the attacker may know 1 (resp. 1).
By 56, the attacker may know hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))) (resp. hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero))))).
By 16, the attacker may know x_93 (resp. x_94).
Using the function hmac_ideal the attacker may obtain hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94)).
attacker2(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94)).

58. By 24, the attacker may know 1 (resp. 1).
By 57, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94)).
By 50, the attacker may know (tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))))) (resp. (tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))).
Using the function hmac_ideal the attacker may obtain hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))))))).
attacker2(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))))))).

59. By 24, the attacker may know 1 (resp. 1).
By 58, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))))))).
By 45, the attacker may know (tls13_key,zero) (resp. (tls13_key,zero)).
Using the function hmac_ideal the attacker may obtain hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero))).
attacker2(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero))).

60. By 31, the attacker may know id_aead(StrongAE,1) (resp. id_aead(StrongAE,1)).
By 59, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero))).
By 43, the attacker may know zero (resp. zero).
By 43, the attacker may know zero (resp. zero).
By 42, the attacker may know EE(server_ECH(ech_conf_5)) (resp. EE(server_ECH(ech_conf_6))).
Using the function aead_enc the attacker may obtain aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,EE(server_ECH(ech_conf_5))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,EE(server_ECH(ech_conf_6)))).
attacker2(aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,EE(server_ECH(ech_conf_5))),aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,EE(server_ECH(ech_conf_6)))).

61. The event @p_act(@occ1259[],(s_dom'_6,d_1)) (resp. event @p_act(@occ1259[],(s_dom'_6,d_1))) records how variables are instantiated at {1259}.
The message (s_dom'_6,d_1) (resp. (s_dom'_6,d_1)) that the attacker may have by 3 may be received at input {1259}.
The event Same((false,false,s_dom'_6)) (resp. Same((false,false,s_dom'_6))) may be executed at {1260}.
The event @p_act(@occ1609[],ech_configurations(ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_54))) (resp. event @p_act(@occ1609[],ech_configurations(ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_54)))) records how variables are instantiated at {1609}.
The entry ech_configurations(ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_54)) (resp. ech_configurations(ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_54))) that may be in a table by 4 may be read at get {1609}.
The event @p_act(@occ1608[],pre_shared_keys(ClientA[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1)) (resp. event @p_act(@occ1608[],pre_shared_keys(ClientB[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55)))) records how variables are instantiated at {1608}.
The entry pre_shared_keys(ClientA[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1) (resp. pre_shared_keys(ClientB[],s_dom'_6,id_hash(StrongHash,1),mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55))) that may be in a table by 11 may be read at get {1608}.
The event Selected_psk(ClientA[],ClientA[],s_dom'_6,s_dom'_6,mk_idpsk(ClientA[],s_dom'_6,id_hash(StrongHash,1),psk_d_1),psk_d_1) (resp. Selected_psk(ClientB[],ClientB[],s_dom'_6,s_dom'_6,mk_idpsk(ClientB[],s_dom'_6,id_hash(StrongHash,1),uc_psk(s_55)),uc_psk(s_55))) may be executed at {1290}.
The message SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)) (resp. SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))) that the attacker may have by 39 may be received at input {1434}.
The message aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,EE(server_ECH(ech_conf_5))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,EE(server_ECH(ech_conf_6)))) that the attacker may have by 60 may be received at input {1594}.
We have sr8_4 ≠ crop_into_bytes8(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),dh_f(s_40[])),(ech_accept_confirmation,hash_ideal(1,((zero,CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,zero8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))))))) && sr8_3 ≠ crop_into_bytes8(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),dh_f(s_40[])),(ech_accept_confirmation,hash_ideal(1,((zero,CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,zero8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))))))).
So the message (id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_3,sr8_3),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d_1,NoPSK,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),(((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5)))) may be sent on channel ch_client_after_EE[] (resp. message (id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_4,sr8_4),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientB[],d_1,NoPSK,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),(((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6)))) on channel ch_client_after_EE[]) at output {1603}.
mess2(ch_client_after_EE[],(id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_3,sr8_3),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d_1,NoPSK,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),(((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5)))),ch_client_after_EE[],(id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_4,sr8_4),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientB[],d_1,NoPSK,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),(((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))))).

62. By 43, the attacker may know zero (resp. zero).
Using the function CRTR the attacker may obtain CRTR(zero) (resp. CRTR(zero)).
attacker2(CRTR(zero),CRTR(zero)).

63. By 31, the attacker may know id_aead(StrongAE,1) (resp. id_aead(StrongAE,1)).
By 59, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero))).
By 43, the attacker may know zero (resp. zero).
By 43, the attacker may know zero (resp. zero).
By 62, the attacker may know CRTR(zero) (resp. CRTR(zero)).
Using the function aead_enc the attacker may obtain aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,CRTR(zero)) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,CRTR(zero))).
attacker2(aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,CRTR(zero)),aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,CRTR(zero))).

64. The message d_1 (resp. d_1) that the attacker may have by 1 may be received at input {387}.
The event Same(d_1) (resp. Same(d_1)) may be executed at {388}.
So the message (sk_d_2,valid_cert(d_1,pk(sk_d_2))) (resp. (sk_d_2,valid_cert(d_1,pk(sk_d_2)))) may be sent to the attacker at output {390}.
attacker2((sk_d_2,valid_cert(d_1,pk(sk_d_2))),(sk_d_2,valid_cert(d_1,pk(sk_d_2)))).

65. By 64, the attacker may know (sk_d_2,valid_cert(d_1,pk(sk_d_2))) (resp. (sk_d_2,valid_cert(d_1,pk(sk_d_2)))).
Using the function 2-proj-2-tuple the attacker may obtain valid_cert(d_1,pk(sk_d_2)) (resp. valid_cert(d_1,pk(sk_d_2))).
attacker2(valid_cert(d_1,pk(sk_d_2)),valid_cert(d_1,pk(sk_d_2))).

66. By 43, the attacker may know zero (resp. zero).
By 65, the attacker may know valid_cert(d_1,pk(sk_d_2)) (resp. valid_cert(d_1,pk(sk_d_2))).
Using the function CRT the attacker may obtain CRT(zero,valid_cert(d_1,pk(sk_d_2))) (resp. CRT(zero,valid_cert(d_1,pk(sk_d_2)))).
attacker2(CRT(zero,valid_cert(d_1,pk(sk_d_2))),CRT(zero,valid_cert(d_1,pk(sk_d_2)))).

67. By 31, the attacker may know id_aead(StrongAE,1) (resp. id_aead(StrongAE,1)).
By 59, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero))).
By 43, the attacker may know zero (resp. zero).
By 43, the attacker may know zero (resp. zero).
By 66, the attacker may know CRT(zero,valid_cert(d_1,pk(sk_d_2))) (resp. CRT(zero,valid_cert(d_1,pk(sk_d_2)))).
Using the function aead_enc the attacker may obtain aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(d_1,pk(sk_d_2)))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(d_1,pk(sk_d_2))))).
attacker2(aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(d_1,pk(sk_d_2)))),aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(d_1,pk(sk_d_2))))).

68. The message (id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_3,sr8_3),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d_1,NoPSK,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),(((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5)))) that may be sent on channel ch_client_after_EE[] (resp. message (id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_4,sr8_4),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientB[],d_1,NoPSK,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),(((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6)))) on channel ch_client_after_EE[]) by 61 may be received at input {86}.
The event PreciseMess(ch_client_after_EE[],id_client_9[],st_7,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),zero)) (resp. PreciseMess(ch_client_after_EE[],id_client_9[],st_7,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),zero))) may be executed at {88}.
The message aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,CRTR(zero)) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,CRTR(zero))) that the attacker may have by 63 may be received at input {90}.
The message aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(d_1,pk(sk_d_2)))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(d_1,pk(sk_d_2))))) that the attacker may have by 67 may be received at input {94}.
So the message (id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_3,sr8_3),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d_1,NoPSK,true,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))) may be sent on channel ch_client_CRT[] (resp. message (id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_4,sr8_4),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientB[],d_1,NoPSK,true,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))) on channel ch_client_CRT[]) at output {96}.
mess2(ch_client_CRT[],(id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_3,sr8_3),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d_1,NoPSK,true,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),ch_client_CRT[],(id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_4,sr8_4),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientB[],d_1,NoPSK,true,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))).

69. By 47, the attacker may know ((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))) (resp. ((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))).
By 42, the attacker may know EE(server_ECH(ech_conf_5)) (resp. EE(server_ECH(ech_conf_6))).
Using the function 2-tuple the attacker may obtain (((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))) (resp. (((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6)))).
attacker2((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),(((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6)))).

70. By 69, the attacker may know (((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))) (resp. (((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6)))).
By 62, the attacker may know CRTR(zero) (resp. CRTR(zero)).
Using the function 2-tuple the attacker may obtain ((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)) (resp. ((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero))).
attacker2(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero))).

71. By 70, the attacker may know ((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)) (resp. ((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero))).
By 66, the attacker may know CRT(zero,valid_cert(d_1,pk(sk_d_2))) (resp. CRT(zero,valid_cert(d_1,pk(sk_d_2)))).
Using the function 2-tuple the attacker may obtain (((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))) (resp. (((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))).
attacker2((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))).

72. By 24, the attacker may know 1 (resp. 1).
By 71, the attacker may know (((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))) (resp. (((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))).
Using the function hash_ideal the attacker may obtain hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))) (resp. hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))).
attacker2(hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))),hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))).

73. By 64, the attacker may know (sk_d_2,valid_cert(d_1,pk(sk_d_2))) (resp. (sk_d_2,valid_cert(d_1,pk(sk_d_2)))).
Using the function 1-proj-2-tuple the attacker may obtain sk_d_2 (resp. sk_d_2).
attacker2(sk_d_2,sk_d_2).

74. By 73, the attacker may know sk_d_2 (resp. sk_d_2).
By 72, the attacker may know hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))) (resp. hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))).
Using the function sign the attacker may obtain sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))) (resp. sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))).
attacker2(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))),sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))).

75. By 74, the attacker may know sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))) (resp. sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))).
Using the function CV the attacker may obtain CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))) (resp. CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))).
attacker2(CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))).

76. By 31, the attacker may know id_aead(StrongAE,1) (resp. id_aead(StrongAE,1)).
By 59, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero))).
By 43, the attacker may know zero (resp. zero).
By 43, the attacker may know zero (resp. zero).
By 75, the attacker may know CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))) (resp. CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))).
Using the function aead_enc the attacker may obtain aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))).
attacker2(aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))),aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))).

77. The message (id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_3,sr8_3),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d_1,NoPSK,true,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))) that may be sent on channel ch_client_CRT[] (resp. message (id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_4,sr8_4),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientB[],d_1,NoPSK,true,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))) on channel ch_client_CRT[]) by 68 may be received at input {75}.
The message aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))) that the attacker may have by 76 may be received at input {78}.
So the message (id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_3,sr8_3),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],NoPSK,true,pk(sk_d_2),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))) may be sent on channel ch_client_FIN[] (resp. message (id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_4,sr8_4),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientB[],NoPSK,true,pk(sk_d_2),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))) on channel ch_client_FIN[]) at output {84}.
mess2(ch_client_FIN[],(id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_3,sr8_3),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],NoPSK,true,pk(sk_d_2),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))),ch_client_FIN[],(id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_4,sr8_4),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientB[],NoPSK,true,pk(sk_d_2),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))))).

78. By 71, the attacker may know (((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))) (resp. (((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))).
By 75, the attacker may know CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))) (resp. CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))).
Using the function 2-tuple the attacker may obtain ((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))) (resp. ((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))).
attacker2(((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))).

79. Using the function tls13_finished the attacker may obtain tls13_finished (resp. tls13_finished).
attacker2(tls13_finished,tls13_finished).

80. By 79, the attacker may know tls13_finished (resp. tls13_finished).
By 43, the attacker may know zero (resp. zero).
Using the function 2-tuple the attacker may obtain (tls13_finished,zero) (resp. (tls13_finished,zero)).
attacker2((tls13_finished,zero),(tls13_finished,zero)).

81. By 24, the attacker may know 1 (resp. 1).
By 58, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))))))).
By 80, the attacker may know (tls13_finished,zero) (resp. (tls13_finished,zero)).
Using the function hmac_ideal the attacker may obtain hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero))).
attacker2(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero))).

82. By 24, the attacker may know 1 (resp. 1).
By 81, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero))).
By 78, the attacker may know ((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))) (resp. ((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))).
Using the function hmac_ideal the attacker may obtain hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))))).
attacker2(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))))).

83. By 82, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))))).
Using the function FIN the attacker may obtain FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))))) (resp. FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))))).
attacker2(FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))))),FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))))).

84. By 31, the attacker may know id_aead(StrongAE,1) (resp. id_aead(StrongAE,1)).
By 59, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero))).
By 43, the attacker may know zero (resp. zero).
By 43, the attacker may know zero (resp. zero).
By 83, the attacker may know FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))))) (resp. FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))))).
Using the function aead_enc the attacker may obtain aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))))))).
attacker2(aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))))),aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))))))).

85. The message ClientA[] (resp. ClientA[]) that the attacker may have by 5 may be received at input {351}.
The event Same(ClientA[]) (resp. Same(ClientA[])) may be executed at {352}.
So the entry long_term_keys(ClientA[],uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientA[],pk(uc_privkey(s_44)))) (resp. long_term_keys(ClientA[],uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientA[],pk(uc_privkey(s_44))))) may be inserted in a table at insert {356}.
table2(long_term_keys(ClientA[],uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientA[],pk(uc_privkey(s_44)))),long_term_keys(ClientA[],uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientA[],pk(uc_privkey(s_44))))).

86. The message ClientB[] (resp. ClientB[]) that the attacker may have by 8 may be received at input {351}.
The event Same(ClientB[]) (resp. Same(ClientB[])) may be executed at {352}.
So the entry long_term_keys(ClientB[],uc_privkey(s_53),pk(uc_privkey(s_53)),valid_cert(ClientB[],pk(uc_privkey(s_53)))) (resp. long_term_keys(ClientB[],uc_privkey(s_53),pk(uc_privkey(s_53)),valid_cert(ClientB[],pk(uc_privkey(s_53))))) may be inserted in a table at insert {356}.
table2(long_term_keys(ClientB[],uc_privkey(s_53),pk(uc_privkey(s_53)),valid_cert(ClientB[],pk(uc_privkey(s_53)))),long_term_keys(ClientB[],uc_privkey(s_53),pk(uc_privkey(s_53)),valid_cert(ClientB[],pk(uc_privkey(s_53))))).

87. The entry long_term_keys(ClientA[],uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientA[],pk(uc_privkey(s_44)))) (resp. long_term_keys(ClientA[],uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientA[],pk(uc_privkey(s_44))))) that may be in a table by 85 may be read at get {385}.
The entry long_term_keys(ClientB[],uc_privkey(s_53),pk(uc_privkey(s_53)),valid_cert(ClientB[],pk(uc_privkey(s_53)))) (resp. long_term_keys(ClientB[],uc_privkey(s_53),pk(uc_privkey(s_53)),valid_cert(ClientB[],pk(uc_privkey(s_53))))) that may be in a table by 86 may be read at get {384}.
So the entry long_term_keys(ClientA[],uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientA[],pk(uc_privkey(s_44)))) (resp. long_term_keys(ClientB[],uc_privkey(s_53),pk(uc_privkey(s_53)),valid_cert(ClientB[],pk(uc_privkey(s_53))))) may be inserted in a table at insert {382}.
table2(long_term_keys(ClientA[],uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientA[],pk(uc_privkey(s_44)))),long_term_keys(ClientB[],uc_privkey(s_53),pk(uc_privkey(s_53)),valid_cert(ClientB[],pk(uc_privkey(s_53))))).

88. The message (id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_3,sr8_3),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],NoPSK,true,pk(sk_d_2),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))) that may be sent on channel ch_client_FIN[] (resp. message (id_client_9[],B32(rand24_6[],rand8_6[]),B32(sr24_4,sr8_4),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientB[],NoPSK,true,pk(sk_d_2),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))) on channel ch_client_FIN[]) by 77 may be received at input {50}.
The event PreciseMess(ch_client_FIN[],id_client_9[],st_6,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),zero)) (resp. PreciseMess(ch_client_FIN[],id_client_9[],st_6,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),zero))) may be executed at {52}.
The message aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))),EE(server_ECH(ech_conf_5))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2))))))))))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))),EE(server_ECH(ech_conf_6))),CRTR(zero)),CRT(zero,valid_cert(d_1,pk(sk_d_2)))))))))))) that the attacker may have by 84 may be received at input {53}.
The event @p_act(@occ70_2,long_term_keys(ClientA[],uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientA[],pk(uc_privkey(s_44))))) (resp. event @p_act(@occ70_2,long_term_keys(ClientB[],uc_privkey(s_53),pk(uc_privkey(s_53)),valid_cert(ClientB[],pk(uc_privkey(s_53)))))) records how variables are instantiated at {70}.
The entry long_term_keys(ClientA[],uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientA[],pk(uc_privkey(s_44)))) (resp. long_term_keys(ClientB[],uc_privkey(s_53),pk(uc_privkey(s_53)),valid_cert(ClientB[],pk(uc_privkey(s_53))))) that may be in a table by 87 may be read at get {70}.
The event Selected_lgt(ClientA[],ClientA[],uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientA[],pk(uc_privkey(s_44)))) (resp. Selected_lgt(ClientB[],ClientB[],uc_privkey(s_53),pk(uc_privkey(s_53)),valid_cert(ClientB[],pk(uc_privkey(s_53))))) may be executed at {59}.
So the message aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44))))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(ClientB[],pk(uc_privkey(s_53)))))) may be sent to the attacker at output {62}.
attacker2(aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44))))),aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(ClientB[],pk(uc_privkey(s_53)))))).

89. Using the function tls13_client_handshake_traffic_secret the attacker may obtain tls13_client_handshake_traffic_secret (resp. tls13_client_handshake_traffic_secret).
attacker2(tls13_client_handshake_traffic_secret,tls13_client_handshake_traffic_secret).

90. By 89, the attacker may know tls13_client_handshake_traffic_secret (resp. tls13_client_handshake_traffic_secret).
By 48, the attacker may know hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))) (resp. hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))))).
Using the function 2-tuple the attacker may obtain (tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))))) (resp. (tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))).
attacker2((tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))))),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))).

91. By 24, the attacker may know 1 (resp. 1).
By 57, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94)).
By 90, the attacker may know (tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22))))) (resp. (tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))).
Using the function hmac_ideal the attacker may obtain hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))))))).
attacker2(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))))))).

92. By 24, the attacker may know 1 (resp. 1).
By 91, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23))))))).
By 45, the attacker may know (tls13_key,zero) (resp. (tls13_key,zero)).
Using the function hmac_ideal the attacker may obtain hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero))).
attacker2(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero))).

93. By 31, the attacker may know id_aead(StrongAE,1) (resp. id_aead(StrongAE,1)).
By 92, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero))).
By 43, the attacker may know zero (resp. zero).
By 43, the attacker may know zero (resp. zero).
By 88, the attacker may know aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_93),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_3,sr8_3),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_93))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_22)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44))))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_94),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_19,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),d_1,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_19,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_54)),dh_xy(s_37[],dh_pub(id_g(StrongDH,2),dh_k(s_54)))),CH(B32(rand24_6[],rand8_6[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])))),SNI(d_1),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_5[],rand8_5[]),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_33[])))),SNI(s_dom'_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_4,sr8_4),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_34[])),x_94))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_23)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(ClientB[],pk(uc_privkey(s_53)))))).
Using the function aead_dec the attacker may obtain CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44)))) (resp. CRT(zero,valid_cert(ClientB[],pk(uc_privkey(s_53))))).
attacker2(CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44)))),CRT(zero,valid_cert(ClientB[],pk(uc_privkey(s_53))))).

94. By 93, the attacker may know CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44)))) (resp. CRT(zero,valid_cert(ClientB[],pk(uc_privkey(s_53))))).
Using the function 2-proj-CRT the attacker may obtain valid_cert(ClientA[],pk(uc_privkey(s_44))) (resp. valid_cert(ClientB[],pk(uc_privkey(s_53)))).
attacker2(valid_cert(ClientA[],pk(uc_privkey(s_44))),valid_cert(ClientB[],pk(uc_privkey(s_53)))).

95. The attacker has some term s_dom'_5 (resp. s_dom'_5).
attacker2(s_dom'_5,s_dom'_5).

96. The attacker has some term d (resp. d).
attacker2(d,d).

97. By 5, the attacker may know ClientA[] (resp. ClientA[]).
By 96, the attacker may know d (resp. d).
By 95, the attacker may know s_dom'_5 (resp. s_dom'_5).
Using the function 3-tuple the attacker may obtain (ClientA[],d,s_dom'_5) (resp. (ClientA[],d,s_dom'_5)).
attacker2((ClientA[],d,s_dom'_5),(ClientA[],d,s_dom'_5)).

98. The message d (resp. d) that the attacker may have by 96 may be received at input {367}.
So the entry ech_configurations(ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_46)) (resp. ech_configurations(ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_46))) may be inserted in a table at insert {373}.
table2(ech_configurations(ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_46)),ech_configurations(ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_46))).

99. By 5, the attacker may know ClientA[] (resp. ClientA[]).
By 95, the attacker may know s_dom'_5 (resp. s_dom'_5).
Using the function 2-tuple the attacker may obtain (ClientA[],s_dom'_5) (resp. (ClientA[],s_dom'_5)).
attacker2((ClientA[],s_dom'_5),(ClientA[],s_dom'_5)).

100. The message (ClientA[],s_dom'_5) (resp. (ClientA[],s_dom'_5)) that the attacker may have by 99 may be received at input {359}.
The event Same((ClientA[],s_dom'_5)) (resp. Same((ClientA[],s_dom'_5))) may be executed at {360}.
So the entry pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50)) (resp. pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50))) may be inserted in a table at insert {365}.
table2(pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50)),pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50))).

101. The attacker has some term extra_24 (resp. extra_25).
attacker2(extra_24,extra_25).

102. The attacker has some term x_95 (resp. x_96).
attacker2(x_95,x_96).

103. The message d (resp. d) that the attacker may have by 96 may be received at input {367}.
So the entry ech_configurations(ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_51)) (resp. ech_configurations(ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_51))) may be inserted in a table at insert {373}.
table2(ech_configurations(ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_51)),ech_configurations(ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_51))).

104. The message (ClientA[],d,s_dom'_5) (resp. (ClientA[],d,s_dom'_5)) that the attacker may have by 97 may be received at input {743}.
The event Same((false,false,true,ClientA[],d,s_dom'_5)) (resp. Same((false,false,true,ClientA[],d,s_dom'_5))) may be executed at {744}.
The entry ech_configurations(ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_51)) (resp. ech_configurations(ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_51))) that may be in a table by 103 may be read at get {1092}.
The event @p_act(@occ1091_1,pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50))) (resp. event @p_act(@occ1091_1,pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50)))) records how variables are instantiated at {1091}.
The entry pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50)) (resp. pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50))) that may be in a table by 100 may be read at get {1091}.
The event Selected_psk(ClientA[],ClientA[],s_dom'_5,s_dom'_5,mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50)) (resp. Selected_psk(ClientA[],ClientA[],s_dom'_5,s_dom'_5,mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50))) may be executed at {773}.
So the message CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)) (resp. CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))) may be sent to the attacker at output {896}.
attacker2(CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))).

105. By 104, the attacker may know CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)) (resp. CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))).
Using the function 2-proj-CH the attacker may obtain nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext) (resp. nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)).
attacker2(nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)).

106. By 105, the attacker may know nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext) (resp. nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_18,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_18,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_51)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_51)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)).
Using the function 4-proj-nego the attacker may obtain client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))) (resp. client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45))))).
attacker2(client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45))))).

107. By 106, the attacker may know client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))) (resp. client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45))))).
Using the function 1-proj-client_kex_ext the attacker may obtain DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45))) (resp. DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))).
attacker2(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45))),DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))).

108. By 107, the attacker may know DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45))) (resp. DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))).
Using the function 2-proj-DHE_kex the attacker may obtain dh_pub(id_g(StrongDH,1),dh_k(s_45)) (resp. dh_pub(id_g(StrongDH,1),dh_k(s_45))).
attacker2(dh_pub(id_g(StrongDH,1),dh_k(s_45)),dh_pub(id_g(StrongDH,1),dh_k(s_45))).

109. By 26, the attacker may know id_g(StrongDH,1) (resp. id_g(StrongDH,1)).
By 108, the attacker may know dh_pub(id_g(StrongDH,1),dh_k(s_45)) (resp. dh_pub(id_g(StrongDH,1),dh_k(s_45))).
By 102, the attacker may know x_95 (resp. x_96).
Using the function dh_encap_fun the attacker may obtain dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95) (resp. dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96)).
attacker2(dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96)).

110. By 26, the attacker may know id_g(StrongDH,1) (resp. id_g(StrongDH,1)).
By 109, the attacker may know dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95) (resp. dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96)).
Using the function DHE_kex the attacker may obtain DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95)) (resp. DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))).
attacker2(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95)),DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))).

111. By 110, the attacker may know DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95)) (resp. DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))).
Using the function server_kex_ext the attacker may obtain server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))) (resp. server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96)))).
attacker2(server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96)))).

112. By 34, the attacker may know TLS13 (resp. TLS13).
By 33, the attacker may know id_hash(StrongHash,1) (resp. id_hash(StrongHash,1)).
By 31, the attacker may know id_aead(StrongAE,1) (resp. id_aead(StrongAE,1)).
By 111, the attacker may know server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))) (resp. server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96)))).
By 15, the attacker may know empty_sni_ext (resp. empty_sni_ext).
By 14, the attacker may know empty_ech_ext (resp. empty_ech_ext).
By 13, the attacker may know empty_psk_ext (resp. empty_psk_ext).
By 101, the attacker may know extra_24 (resp. extra_25).
Using the function nego the attacker may obtain nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24) (resp. nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)).
attacker2(nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)).

113. The attacker has some term sr8_5 (resp. sr8_6).
attacker2(sr8_5,sr8_6).

114. The attacker has some term sr24_5 (resp. sr24_6).
attacker2(sr24_5,sr24_6).

115. By 114, the attacker may know sr24_5 (resp. sr24_6).
By 113, the attacker may know sr8_5 (resp. sr8_6).
Using the function B32 the attacker may obtain B32(sr24_5,sr8_5) (resp. B32(sr24_6,sr8_6)).
attacker2(B32(sr24_5,sr8_5),B32(sr24_6,sr8_6)).

116. By 115, the attacker may know B32(sr24_5,sr8_5) (resp. B32(sr24_6,sr8_6)).
By 112, the attacker may know nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24) (resp. nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)).
Using the function SH the attacker may obtain SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)) (resp. SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))).
attacker2(SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))).

117. The attacker has some term x_97 (resp. x_98).
attacker2(x_97,x_98).

118. By 117, the attacker may know x_97 (resp. x_98).
Using the function EE the attacker may obtain EE(x_97) (resp. EE(x_98)).
attacker2(EE(x_97),EE(x_98)).

119. Using the function empty_extra_ext the attacker may obtain empty_extra_ext (resp. empty_extra_ext).
attacker2(empty_extra_ext,empty_extra_ext).

120. The message (ClientA[],d,s_dom'_5) (resp. (ClientA[],d,s_dom'_5)) that the attacker may have by 97 may be received at input {743}.
The event Same((false,false,true,ClientA[],d,s_dom'_5)) (resp. Same((false,false,true,ClientA[],d,s_dom'_5))) may be executed at {744}.
The entry ech_configurations(ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_46)) (resp. ech_configurations(ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_46))) that may be in a table by 98 may be read at get {1092}.
The event @p_act(@occ1091_1,pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50))) (resp. event @p_act(@occ1091_1,pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50)))) records how variables are instantiated at {1091}.
The entry pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50)) (resp. pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50))) that may be in a table by 100 may be read at get {1091}.
The event Selected_psk(ClientA[],ClientA[],s_dom'_5,s_dom'_5,mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50)) (resp. Selected_psk(ClientA[],ClientA[],s_dom'_5,s_dom'_5,mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50))) may be executed at {773}.
So the message CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)) (resp. CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))) may be sent to the attacker at output {896}.
attacker2(CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))).

121. By 120, the attacker may know CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)) (resp. CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))).
Using the function 2-proj-CH the attacker may obtain nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext) (resp. nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)).
attacker2(nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)).

122. By 121, the attacker may know nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext) (resp. nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)).
Using the function 6-proj-nego the attacker may obtain client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))) (resp. client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext))))).
attacker2(client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext))))).

123. By 122, the attacker may know client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))) (resp. client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext))))).
Using the function 5-proj-client_ECH the attacker may obtain aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext))) (resp. aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))).
attacker2(aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))).

124. By 122, the attacker may know client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))) (resp. client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext))))).
Using the function 4-proj-client_ECH the attacker may obtain dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))) (resp. dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))))).
attacker2(dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))))).

125. The message d (resp. d) that the attacker may have by 96 may be received at input {367}.
So the message ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)) (resp. ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))) may be sent to the attacker at output {375}.
attacker2(ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))).

126. By 125, the attacker may know ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)) (resp. ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))).
Using the function 1-proj-ech_config the attacker may obtain id_16 (resp. id_16).
attacker2(id_16,id_16).

127. By 24, the attacker may know 1 (resp. 1).
Using the function + the attacker may obtain 2 (resp. 2).
attacker2(2,2).

128. By 30, the attacker may know StrongAE (resp. StrongAE).
By 127, the attacker may know 2 (resp. 2).
Using the function id_aead the attacker may obtain id_aead(StrongAE,2) (resp. id_aead(StrongAE,2)).
attacker2(id_aead(StrongAE,2),id_aead(StrongAE,2)).

129. By 32, the attacker may know StrongHash (resp. StrongHash).
By 127, the attacker may know 2 (resp. 2).
Using the function id_hash the attacker may obtain id_hash(StrongHash,2) (resp. id_hash(StrongHash,2)).
attacker2(id_hash(StrongHash,2),id_hash(StrongHash,2)).

130. By 129, the attacker may know id_hash(StrongHash,2) (resp. id_hash(StrongHash,2)).
By 128, the attacker may know id_aead(StrongAE,2) (resp. id_aead(StrongAE,2)).
By 126, the attacker may know id_16 (resp. id_16).
By 124, the attacker may know dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))) (resp. dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))))).
By 123, the attacker may know aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext))) (resp. aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))).
Using the function client_ECH the attacker may obtain client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))) (resp. client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext))))).
attacker2(client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext))))).

131. By 96, the attacker may know d (resp. d).
Using the function SNI the attacker may obtain SNI(d) (resp. SNI(d)).
attacker2(SNI(d),SNI(d)).

132. By 34, the attacker may know TLS13 (resp. TLS13).
By 33, the attacker may know id_hash(StrongHash,1) (resp. id_hash(StrongHash,1)).
By 31, the attacker may know id_aead(StrongAE,1) (resp. id_aead(StrongAE,1)).
By 106, the attacker may know client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))) (resp. client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45))))).
By 131, the attacker may know SNI(d) (resp. SNI(d)).
By 130, the attacker may know client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))) (resp. client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext))))).
By 13, the attacker may know empty_psk_ext (resp. empty_psk_ext).
By 119, the attacker may know empty_extra_ext (resp. empty_extra_ext).
Using the function nego the attacker may obtain nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext) (resp. nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)).
attacker2(nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)).

133. The message d (resp. d) that the attacker may have by 96 may be received at input {367}.
So the entry ech_configurations(ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_49)) (resp. ech_configurations(ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_49))) may be inserted in a table at insert {373}.
table2(ech_configurations(ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_49)),ech_configurations(ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_49))).

134. The message (ClientA[],d,s_dom'_5) (resp. (ClientA[],d,s_dom'_5)) that the attacker may have by 97 may be received at input {743}.
The event Same((false,false,true,ClientA[],d,s_dom'_5)) (resp. Same((false,false,true,ClientA[],d,s_dom'_5))) may be executed at {744}.
The entry ech_configurations(ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_49)) (resp. ech_configurations(ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_49))) that may be in a table by 133 may be read at get {1092}.
The event @p_act(@occ1091_1,pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50))) (resp. event @p_act(@occ1091_1,pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50)))) records how variables are instantiated at {1091}.
The entry pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50)) (resp. pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50))) that may be in a table by 100 may be read at get {1091}.
The event Selected_psk(ClientA[],ClientA[],s_dom'_5,s_dom'_5,mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50)) (resp. Selected_psk(ClientA[],ClientA[],s_dom'_5,s_dom'_5,mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50))) may be executed at {773}.
So the message CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)) (resp. CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))) may be sent to the attacker at output {896}.
attacker2(CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))).

135. By 134, the attacker may know CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)) (resp. CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))).
Using the function 1-proj-CH the attacker may obtain B32(rand24_7,rand8_7) (resp. B32(rand24_7,rand8_7)).
attacker2(B32(rand24_7,rand8_7),B32(rand24_7,rand8_7)).

136. By 135, the attacker may know B32(rand24_7,rand8_7) (resp. B32(rand24_7,rand8_7)).
Using the function 2-proj-B32 the attacker may obtain rand8_7 (resp. rand8_7).
attacker2(rand8_7,rand8_7).

137. By 135, the attacker may know B32(rand24_7,rand8_7) (resp. B32(rand24_7,rand8_7)).
Using the function 1-proj-B32 the attacker may obtain rand24_7 (resp. rand24_7).
attacker2(rand24_7,rand24_7).

138. By 137, the attacker may know rand24_7 (resp. rand24_7).
By 136, the attacker may know rand8_7 (resp. rand8_7).
Using the function B32 the attacker may obtain B32(rand24_7,rand8_7) (resp. B32(rand24_7,rand8_7)).
attacker2(B32(rand24_7,rand8_7),B32(rand24_7,rand8_7)).

139. By 138, the attacker may know B32(rand24_7,rand8_7) (resp. B32(rand24_7,rand8_7)).
By 132, the attacker may know nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext) (resp. nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)).
Using the function CH the attacker may obtain CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)) (resp. CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))).
attacker2(CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))).

140. By 43, the attacker may know zero (resp. zero).
By 139, the attacker may know CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)) (resp. CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))).
Using the function 2-tuple the attacker may obtain (zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))) (resp. (zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)))).
attacker2((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),(zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)))).

141. By 140, the attacker may know (zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))) (resp. (zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext)))).
By 116, the attacker may know SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)) (resp. SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))).
Using the function 2-tuple the attacker may obtain ((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))) (resp. ((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))).
attacker2(((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))).

142. By 24, the attacker may know 1 (resp. 1).
By 141, the attacker may know ((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))) (resp. ((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))).
Using the function hash_ideal the attacker may obtain hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))) (resp. hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))))).
attacker2(hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))),hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))))).

143. By 49, the attacker may know tls13_server_handshake_traffic_secret (resp. tls13_server_handshake_traffic_secret).
By 142, the attacker may know hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))) (resp. hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))))).
Using the function 2-tuple the attacker may obtain (tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))))) (resp. (tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))).
attacker2((tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))))),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))).

144. By 24, the attacker may know 1 (resp. 1).
By 56, the attacker may know hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))) (resp. hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero))))).
By 102, the attacker may know x_95 (resp. x_96).
Using the function hmac_ideal the attacker may obtain hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96)).
attacker2(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96)).

145. By 24, the attacker may know 1 (resp. 1).
By 144, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96)).
By 143, the attacker may know (tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))))) (resp. (tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))).
Using the function hmac_ideal the attacker may obtain hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))))))).
attacker2(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))))))).

146. By 24, the attacker may know 1 (resp. 1).
By 145, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))))))).
By 45, the attacker may know (tls13_key,zero) (resp. (tls13_key,zero)).
Using the function hmac_ideal the attacker may obtain hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero))).
attacker2(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero))).

147. By 31, the attacker may know id_aead(StrongAE,1) (resp. id_aead(StrongAE,1)).
By 146, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero))).
By 43, the attacker may know zero (resp. zero).
By 43, the attacker may know zero (resp. zero).
By 118, the attacker may know EE(x_97) (resp. EE(x_98)).
Using the function aead_enc the attacker may obtain aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,EE(x_97)) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,EE(x_98))).
attacker2(aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,EE(x_97)),aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,EE(x_98))).

148. The message (ClientA[],d,s_dom'_5) (resp. (ClientA[],d,s_dom'_5)) that the attacker may have by 97 may be received at input {743}.
The event Same((false,false,true,ClientA[],d,s_dom'_5)) (resp. Same((false,false,true,ClientA[],d,s_dom'_5))) may be executed at {744}.
The entry ech_configurations(ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_46)) (resp. ech_configurations(ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_46))) that may be in a table by 98 may be read at get {1092}.
The event @p_act(@occ1091_1,pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50))) (resp. event @p_act(@occ1091_1,pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50)))) records how variables are instantiated at {1091}.
The entry pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50)) (resp. pre_shared_keys(ClientA[],s_dom'_5,id_hash(StrongHash,1),mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50))) that may be in a table by 100 may be read at get {1091}.
The event Selected_psk(ClientA[],ClientA[],s_dom'_5,s_dom'_5,mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50)) (resp. Selected_psk(ClientA[],ClientA[],s_dom'_5,s_dom'_5,mk_idpsk(ClientA[],s_dom'_5,id_hash(StrongHash,1),uc_psk(s_50)),uc_psk(s_50))) may be executed at {773}.
The message SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)) (resp. SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))) that the attacker may have by 116 may be received at input {917}.
The message aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,EE(x_97)) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,EE(x_98))) that the attacker may have by 147 may be received at input {1077}.
We have (forall @gen, x_98 ≠ server_ECH(@gen)) && (forall @gen, x_97 ≠ server_ECH(@gen)) && sr8_6 ≠ crop_into_bytes8(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),dh_f(s_52)),(ech_accept_confirmation,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,zero8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))))))) && sr8_5 ≠ crop_into_bytes8(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),dh_f(s_52)),(ech_accept_confirmation,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,zero8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))))))).
So the message (id_client_11,B32(rand24_7,rand8_7),B32(sr24_5,sr8_5),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d,NoPSK,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),(((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97))) may be sent on channel ch_client_after_EE[] (resp. message (id_client_11,B32(rand24_7,rand8_7),B32(sr24_6,sr8_6),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d,NoPSK,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),(((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98))) on channel ch_client_after_EE[]) at output {1086}.
mess2(ch_client_after_EE[],(id_client_11,B32(rand24_7,rand8_7),B32(sr24_5,sr8_5),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d,NoPSK,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),(((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97))),ch_client_after_EE[],(id_client_11,B32(rand24_7,rand8_7),B32(sr24_6,sr8_6),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d,NoPSK,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),(((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)))).

149. By 31, the attacker may know id_aead(StrongAE,1) (resp. id_aead(StrongAE,1)).
By 146, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero))).
By 43, the attacker may know zero (resp. zero).
By 43, the attacker may know zero (resp. zero).
By 62, the attacker may know CRTR(zero) (resp. CRTR(zero)).
Using the function aead_enc the attacker may obtain aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,CRTR(zero)) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,CRTR(zero))).
attacker2(aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,CRTR(zero)),aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,CRTR(zero))).

150. The message d (resp. d) that the attacker may have by 96 may be received at input {387}.
The event Same(d) (resp. Same(d)) may be executed at {388}.
So the message (sk_d_1,valid_cert(d,pk(sk_d_1))) (resp. (sk_d_1,valid_cert(d,pk(sk_d_1)))) may be sent to the attacker at output {390}.
attacker2((sk_d_1,valid_cert(d,pk(sk_d_1))),(sk_d_1,valid_cert(d,pk(sk_d_1)))).

151. By 150, the attacker may know (sk_d_1,valid_cert(d,pk(sk_d_1))) (resp. (sk_d_1,valid_cert(d,pk(sk_d_1)))).
Using the function 2-proj-2-tuple the attacker may obtain valid_cert(d,pk(sk_d_1)) (resp. valid_cert(d,pk(sk_d_1))).
attacker2(valid_cert(d,pk(sk_d_1)),valid_cert(d,pk(sk_d_1))).

152. By 43, the attacker may know zero (resp. zero).
By 151, the attacker may know valid_cert(d,pk(sk_d_1)) (resp. valid_cert(d,pk(sk_d_1))).
Using the function CRT the attacker may obtain CRT(zero,valid_cert(d,pk(sk_d_1))) (resp. CRT(zero,valid_cert(d,pk(sk_d_1)))).
attacker2(CRT(zero,valid_cert(d,pk(sk_d_1))),CRT(zero,valid_cert(d,pk(sk_d_1)))).

153. By 31, the attacker may know id_aead(StrongAE,1) (resp. id_aead(StrongAE,1)).
By 146, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero))).
By 43, the attacker may know zero (resp. zero).
By 43, the attacker may know zero (resp. zero).
By 152, the attacker may know CRT(zero,valid_cert(d,pk(sk_d_1))) (resp. CRT(zero,valid_cert(d,pk(sk_d_1)))).
Using the function aead_enc the attacker may obtain aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(d,pk(sk_d_1)))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(d,pk(sk_d_1))))).
attacker2(aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(d,pk(sk_d_1)))),aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(d,pk(sk_d_1))))).

154. The message (id_client_11,B32(rand24_7,rand8_7),B32(sr24_5,sr8_5),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d,NoPSK,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),(((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97))) that may be sent on channel ch_client_after_EE[] (resp. message (id_client_11,B32(rand24_7,rand8_7),B32(sr24_6,sr8_6),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d,NoPSK,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),(((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98))) on channel ch_client_after_EE[]) by 148 may be received at input {86}.
The event PreciseMess(ch_client_after_EE[],id_client_11,st_5,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),zero)) (resp. PreciseMess(ch_client_after_EE[],id_client_11,st_5,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),zero))) may be executed at {88}.
The message aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,CRTR(zero)) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,CRTR(zero))) that the attacker may have by 149 may be received at input {90}.
The message aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(d,pk(sk_d_1)))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(d,pk(sk_d_1))))) that the attacker may have by 153 may be received at input {94}.
So the message (id_client_11,B32(rand24_7,rand8_7),B32(sr24_5,sr8_5),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d,NoPSK,true,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))) may be sent on channel ch_client_CRT[] (resp. message (id_client_11,B32(rand24_7,rand8_7),B32(sr24_6,sr8_6),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d,NoPSK,true,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))) on channel ch_client_CRT[]) at output {96}.
mess2(ch_client_CRT[],(id_client_11,B32(rand24_7,rand8_7),B32(sr24_5,sr8_5),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d,NoPSK,true,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),ch_client_CRT[],(id_client_11,B32(rand24_7,rand8_7),B32(sr24_6,sr8_6),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d,NoPSK,true,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))).

155. By 141, the attacker may know ((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))) (resp. ((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))).
By 118, the attacker may know EE(x_97) (resp. EE(x_98)).
Using the function 2-tuple the attacker may obtain (((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)) (resp. (((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98))).
attacker2((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),(((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98))).

156. By 155, the attacker may know (((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)) (resp. (((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98))).
By 62, the attacker may know CRTR(zero) (resp. CRTR(zero)).
Using the function 2-tuple the attacker may obtain ((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)) (resp. ((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero))).
attacker2(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero))).

157. By 156, the attacker may know ((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)) (resp. ((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero))).
By 152, the attacker may know CRT(zero,valid_cert(d,pk(sk_d_1))) (resp. CRT(zero,valid_cert(d,pk(sk_d_1)))).
Using the function 2-tuple the attacker may obtain (((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))) (resp. (((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))).
attacker2((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))).

158. By 24, the attacker may know 1 (resp. 1).
By 157, the attacker may know (((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))) (resp. (((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))).
Using the function hash_ideal the attacker may obtain hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))) (resp. hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))).
attacker2(hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))),hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))).

159. By 150, the attacker may know (sk_d_1,valid_cert(d,pk(sk_d_1))) (resp. (sk_d_1,valid_cert(d,pk(sk_d_1)))).
Using the function 1-proj-2-tuple the attacker may obtain sk_d_1 (resp. sk_d_1).
attacker2(sk_d_1,sk_d_1).

160. By 159, the attacker may know sk_d_1 (resp. sk_d_1).
By 158, the attacker may know hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))) (resp. hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))).
Using the function sign the attacker may obtain sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))) (resp. sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))).
attacker2(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))),sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))).

161. By 160, the attacker may know sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))) (resp. sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))).
Using the function CV the attacker may obtain CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))) (resp. CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))).
attacker2(CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))).

162. By 31, the attacker may know id_aead(StrongAE,1) (resp. id_aead(StrongAE,1)).
By 146, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero))).
By 43, the attacker may know zero (resp. zero).
By 43, the attacker may know zero (resp. zero).
By 161, the attacker may know CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))) (resp. CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))).
Using the function aead_enc the attacker may obtain aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))).
attacker2(aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))),aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))).

163. The message (id_client_11,B32(rand24_7,rand8_7),B32(sr24_5,sr8_5),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d,NoPSK,true,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))) that may be sent on channel ch_client_CRT[] (resp. message (id_client_11,B32(rand24_7,rand8_7),B32(sr24_6,sr8_6),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],d,NoPSK,true,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))) on channel ch_client_CRT[]) by 154 may be received at input {75}.
The message aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))) that the attacker may have by 162 may be received at input {78}.
So the message (id_client_11,B32(rand24_7,rand8_7),B32(sr24_5,sr8_5),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],NoPSK,true,pk(sk_d_1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))) may be sent on channel ch_client_FIN[] (resp. message (id_client_11,B32(rand24_7,rand8_7),B32(sr24_6,sr8_6),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],NoPSK,true,pk(sk_d_1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))) on channel ch_client_FIN[]) at output {84}.
mess2(ch_client_FIN[],(id_client_11,B32(rand24_7,rand8_7),B32(sr24_5,sr8_5),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],NoPSK,true,pk(sk_d_1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))),ch_client_FIN[],(id_client_11,B32(rand24_7,rand8_7),B32(sr24_6,sr8_6),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],NoPSK,true,pk(sk_d_1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))))).

164. By 157, the attacker may know (((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))) (resp. (((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))).
By 161, the attacker may know CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))) (resp. CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))).
Using the function 2-tuple the attacker may obtain ((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))) (resp. ((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))).
attacker2(((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))).

165. By 24, the attacker may know 1 (resp. 1).
By 145, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))))))).
By 80, the attacker may know (tls13_finished,zero) (resp. (tls13_finished,zero)).
Using the function hmac_ideal the attacker may obtain hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero))).
attacker2(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero))).

166. By 24, the attacker may know 1 (resp. 1).
By 165, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero))).
By 164, the attacker may know ((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))) (resp. ((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))).
Using the function hmac_ideal the attacker may obtain hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))))).
attacker2(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))))).

167. By 166, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))))).
Using the function FIN the attacker may obtain FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))))) (resp. FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))))).
attacker2(FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))))),FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))))).

168. By 31, the attacker may know id_aead(StrongAE,1) (resp. id_aead(StrongAE,1)).
By 146, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero))).
By 43, the attacker may know zero (resp. zero).
By 43, the attacker may know zero (resp. zero).
By 167, the attacker may know FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))))) (resp. FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))))).
Using the function aead_enc the attacker may obtain aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))))))).
attacker2(aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))))),aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))))))).

169. The message (id_client_11,B32(rand24_7,rand8_7),B32(sr24_5,sr8_5),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],NoPSK,true,pk(sk_d_1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))) that may be sent on channel ch_client_FIN[] (resp. message (id_client_11,B32(rand24_7,rand8_7),B32(sr24_6,sr8_6),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA[],NoPSK,true,pk(sk_d_1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))) on channel ch_client_FIN[]) by 163 may be received at input {50}.
The event PreciseMess(ch_client_FIN[],id_client_11,st_4,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),zero)) (resp. PreciseMess(ch_client_FIN[],id_client_11,st_4,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),zero))) may be executed at {52}.
The message aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))),EE(x_97)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1))))))))))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))),EE(x_98)),CRTR(zero)),CRT(zero,valid_cert(d,pk(sk_d_1)))))))))))) that the attacker may have by 168 may be received at input {53}.
The event @p_act(@occ70_1,long_term_keys(ClientA[],uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientA[],pk(uc_privkey(s_44))))) (resp. event @p_act(@occ70_1,long_term_keys(ClientA[],uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientA[],pk(uc_privkey(s_44)))))) records how variables are instantiated at {70}.
The entry long_term_keys(ClientA[],uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientA[],pk(uc_privkey(s_44)))) (resp. long_term_keys(ClientA[],uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientA[],pk(uc_privkey(s_44))))) that may be in a table by 85 may be read at get {70}.
The event Selected_lgt(ClientA[],ClientA[],uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientA[],pk(uc_privkey(s_44)))) (resp. Selected_lgt(ClientA[],ClientA[],uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientA[],pk(uc_privkey(s_44))))) may be executed at {59}.
So the message aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44))))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44)))))) may be sent to the attacker at output {62}.
attacker2(aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44))))),aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44)))))).

170. By 89, the attacker may know tls13_client_handshake_traffic_secret (resp. tls13_client_handshake_traffic_secret).
By 142, the attacker may know hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))) (resp. hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))))).
Using the function 2-tuple the attacker may obtain (tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))))) (resp. (tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))).
attacker2((tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))))),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))).

171. By 24, the attacker may know 1 (resp. 1).
By 144, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96)).
By 170, the attacker may know (tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24))))) (resp. (tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))).
Using the function hmac_ideal the attacker may obtain hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))))))).
attacker2(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))))))).

172. By 24, the attacker may know 1 (resp. 1).
By 171, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25))))))).
By 45, the attacker may know (tls13_key,zero) (resp. (tls13_key,zero)).
Using the function hmac_ideal the attacker may obtain hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero))).
attacker2(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero))).

173. By 31, the attacker may know id_aead(StrongAE,1) (resp. id_aead(StrongAE,1)).
By 172, the attacker may know hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)) (resp. hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero))).
By 43, the attacker may know zero (resp. zero).
By 43, the attacker may know zero (resp. zero).
By 169, the attacker may know aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_95),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_5,sr8_5),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_95))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_24)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44))))) (resp. aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),x_96),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),d,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_46)),dh_xy(s_47,dh_pub(id_g(StrongDH,2),dh_k(s_46)))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)))),SNI(d),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_48)))),SNI(s_dom'_5),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(sr24_6,sr8_6),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_45)),x_96))),empty_sni_ext,empty_ech_ext,empty_psk_ext,extra_25)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44)))))).
Using the function aead_dec the attacker may obtain CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44)))) (resp. CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44))))).
attacker2(CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44)))),CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44))))).

174. By 173, the attacker may know CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44)))) (resp. CRT(zero,valid_cert(ClientA[],pk(uc_privkey(s_44))))).
Using the function 2-proj-CRT the attacker may obtain valid_cert(ClientA[],pk(uc_privkey(s_44))) (resp. valid_cert(ClientA[],pk(uc_privkey(s_44)))).
attacker2(valid_cert(ClientA[],pk(uc_privkey(s_44))),valid_cert(ClientA[],pk(uc_privkey(s_44)))).

175. By 174, the attacker may know valid_cert(ClientA[],pk(uc_privkey(s_44))) (resp. valid_cert(ClientA[],pk(uc_privkey(s_44)))).
By 94, the attacker may know valid_cert(ClientA[],pk(uc_privkey(s_44))) (resp. valid_cert(ClientB[],pk(uc_privkey(s_53)))).
We have valid_cert(ClientA[],pk(uc_privkey(s_44))) ≠ valid_cert(ClientB[],pk(uc_privkey(s_53))).
The attacker tests equality between the two terms he knows, which may allow it to distinguish cases.
bad.


Unified @sid_6 with @sid_2
Unified x_97 with x_98
Unified sr24_5 with sr24_6
Unified sr8_5 with sr8_6
Unified @sid_8 with @sid_2
Unified x_95 with x_96
Unified extra_24 with extra_25
Unified ech_conf_5 with ech_conf_6
Unified sr24_3 with sr24_4
Unified sr8_3 with sr8_4
Unified x_93 with x_94
Unified extra_22 with extra_23
Iterating unifyDerivation.
Fixpoint reached: nothing more to unify.
A more detailed output of the traces is available with
  set traceDisplay = long.

in(io, ClientB) at {351} in copy a_2

event Same(ClientB) at {352} in copy a_2

new s_4: seed creating s_44 at {353} in copy a_2

event GenCert(ClientB,pk(uc_privkey(s_44))) at {355} in copy a_2

insert long_term_keys(ClientB,uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientB,pk(uc_privkey(s_44)))) at {356} in copy a_2

out(io, ~M) with ~M = pk(uc_privkey(s_44)) at {357} in copy a_2

in(io, ClientA) at {351} in copy a_3

event Same(ClientA) at {352} in copy a_3

new s_4: seed creating s_45 at {353} in copy a_3

event GenCert(ClientA,pk(uc_privkey(s_45))) at {355} in copy a_3

insert long_term_keys(ClientA,uc_privkey(s_45),pk(uc_privkey(s_45)),valid_cert(ClientA,pk(uc_privkey(s_45)))) at {356} in copy a_3

out(io, ~M_1) with ~M_1 = pk(uc_privkey(s_45)) at {357} in copy a_3

in(io, (ClientA,a_4)) at {359} in copy a_5

event Same((ClientA,a_4)) at {360} in copy a_5

new s_5: seed creating s_46 at {361} in copy a_5

event GenPsk(ClientA,a_4,PSK(uc_psk(s_46))) at {364} in copy a_5

insert pre_shared_keys(ClientA,a_4,id_hash(StrongHash,1),mk_idpsk(ClientA,a_4,id_hash(StrongHash,1),uc_psk(s_46)),uc_psk(s_46)) at {365} in copy a_5

in(io, (ClientB,a_6)) at {359} in copy a_7

event Same((ClientB,a_6)) at {360} in copy a_7

new s_5: seed creating s_47 at {361} in copy a_7

event GenPsk(ClientB,a_6,PSK(uc_psk(s_47))) at {364} in copy a_7

insert pre_shared_keys(ClientB,a_6,id_hash(StrongHash,1),mk_idpsk(ClientB,a_6,id_hash(StrongHash,1),uc_psk(s_47)),uc_psk(s_47)) at {365} in copy a_7

in(io, a_8) at {367} in copy a_9

new id_2: configId creating id_16 at {368} in copy a_9

new s_6: seed creating s_48 at {369} in copy a_9

insert ech_configurations(ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_48)) at {373} in copy a_9

out(io, ech_config(~M_2,id_g(StrongDH,2),~M_3,~M_4,id_hash(StrongHash,2),id_aead(StrongAE,2))) with ~M_2 = id_16, ~M_3 = dh_pub(id_g(StrongDH,2),dh_k(s_48)), ~M_4 = a_8 at {375} in copy a_9

in(io, a_10) at {367} in copy a_11

new id_2: configId creating id_17 at {368} in copy a_11

new s_6: seed creating s_49 at {369} in copy a_11

insert ech_configurations(ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_49)) at {373} in copy a_11

out(io, ech_config(~M_5,id_g(StrongDH,2),~M_6,~M_7,id_hash(StrongHash,2),id_aead(StrongAE,2))) with ~M_5 = id_17, ~M_6 = dh_pub(id_g(StrongDH,2),dh_k(s_49)), ~M_7 = a_10 at {375} in copy a_11

get long_term_keys(ClientA,uc_privkey(s_45),pk(uc_privkey(s_45)),valid_cert(ClientA,pk(uc_privkey(s_45)))) at {385} in copy a_12

get long_term_keys(ClientB,uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientB,pk(uc_privkey(s_44)))) at {384} in copy a_12

insert choice[long_term_keys(ClientA,uc_privkey(s_45),pk(uc_privkey(s_45)),valid_cert(ClientA,pk(uc_privkey(s_45)))),long_term_keys(ClientB,uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientB,pk(uc_privkey(s_44))))] at {382} in copy a_12

insert choice[long_term_keys(ClientB,uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientB,pk(uc_privkey(s_44)))),long_term_keys(ClientA,uc_privkey(s_45),pk(uc_privkey(s_45)),valid_cert(ClientA,pk(uc_privkey(s_45))))] at {383} in copy a_12

in(io, a_8) at {387} in copy a_13

event Same(a_8) at {388} in copy a_13

new sk_d: privkey creating sk_d_1 at {389} in copy a_13

out(io, (~M_8,~M_9)) with ~M_8 = sk_d_1, ~M_9 = valid_cert(a_8,pk(sk_d_1)) at {390} in copy a_13

in(io, a_10) at {387} in copy a_14

event Same(a_10) at {388} in copy a_14

new sk_d: privkey creating sk_d_2 at {389} in copy a_14

out(io, (~M_10,~M_11)) with ~M_10 = sk_d_2, ~M_11 = valid_cert(a_10,pk(sk_d_2)) at {390} in copy a_14

in(io, (ClientA,a_6)) at {392} in copy a_15

event Same((ClientA,a_6)) at {393} in copy a_15

new psk_d: internal_preSharedKey creating psk_d_1 at {394} in copy a_15

insert pre_shared_keys(ClientA,a_6,id_hash(StrongHash,1),mk_idpsk(ClientA,a_6,id_hash(StrongHash,1),psk_d_1),psk_d_1) at {396} in copy a_15

out(io, ~M_12) with ~M_12 = mk_idpsk(ClientA,a_6,id_hash(StrongHash,1),psk_d_1) at {397} in copy a_15

get pre_shared_keys(ClientA,a_6,id_hash(StrongHash,1),mk_idpsk(ClientA,a_6,id_hash(StrongHash,1),psk_d_1),psk_d_1) at {380} in copy a_16

get pre_shared_keys(ClientB,a_6,id_hash(StrongHash,1),mk_idpsk(ClientB,a_6,id_hash(StrongHash,1),uc_psk(s_47)),uc_psk(s_47)) at {379} in copy a_16

insert choice[pre_shared_keys(ClientA,a_6,id_hash(StrongHash,1),mk_idpsk(ClientA,a_6,id_hash(StrongHash,1),psk_d_1),psk_d_1),pre_shared_keys(ClientB,a_6,id_hash(StrongHash,1),mk_idpsk(ClientB,a_6,id_hash(StrongHash,1),uc_psk(s_47)),uc_psk(s_47))] at {377} in copy a_16

insert choice[pre_shared_keys(ClientB,a_6,id_hash(StrongHash,1),mk_idpsk(ClientB,a_6,id_hash(StrongHash,1),uc_psk(s_47)),uc_psk(s_47)),pre_shared_keys(ClientA,a_6,id_hash(StrongHash,1),mk_idpsk(ClientA,a_6,id_hash(StrongHash,1),psk_d_1),psk_d_1)] at {378} in copy a_16

get pre_shared_keys(ClientA,a_6,id_hash(StrongHash,1),mk_idpsk(ClientA,a_6,id_hash(StrongHash,1),psk_d_1),psk_d_1) at {380} in copy a_17

get pre_shared_keys(ClientB,a_6,id_hash(StrongHash,1),mk_idpsk(ClientB,a_6,id_hash(StrongHash,1),uc_psk(s_47)),uc_psk(s_47)) at {379} in copy a_17

insert choice[pre_shared_keys(ClientA,a_6,id_hash(StrongHash,1),mk_idpsk(ClientA,a_6,id_hash(StrongHash,1),psk_d_1),psk_d_1),pre_shared_keys(ClientB,a_6,id_hash(StrongHash,1),mk_idpsk(ClientB,a_6,id_hash(StrongHash,1),uc_psk(s_47)),uc_psk(s_47))] at {377} in copy a_17

insert choice[pre_shared_keys(ClientB,a_6,id_hash(StrongHash,1),mk_idpsk(ClientB,a_6,id_hash(StrongHash,1),uc_psk(s_47)),uc_psk(s_47)),pre_shared_keys(ClientA,a_6,id_hash(StrongHash,1),mk_idpsk(ClientA,a_6,id_hash(StrongHash,1),psk_d_1),psk_d_1)] at {378} in copy a_17

in(io, (ClientA,a_8,a_4)) at {743} in copy a_18

event Same((false,false,true,ClientA,a_8,a_4)) at {744} in copy a_18

get ech_configurations(ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_48)) at {1092} in copy a_18

new id_client_7: idProc creating id_client_11 at {748} in copy a_18

event SanityClient(id_client_11,true,false,false,true) at {749} in copy a_18

new s_17: seed creating s_50 at {752} in copy a_18

new s_18: seed creating s_51 at {758} in copy a_18

new rand24_3: bytes24 creating rand24_7 at {769} in copy a_18

new rand8_3: bytes8 creating rand8_7 at {770} in copy a_18

get pre_shared_keys(ClientA,a_4,id_hash(StrongHash,1),mk_idpsk(ClientA,a_4,id_hash(StrongHash,1),uc_psk(s_46)),uc_psk(s_46)) at {1091} in copy a_18

event Selected_psk(ClientA,ClientA,a_4,a_4,mk_idpsk(ClientA,a_4,id_hash(StrongHash,1),uc_psk(s_46)),uc_psk(s_46)) at {773} in copy a_18

new s_21: seed creating s_52 at {828} in copy a_18

new rand24_4: bytes24 creating rand24_8 at {857} in copy a_18

new rand8_4: bytes8 creating rand8_8 at {858} in copy a_18

new payload: bitstring creating payload_9 at {861} in copy a_18

out(io, CH(B32(~M_13,~M_14),nego(~M_15,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(~M_17),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_18,~M_19,~M_20),empty_psk_ext,empty_extra_ext))) with ~M_13 = rand24_8, ~M_14 = rand8_8, ~M_15 = TLS13, ~M_16 = dh_pub(id_g(StrongDH,1),dh_k(s_51)), ~M_17 = a_8, ~M_18 = id_16, ~M_19 = dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))), ~M_20 = aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext))) at {896} in copy a_18

event SanityClientCH_ECH(id_client_11,zero32,B32(rand24_7,rand8_7),B32(rand24_8,rand8_8),ClientA,a_8,a_4,dh_pub(id_g(StrongDH,2),dh_k(s_48)),NoPSK,(zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),(zero,CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))) at {916} in copy a_18

in(io, SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))) with dh_encap_fun(id_g(StrongDH,1),~M_16,a_21) = dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21) at {917} in copy a_18

new s_24: seed creating s_53 at {964} in copy a_18

new s_25: seed creating s_54 at {988} in copy a_18

new s_26: seed creating s_55 at {1002} in copy a_18

event SanityClientSH(id_client_11,B32(rand24_8,rand8_8),B32(a_19,a_20),ClientA,a_8,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),NoPSK,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))) at {1074} in copy a_18

in(io, aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,EE(a_23))) with aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,EE(a_23)) = aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,EE(a_23)) at {1077} in copy a_18

out(ch_client_after_EE, (id_client_11,B32(rand24_8,rand8_8),B32(a_19,a_20),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA,a_8,NoPSK,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_finished,zero)),(((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))),EE(a_23)))) at {1086} in copy a_18 received at {86} in copy a_24

new st_1: bitstring creating st_4 at {87} in copy a_24

event PreciseMess(ch_client_after_EE,id_client_11,st_4,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),zero)) at {88} in copy a_24

in(io, aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,CRTR(zero))) with aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,CRTR(zero)) = aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,CRTR(zero)) at {90} in copy a_24

in(io, aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,CRT(zero,~M_9))) with aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,CRT(zero,~M_9)) = aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(a_8,pk(sk_d_1)))) at {94} in copy a_24

out(ch_client_CRT, (id_client_11,B32(rand24_8,rand8_8),B32(a_19,a_20),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA,a_8,NoPSK,true,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_finished,zero)),((((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))),EE(a_23)),CRTR(zero)),CRT(zero,valid_cert(a_8,pk(sk_d_1))))) at {96} in copy a_24 received at {75} in copy a_25

in(io, aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,CV(sign(~M_8,hash_ideal(1,(((((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))),EE(a_23)),CRTR(zero)),CRT(zero,~M_9))))))) with aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,CV(sign(~M_8,hash_ideal(1,(((((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))),EE(a_23)),CRTR(zero)),CRT(zero,~M_9)))))) = aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))),EE(a_23)),CRTR(zero)),CRT(zero,valid_cert(a_8,pk(sk_d_1)))))))) at {78} in copy a_25

out(ch_client_FIN, (id_client_11,B32(rand24_8,rand8_8),B32(a_19,a_20),id_hash(StrongHash,1),id_aead(StrongAE,1),ClientA,NoPSK,true,pk(sk_d_1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))),EE(a_23)),CRTR(zero)),CRT(zero,valid_cert(a_8,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))),EE(a_23)),CRTR(zero)),CRT(zero,valid_cert(a_8,pk(sk_d_1)))))))))) at {84} in copy a_25 received at {50} in copy a_26

new st: bitstring creating st_5 at {51} in copy a_26

event PreciseMess(ch_client_FIN,id_client_11,st_5,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),zero)) at {52} in copy a_26

in(io, aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_finished,zero)),((((((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))),EE(a_23)),CRTR(zero)),CRT(zero,~M_9)),CV(sign(~M_8,hash_ideal(1,(((((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))),EE(a_23)),CRTR(zero)),CRT(zero,~M_9)))))))))) with aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_finished,zero)),((((((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))),EE(a_23)),CRTR(zero)),CRT(zero,~M_9)),CV(sign(~M_8,hash_ideal(1,(((((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))),EE(a_23)),CRTR(zero)),CRT(zero,~M_9))))))))) = aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))),EE(a_23)),CRTR(zero)),CRT(zero,valid_cert(a_8,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))),EE(a_23)),CRTR(zero)),CRT(zero,valid_cert(a_8,pk(sk_d_1))))))))))) at {53} in copy a_26

get long_term_keys(ClientA,uc_privkey(s_45),pk(uc_privkey(s_45)),valid_cert(ClientA,pk(uc_privkey(s_45)))) at {70} in copy a_26

event Selected_lgt(ClientA,ClientA,uc_privkey(s_45),pk(uc_privkey(s_45)),valid_cert(ClientA,pk(uc_privkey(s_45)))) at {59} in copy a_26

out(io, ~M_21) with ~M_21 = aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(ClientA,pk(uc_privkey(s_45))))) at {62} in copy a_26

out(io, ~M_22) with ~M_22 = aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,CV(sign(uc_privkey(s_45),hash_ideal(1,((((((((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))),EE(a_23)),CRTR(zero)),CRT(zero,valid_cert(a_8,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))),EE(a_23)),CRTR(zero)),CRT(zero,valid_cert(a_8,pk(sk_d_1)))))))),FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))),EE(a_23)),CRTR(zero)),CRT(zero,valid_cert(a_8,pk(sk_d_1)))),CV(sign(sk_d_1,hash_ideal(1,(((((zero,CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_16,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),a_8,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_16,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_48)),dh_xy(s_52,dh_pub(id_g(StrongDH,2),dh_k(s_48)))),CH(B32(rand24_8,rand8_8),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)))),SNI(a_8),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_7,rand8_7),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_50)))),SNI(a_4),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_51)),a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22))),EE(a_23)),CRTR(zero)),CRT(zero,valid_cert(a_8,pk(sk_d_1))))))))))),CRT(zero,valid_cert(ClientA,pk(uc_privkey(s_45))))))))) at {67} in copy a_26

in(io, (a_6,a_10)) at {1259}

event Same((false,false,a_6)) at {1260}

get ech_configurations(ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2)),dh_k(s_49)) at {1609}

new id_client_9: idProc creating id_client_12 at {1265}

event SanityClient(id_client_12,true,false,false,true) at {1266}

new s_33: seed creating s_56 at {1269}

new s_34: seed creating s_57 at {1275}

new rand24_5: bytes24 creating rand24_9 at {1286}

new rand8_5: bytes8 creating rand8_9 at {1287}

get choice[pre_shared_keys(ClientA,a_6,id_hash(StrongHash,1),mk_idpsk(ClientA,a_6,id_hash(StrongHash,1),psk_d_1),psk_d_1),pre_shared_keys(ClientB,a_6,id_hash(StrongHash,1),mk_idpsk(ClientB,a_6,id_hash(StrongHash,1),uc_psk(s_47)),uc_psk(s_47))] at {1608}

event choice[Selected_psk(ClientA,ClientA,a_6,a_6,mk_idpsk(ClientA,a_6,id_hash(StrongHash,1),psk_d_1),psk_d_1),Selected_psk(ClientB,ClientB,a_6,a_6,mk_idpsk(ClientB,a_6,id_hash(StrongHash,1),uc_psk(s_47)),uc_psk(s_47))] at {1290}

new s_37: seed creating s_58 at {1345}

new rand24_6: bytes24 creating rand24_10 at {1374}

new rand8_6: bytes8 creating rand8_10 at {1375}

new payload_6: bitstring creating payload_10 at {1378}

out(io, CH(B32(~M_23,~M_24),nego(~M_25,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(~M_27),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_28,~M_29,~M_30),empty_psk_ext,empty_extra_ext))) with ~M_23 = rand24_10, ~M_24 = rand8_10, ~M_25 = TLS13, ~M_26 = dh_pub(id_g(StrongDH,1),dh_k(s_57)), ~M_27 = a_10, ~M_28 = id_17, ~M_29 = dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))), ~M_30 = aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext))) at {1413}

event SanityClientCH_ECH(id_client_12,zero32,B32(rand24_9,rand8_9),B32(rand24_10,rand8_10),choice[ClientA,ClientB],a_10,a_6,dh_pub(id_g(StrongDH,2),dh_k(s_49)),NoPSK,(zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),(zero,CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))) at {1433}

in(io, SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))) with dh_encap_fun(id_g(StrongDH,1),~M_26,a_29) = dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29) at {1434}

new s_40: seed creating s_59 at {1481}

new s_41: seed creating s_60 at {1505}

new s_42: seed creating s_61 at {1519}

event SanityClientSH(id_client_12,B32(rand24_10,rand8_10),B32(a_27,a_28),choice[ClientA,ClientB],a_10,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),NoPSK,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))) at {1591}

in(io, aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,EE(server_ECH(a_31)))) with aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,EE(server_ECH(a_31))) = aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,EE(server_ECH(a_31))) at {1594}

out(ch_client_after_EE, (id_client_12,B32(rand24_10,rand8_10),B32(a_27,a_28),id_hash(StrongHash,1),id_aead(StrongAE,1),choice[ClientA,ClientB],a_10,NoPSK,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_finished,zero)),(((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))))) at {1603} received at {86} in copy a_32

new st_1: bitstring creating st_6 at {87} in copy a_32

event PreciseMess(ch_client_after_EE,id_client_12,st_6,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),zero)) at {88} in copy a_32

in(io, aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,CRTR(zero))) with aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,CRTR(zero)) = aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,CRTR(zero)) at {90} in copy a_32

in(io, aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,CRT(zero,~M_11))) with aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,CRT(zero,~M_11)) = aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,CRT(zero,valid_cert(a_10,pk(sk_d_2)))) at {94} in copy a_32

out(ch_client_CRT, (id_client_12,B32(rand24_10,rand8_10),B32(a_27,a_28),id_hash(StrongHash,1),id_aead(StrongAE,1),choice[ClientA,ClientB],a_10,NoPSK,true,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_finished,zero)),((((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,valid_cert(a_10,pk(sk_d_2))))) at {96} in copy a_32 received at {75} in copy a_33

in(io, aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,CV(sign(~M_10,hash_ideal(1,(((((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,~M_11))))))) with aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,CV(sign(~M_10,hash_ideal(1,(((((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,~M_11)))))) = aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,valid_cert(a_10,pk(sk_d_2)))))))) at {78} in copy a_33

out(ch_client_FIN, (id_client_12,B32(rand24_10,rand8_10),B32(a_27,a_28),id_hash(StrongHash,1),id_aead(StrongAE,1),choice[ClientA,ClientB],NoPSK,true,pk(sk_d_2),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),zero),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_finished,zero)),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,valid_cert(a_10,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,valid_cert(a_10,pk(sk_d_2)))))))))) at {84} in copy a_33 received at {50} in copy a_34

new st: bitstring creating st_7 at {51} in copy a_34

event PreciseMess(ch_client_FIN,id_client_12,st_7,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),zero)) at {52} in copy a_34

in(io, aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_finished,zero)),((((((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,~M_11)),CV(sign(~M_10,hash_ideal(1,(((((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,~M_11)))))))))) with aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_finished,zero)),((((((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,~M_11)),CV(sign(~M_10,hash_ideal(1,(((((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,~M_11))))))))) = aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,valid_cert(a_10,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,valid_cert(a_10,pk(sk_d_2))))))))))) at {53} in copy a_34

get choice[long_term_keys(ClientA,uc_privkey(s_45),pk(uc_privkey(s_45)),valid_cert(ClientA,pk(uc_privkey(s_45)))),long_term_keys(ClientB,uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientB,pk(uc_privkey(s_44))))] at {70} in copy a_34

event choice[Selected_lgt(ClientA,ClientA,uc_privkey(s_45),pk(uc_privkey(s_45)),valid_cert(ClientA,pk(uc_privkey(s_45)))),Selected_lgt(ClientB,ClientB,uc_privkey(s_44),pk(uc_privkey(s_44)),valid_cert(ClientB,pk(uc_privkey(s_44))))] at {59} in copy a_34

out(io, ~M_31) with ~M_31 = aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,CRT(zero,choice[valid_cert(ClientA,pk(uc_privkey(s_45))),valid_cert(ClientB,pk(uc_privkey(s_44)))])) at {62} in copy a_34

out(io, ~M_32) with ~M_32 = aead_enc(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,CV(choice[sign(uc_privkey(s_45),hash_ideal(1,((((((((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,valid_cert(a_10,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,valid_cert(a_10,pk(sk_d_2)))))))),FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,valid_cert(a_10,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,valid_cert(a_10,pk(sk_d_2))))))))))),CRT(zero,valid_cert(ClientA,pk(uc_privkey(s_45))))))),sign(uc_privkey(s_44),hash_ideal(1,((((((((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,valid_cert(a_10,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,valid_cert(a_10,pk(sk_d_2)))))))),FIN(hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_server_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_finished,zero)),((((((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,valid_cert(a_10,pk(sk_d_2)))),CV(sign(sk_d_2,hash_ideal(1,(((((zero,CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),aead_enc(id_aead(StrongAE,2),hmac_ideal(2,hmac_ideal(2,dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49))),(hpke_secret,zero)),(hpke_key,hmac_ideal(2,zero,(hpke_info_hash,(tls_ech_str,ech_config(id_17,id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),a_10,id_hash(StrongHash,2),id_aead(StrongAE,2))))))),nonce_for_seal_open,client_hello_outer_AAD(id_hash(StrongHash,2),id_aead(StrongAE,2),id_17,dh_encap_fun(id_g(StrongDH,2),dh_pub(id_g(StrongDH,2),dh_k(s_49)),dh_xy(s_58,dh_pub(id_g(StrongDH,2),dh_k(s_49)))),CH(B32(rand24_10,rand8_10),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)))),SNI(a_10),empty_ech_ext,empty_psk_ext,empty_extra_ext))),CH(B32(rand24_9,rand8_9),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_56)))),SNI(a_6),ech_is_inner,empty_psk_ext,empty_extra_ext)))),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),dh_pub(id_g(StrongDH,1),dh_k(s_57)),a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30))),EE(server_ECH(a_31))),CRTR(zero)),CRT(zero,valid_cert(a_10,pk(sk_d_2))))))))))),CRT(zero,valid_cert(ClientB,pk(uc_privkey(s_44)))))))])) at {67} in copy a_34

The attacker tests whether
2-proj-CRT(aead_dec(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_21),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_13,~M_14),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_16)),SNI(a_8),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_2,~M_19,~M_20),empty_psk_ext,empty_extra_ext))),SH(B32(a_19,a_20),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_16,a_21))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_22)))))),(tls13_key,zero)),zero,zero,~M_21)) = valid_cert(ClientA,pk(uc_privkey(s_45)))
is equal to
2-proj-CRT(aead_dec(id_aead(StrongAE,1),hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,hmac_ideal(1,zero,zero),(tls13_derived,hash_ideal(1,hash_ideal(1,zero)))),a_29),(tls13_client_handshake_traffic_secret,hash_ideal(1,((zero,CH(B32(~M_23,~M_24),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),client_kex_ext(DHE_kex(id_g(StrongDH,1),~M_26)),SNI(a_10),client_ECH(id_hash(StrongHash,2),id_aead(StrongAE,2),~M_5,~M_29,~M_30),empty_psk_ext,empty_extra_ext))),SH(B32(a_27,a_28),nego(TLS13,id_hash(StrongHash,1),id_aead(StrongAE,1),server_kex_ext(DHE_kex(id_g(StrongDH,1),dh_encap_fun(id_g(StrongDH,1),~M_26,a_29))),empty_sni_ext,empty_ech_ext,empty_psk_ext,a_30)))))),(tls13_key,zero)),zero,zero,~M_31)) = choice[valid_cert(ClientA,pk(uc_privkey(s_45))),valid_cert(ClientB,pk(uc_privkey(s_44)))].
The result in the left-hand side is different from the result in the right-hand side.
A trace has been found.
RESULT Diff-equivalence cannot be proved.

--------------------------------------------------------------
Verification summary:

Query(ies):
 - Diff-equivalence cannot be proved.
Associated axiom(s):
 - 
Axiom event(PreciseMess(ch,choice[id_16,id2_1],choice[st1,st2],choice[x1,x2])) && event(PreciseMess(ch,choice[id_16,id2'],choice[st1',st2'],choice[x1',x2'])) ==> st1 = st1' && x1 = x1' encoded as event2(PreciseMess(ch,id_16,st1,x1),PreciseMess(ch,id2_1,st2,x2)) && event2(PreciseMess(ch,id_16,st1',x1'),PreciseMess(ch,id2',st2',x2')) ==> st1 = st1' && x1 = x1'
axiom event(PreciseMess(ch,choice[id1_1,id_16],choice[st1,st2],choice[x1,x2])) && event(PreciseMess(ch,choice[id1',id_16],choice[st1',st2'],choice[x1',x2'])) ==> st2 = st2' && x2 = x2' encoded as event2(PreciseMess(ch,id1_1,st1,x1),PreciseMess(ch,id_16,st2,x2)) && event2(PreciseMess(ch,id1',st1',x1'),PreciseMess(ch,id_16,st2',x2')) ==> st2 = st2' && x2 = x2'
axiom event(PreciseMess(ch,choice[id1_1,id2_1],choice[st_4,st2],choice[x1,x2])) && event(PreciseMess(ch,choice[id1',id2'],choice[st_4,st2'],choice[x1',x2'])) ==> id1_1 = id1' && x1 = x1' encoded as event2(PreciseMess(ch,id1_1,st_4,x1),PreciseMess(ch,id2_1,st2,x2)) && event2(PreciseMess(ch,id1',st_4,x1'),PreciseMess(ch,id2',st2',x2')) ==> id1_1 = id1' && x1 = x1'
axiom event(PreciseMess(ch,choice[id1_1,id2_1],choice[st1,st_4],choice[x1,x2])) && event(PreciseMess(ch,choice[id1',id2'],choice[st1',st_4],choice[x1',x2'])) ==> id2_1 = id2' && x2 = x2' encoded as event2(PreciseMess(ch,id1_1,st1,x1),PreciseMess(ch,id2_1,st_4,x2)) && event2(PreciseMess(ch,id1',st1',x1'),PreciseMess(ch,id2',st_4,x2')) ==> id2_1 = id2' && x2 = x2'
 in biprocess 1.
Associated restriction(s):
 - Restriction event(Same(choice[x_93,x'])) ==> x_93 = x' encoded as event2(Same(x_93),Same(x')) ==> x_93 = x' in biprocess 1.
 - Restriction event(Selected_lgt(choice[c_dom1_1,c_dom1'],choice[c_dom2_1,c_dom2'],choice[sk_2,sk'],choice[spkey,spkey'],choice[crt_5,crt'])) ==> c_dom1_1 = c_dom2_1 && c_dom1' = c_dom2' && ((c_dom1_1 = c_dom1' && sk_2 = sk' && spkey = spkey' && crt_5 = crt') || c_dom1_1 ≠ c_dom1') encoded as event2(Selected_lgt(c_dom1_1,c_dom2_1,sk_2,spkey,crt_5),Selected_lgt(c_dom1',c_dom2',sk',spkey',crt')) ==> c_dom1_1 = c_dom2_1 && c_dom1' = c_dom2' && ((c_dom1_1 = c_dom1' && sk_2 = sk' && spkey = spkey' && crt_5 = crt') || c_dom1_1 ≠ c_dom1') in biprocess 1.
 - Restriction event(Selected_psk(choice[c_dom1_1,c_dom1'],choice[c_dom2_1,c_dom2'],choice[s_dom1_1,s_dom1'],choice[s_dom2_1,s_dom2'],choice[id_16,id'],choice[ipsk,ipsk'])) ==> s_dom1_1 = s_dom2_1 && s_dom1' = s_dom2' && c_dom1_1 = c_dom2_1 && c_dom1' = c_dom2' && s_dom1_1 = s_dom1' && ((c_dom1_1 = c_dom1' && id_16 = id' && ipsk = ipsk') || c_dom1_1 ≠ c_dom1') encoded as event2(Selected_psk(c_dom1_1,c_dom2_1,s_dom1_1,s_dom2_1,id_16,ipsk),Selected_psk(c_dom1',c_dom2',s_dom1',s_dom2',id',ipsk')) ==> s_dom1_1 = s_dom2_1 && s_dom1' = s_dom2' && c_dom1_1 = c_dom2_1 && c_dom1' = c_dom2' && s_dom1_1 = s_dom1' && ((c_dom1_1 = c_dom1' && id_16 = id' && ipsk = ipsk') || c_dom1_1 ≠ c_dom1') in biprocess 1.

--------------------------------------------------------------

