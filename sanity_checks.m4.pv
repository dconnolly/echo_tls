(* ProVerif settings *)
changequote(<!,!>)dnl

set preciseActions = true.
set removeEventsForLemma = true.
set redundancyElim = no.

(* The scenarios *)

ifdef(<!tls_C_tls_S!>,<!
  define(<!TLS_CLIENT!>)dnl
  define(<!TLS_SERVER!>)dnl
!>)dnl
ifdef(<!tls_C_ech_S!>,<!
  define(<!TLS_CLIENT!>)dnl
  define(<!ECH_SERVER!>)dnl
!>)dnl
ifdef(<!ech_C_tls_S!>,<!
  define(<!ECH_CLIENT!>)dnl
  define(<!TLS_SERVER!>)dnl
!>)dnl
ifdef(<!ech_C_ech_S!>,<!
  define(<!ECH_CLIENT!>)dnl
  define(<!ECH_SERVER!>)dnl
!>)dnl
ifdef(<!grease_C_tls_S!>,<!
  define(<!ECH_CLIENT!>)dnl
  define(<!TLS_SERVER!>)dnl
  define(<!GREASE_CLIENT!>)dnl
!>)dnl
ifdef(<!grease_C_ech_S!>,<!
  define(<!ECH_CLIENT!>)dnl
  define(<!ECH_SERVER!>)dnl
  define(<!GREASE_CLIENT!>)dnl
!>)dnl

(**************************************
  Existence of a complete handshake
***************************************)

query
  id_s,id_c:idProc,
  i_cr,o_cr,cr,cr_hrr,sr:bytes32,
  s_pkey,c_pkey:pubkey,
  cak,sak,chk,shk:aead_key,
  cfin,sfin:mac_key,
  c_dom,i_dom,o_dom,s_dom:domain,
  psk,psk',psk'':preSharedKey,
  first_sent,is_backend,use_psk_s,use_psk_c,use_ech_s,use_ech_c,cert_req,send_kex:bool,
  handshake,es,rms,master_secret:bitstring,
  ech_pk:element,
  o_cur_log,i_cur_log,cur_log,cur_log1,cur_log2,cur_log3:bitstring;
ifdef(<!TLS_CLIENT!>,<!dnl
ifdef(<!TLS_SERVER!>,<!dnl
  (* Client standard, Server standard *)
  event(SanityClient(id_c,false,false,false,true)) &&
  event(SanityServer(id_s,false,true,false)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,false,true)) &&
  event(SanityServer(id_s,false,false,true)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,false,true)) &&
  event(SanityServer(id_s,false,false,false)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,false,false)) &&
  event(SanityServer(id_s,false,true,false)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,false,false)) &&
  event(SanityServer(id_s,false,false,true)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,false,false)) &&
  event(SanityServer(id_s,false,false,false)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,true,false)) &&
  event(SanityServer(id_s,false,true,false)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,true,false)) &&
  event(SanityServer(id_s,false,false,true)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,true,false)) &&
  event(SanityServer(id_s,false,false,false)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,true,true)) &&
  event(SanityServer(id_s,false,true,false)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,true,true)) &&
  event(SanityServer(id_s,false,false,true)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,true,true)) &&
  event(SanityServer(id_s,false,false,false)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
!>)dnl
!>)dnl
ifdef(<!TLS_CLIENT!>,<!dnl
ifdef(<!ECH_SERVER!>,<!dnl
  (* Client standard, Server echo
     - Queries where send_kex = true for the client should be false
     - Queries where send_kex <> true for the client shoudl be true since HRR with
     Server ECH has not been implemented yet.
  *)
  event(SanityClient(id_c,false,false,false,true)) &&
  event(SanityServer(id_s,true,true,false)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,false,true)) &&
  event(SanityServer(id_s,true,false,true)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,false,true)) &&
  event(SanityServer(id_s,true,false,false)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,false,false)) &&
  event(SanityServer(id_s,true,true,false)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,false,false)) &&
  event(SanityServer(id_s,true,false,true)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,false,false)) &&
  event(SanityServer(id_s,true,false,false)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,true,false)) &&
  event(SanityServer(id_s,true,true,false)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,true,false)) &&
  event(SanityServer(id_s,true,false,true)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,true,false)) &&
  event(SanityServer(id_s,true,false,false)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,true,true)) &&
  event(SanityServer(id_s,true,true,false)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,true,true)) &&
  event(SanityServer(id_s,true,false,true)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,false,false,true,true)) &&
  event(SanityServer(id_s,true,false,false)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
!>)dnl
!>)dnl
ifdef(<!ECH_CLIENT!>,<!dnl
ifdef(<!GREASE_CLIENT!>,<!!>,<!dnl
ifdef(<!ECH_SERVER!>,<!dnl
  (* Client echo, Server echo
     - Queries where send_kex = true for the client should be false
     - Queries where send_kex <> true for the client should be true since HRR with
     Server ECH and Client ECH has not been implemented yet.
  *)
  event(SanityClient(id_c,true,false,false,true)) &&
  event(SanityServer(id_s,true,true,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,false,true)) &&
  event(SanityServer(id_s,true,false,true)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,false,true)) &&
  event(SanityServer(id_s,true,false,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,false,false)) &&
  event(SanityServer(id_s,true,true,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,false,false)) &&
  event(SanityServer(id_s,true,false,true)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,false,false)) &&
  event(SanityServer(id_s,true,false,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,true,false)) &&
  event(SanityServer(id_s,true,true,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,true,false)) &&
  event(SanityServer(id_s,true,false,true)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,true,false)) &&
  event(SanityServer(id_s,true,false,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,true,true)) &&
  event(SanityServer(id_s,true,true,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,true,true)) &&
  event(SanityServer(id_s,true,false,true)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,true,true)) &&
  event(SanityServer(id_s,true,false,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
!>)dnl
!>)dnl
!>)dnl
ifdef(<!ECH_CLIENT!>,<!dnl
ifdef(<!GREASE_CLIENT!>,<!!>,<!dnl
ifdef(<!TLS_SERVER!>,<!dnl
  (* Client echo, Server normal
     - Queries where send_kex = true for the client should be false
     - Queries where send_kex <> true for the client should be true since HRR with
     Client ECH has not been implemented yet.
  *)
  event(SanityClient(id_c,true,false,false,true)) &&
  event(SanityServer(id_s,false,true,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,false,true)) &&
  event(SanityServer(id_s,false,false,true)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,false,true)) &&
  event(SanityServer(id_s,false,false,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,false,false)) &&
  event(SanityServer(id_s,false,true,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,false,false)) &&
  event(SanityServer(id_s,false,false,true)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,false,false)) &&
  event(SanityServer(id_s,false,false,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,true,false)) &&
  event(SanityServer(id_s,false,true,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,true,false)) &&
  event(SanityServer(id_s,false,false,true)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,true,false)) &&
  event(SanityServer(id_s,false,false,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,true,true)) &&
  event(SanityServer(id_s,false,true,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,true,true)) &&
  event(SanityServer(id_s,false,false,true)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,false,true,true)) &&
  event(SanityServer(id_s,false,false,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
!>)dnl
!>)dnl
!>)dnl
ifdef(<!ECH_CLIENT!>,<!dnl
ifdef(<!GREASE_CLIENT!>,<!dnl
ifdef(<!TLS_SERVER!>,<!dnl
  (* Client echo + grease, Server normal
    - Queries where send_kex = true && psk <> true for the client should be false
    - Queries where send_kex <> true for the client should be true since HRR with
    Server ECH and Client ECH has not been implemented yet.
  *)
  event(SanityClient(id_c,true,true,false,true)) &&
  event(SanityServer(id_s,false,true,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,false,true)) &&
  event(SanityServer(id_s,false,false,true)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,false,true)) &&
  event(SanityServer(id_s,false,false,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,false,false)) &&
  event(SanityServer(id_s,false,true,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,false,false)) &&
  event(SanityServer(id_s,false,false,true)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,false,false)) &&
  event(SanityServer(id_s,false,false,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,true,false)) &&
  event(SanityServer(id_s,false,true,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,true,false)) &&
  event(SanityServer(id_s,false,false,true)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,true,false)) &&
  event(SanityServer(id_s,false,false,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,true,true)) &&
  event(SanityServer(id_s,false,true,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,true,true)) &&
  event(SanityServer(id_s,false,false,true)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,true,true)) &&
  event(SanityServer(id_s,false,false,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
!>)dnl
!>)dnl
!>)dnl
ifdef(<!ECH_CLIENT!>,<!dnl
ifdef(<!GREASE_CLIENT!>,<!dnl
ifdef(<!ECH_SERVER!>,<!dnl
  (* Client echo + grease, Server echo
     - Queries where send_kex = true && psk <> true for the client should be false
     - Queries where send_kex <> true for the client should be true since HRR with
     Server ECH and Client ECH has not been implemented yet.
  *)
  event(SanityClient(id_c,true,true,false,true)) &&
  event(SanityServer(id_s,true,true,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,false,true)) &&
  event(SanityServer(id_s,true,false,true)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,false,true)) &&
  event(SanityServer(id_s,true,false,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,false,false)) &&
  event(SanityServer(id_s,true,true,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,false,false)) &&
  event(SanityServer(id_s,true,false,true)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,false,false)) &&
  event(SanityServer(id_s,true,false,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,true,false)) &&
  event(SanityServer(id_s,true,true,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,true,false)) &&
  event(SanityServer(id_s,true,false,true)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,true,false)) &&
  event(SanityServer(id_s,true,false,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,true,true)) &&
  event(SanityServer(id_s,true,true,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,true,true)) &&
  event(SanityServer(id_s,true,false,true)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ;
  event(SanityClient(id_c,true,true,true,true)) &&
  event(SanityServer(id_s,true,false,false)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
!>)dnl
!>)dnl
!>)dnl
.

(************************************************
  Sanity properties for all completed handshake
*************************************************)
ifdef(<!TLS_CLIENT!>,<!dnl
(* Client standard - Server standard or ECH *)

query
  id_s,id_c:idProc,
  cr,cr',cr_hrr,sr:bytes32,
  s_pkey,c_pkey:pubkey,
  cak,sak,chk,shk:aead_key,
  cfin,sfin:mac_key,
  c_dom,s_dom:domain,
  psk,psk',psk'':preSharedKey,
  first_sent,is_backend,use_psk_s,use_psk_c,use_ech_s,use_ech_c,cert_req,send_kex:bool,
  handshake,es,rms,master_secret:bitstring,
  cur_log,cur_log1,cur_log2,cur_log3:bitstring;
  event(SanityClient(id_c,false,false,use_psk_c,send_kex)) &&
  event(SanityServer(id_s,use_ech_s,use_psk_s,cert_req)) &&
  event(SanityClientCH(id_c,first_sent,cr,c_dom,s_dom,psk,cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ==>
  is_backend <> true &&
  (
    (use_psk_c = true && event(GenPsk(c_dom,s_dom,psk))) ||
    (use_psk_c <> true && psk = psk' && psk = NoPSK)
  ) &&
  (
    (use_psk_c = true && use_psk_s = true && s_pkey = NoPubKey && c_pkey = NoPubKey) ||
    (
      (use_psk_c <> true || use_psk_s <> true) &&
      event(GenCert(s_dom,s_pkey)) &&
      (
        (cert_req = true && event(GenCert(c_dom,c_pkey))) ||
        (cert_req <> true && c_pkey = NoPubKey)
      )
    )
  ) &&
  (
    (use_psk_s = true && psk = psk') ||
    (use_psk_s <> true && psk' = NoPSK)
  ) &&
  (
    (send_kex = true && first_sent = true) ||
    (
      send_kex <> true &&
      first_sent <> true &&
      event(SanityClientCH(id_c,true,cr',c_dom,s_dom,psk'',cur_log2)) &&
      (
        (use_psk_c = true && event(GenPsk(c_dom,s_dom,psk''))) ||
        (use_psk_c <> true && psk'' = NoPSK)
      ) &&
      event(SanityClientHRR(id_c)) &&
      event(SanityServerHRR(id_s,s_dom))
    )
  )
.
!>)
ifdef(<!ECH_CLIENT!>,<!dnl
(* Client ECH - Server standard or ECH *)

query
  id_s,id_c:idProc,
  i_cr,i_cr',o_cr,o_cr',cr,cr_hrr,sr:bytes32,
  s_pkey,c_pkey:pubkey,
  cak,sak,chk,shk:aead_key,
  cfin,sfin:mac_key,
  c_dom,i_dom,o_dom,s_dom:domain,
  psk,psk',psk'':preSharedKey,
  use_grease,first_sent,first_sent',is_backend,use_psk_s,use_psk_c,use_ech_s,use_ech_c,cert_req,send_kex:bool,
  handshake,es,rms,master_secret:bitstring,
  ech_pk:element,
  o_cur_log,o_cur_log',i_cur_log,i_cur_log',cur_log,cur_log1,cur_log2,cur_log3:bitstring;
  event(SanityClient(id_c,true,use_grease,use_psk_c,send_kex)) &&
  event(SanityServer(id_s,use_ech_s,use_psk_s,cert_req)) &&
  event(SanityClientCH_ECH(id_c,first_sent,i_cr,o_cr,c_dom,o_dom,i_dom,psk,o_cur_log,i_cur_log)) &&
  event(SanityServerCH(id_s,is_backend,cr,s_dom,psk',cur_log)) &&
  event(SanityClientCFIN(id_c,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1)) &&
  event(SanityServerCFIN(id_s,cr,sr,psk',master_secret,chk,shk,cfin,sfin,s_pkey,c_pkey,cak,sak,es,rms,cur_log1))
  ==>
  event(SanityClientCH_ECH(id_c,first_sent',i_cr',o_cr',c_dom,o_dom,i_dom,psk'',o_cur_log',i_cur_log')) &&
  ( (* Determine the server *)
    (is_backend = true && use_ech_s = true && use_grease <> true && i_cr' = cr && s_dom = i_dom && cur_log = i_cur_log') ||
    (is_backend <> true && (use_ech_s <> true || use_grease = true) && o_cr' = cr && s_dom = o_dom && cur_log = o_cur_log')
  ) &&
  ( (* Properties on PSK chosen by the client *)
    (use_psk_c = true && use_grease = true && event(GenPsk(c_dom,o_dom,psk''))) ||
    (use_psk_c = true && use_grease <> true && event(GenPsk(c_dom,i_dom,psk''))) ||
    (use_psk_c <> true && psk'' = psk' && psk'' = NoPSK)
  ) &&
  (
    (use_psk_c = true && use_psk_s = true && (use_ech_s = true || use_grease = true) && s_pkey = NoPubKey && c_pkey = NoPubKey && psk'' = psk') ||
    (
      (use_psk_c <> true || use_psk_s <> true || (use_ech_s <> true && use_grease <> true)) &&
      psk' = NoPSK &&
      event(GenCert(s_dom,s_pkey)) &&
      (
        (cert_req = true && event(GenCert(c_dom,c_pkey))) ||
        (cert_req <> true && c_pkey = NoPubKey)
      )
    )
  ) &&
  (
    (send_kex = true && first_sent = true && first_sent = first_sent' && i_cr = i_cr' && o_cr = o_cr' && psk = psk'' && o_cur_log = o_cur_log' && i_cur_log = i_cur_log') ||
    (send_kex <> true && event(SanityClientHRR(id_c)) && event(SanityServerHRR(id_s,s_dom)) &&
      (first_sent = true && first_sent' <> true) ||
      (first_sent <> true && first_sent = first_sent' && i_cr = i_cr' && o_cr = o_cr' && psk = psk'' && o_cur_log = o_cur_log' && i_cur_log = i_cur_log')
    )
  )
.
!>)dnl

process
  (* The group and cipher suite between TLS and Ech should be incompatible *)
  let tls_h = id_hash(StrongHash,1) in
  let tls_a = id_aead(StrongAE,1) in
  let tls_g = id_g(StrongDH,1) in
  let ech_h = id_hash(StrongHash,2) in
  let ech_a = id_aead(StrongAE,2) in
  let ech_g = id_g(StrongDH,2) in

  (
      main_process(tls_h,ech_h,tls_a,ech_a,tls_g,ech_g)
    | (
ifdef(<!TLS_CLIENT!>,<!dnl
      !
      new id_client:idProc;
      in(io,(use_psk:bool,send_kex:bool,c_dom:domain,s_dom:domain));
      standard_client(id_client,use_psk,send_kex,c_dom,s_dom,tls_g,tls_h,tls_a,empty_extra_ext)
    ) | (
!>)dnl
ifdef(<!ECH_CLIENT!>,<!dnl
      !
      ifdef(<!GREASE_CLIENT!>,<!let use_grease = true in!>,<!let use_grease = false in!>)
      in(io,(use_psk:bool,send_kex:bool,c_dom:domain,cfs_dom:domain,backend_dom:domain));
      get ech_configurations(ech_config(id,g,pkR,=cfs_dom,h_alg,a_alg),skR) in
      let ech_conf = ech_config(id,g,pkR,cfs_dom,h_alg,a_alg) in
      echo_client(use_grease,use_psk,send_kex,c_dom,backend_dom,tls_g,tls_h,tls_a,ech_conf,empty_extra_ext,empty_extra_ext)
    ) | (
!>)dnl
      !
      ifdef(<!ECH_SERVER!>,<!let use_ech = true in!>,<!let use_ech = false in!>)
      in(io,(use_psk:bool,cert_req:bool,s_dom:domain));
      server(use_ech,use_psk,cert_req,s_dom,tls_g,tls_h,tls_a,empty_extra_ext)
    )
  )

ifdef(<!tls_C_tls_S!>,<!
ifdef(<!NOHRR!>,<!!>,<!
(* EXPECTPV FILENAME: ./sanity_checks.m4.pv TAG: 1
RESULT not (event(SanityClient(id_c,false,false,false,true)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,false,true)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,false,true)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,false,false)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,false,false)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,false,false)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,true,false)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,true,false)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,true,false)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,true,true)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,true,true)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,true,true)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT event(SanityClient(id_c,false,false,use_psk_c,send_kex_2)) && event(SanityServer(id_s,use_ech_s,use_psk_s,cert_req_6)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) ==> is_backend_2  true && ((use_psk_c = true && event(GenPsk(c_dom_6,s_dom_10,psk_23))) || (use_psk_c  true && psk_23 = psk'_1 && psk_23 = NoPSK)) && ((use_psk_c = true && use_psk_s = true && s_pkey_6 = NoPubKey && c_pkey_4 = NoPubKey) || ((use_psk_c  true || use_psk_s  true) && event(GenCert(s_dom_10,s_pkey_6)) && ((cert_req_6 = true && event(GenCert(c_dom_6,c_pkey_4))) || (cert_req_6  true && c_pkey_4 = NoPubKey)))) && ((use_psk_s = true && psk_23 = psk'_1) || (use_psk_s  true && psk'_1 = NoPSK)) && ((send_kex_2 = true && first_sent = true) || (send_kex_2  true && first_sent  true && event(SanityClientCH(id_c,true,cr'_6,c_dom_6,s_dom_10,psk'',cur_log2_9)) && ((use_psk_c = true && event(GenPsk(c_dom_6,s_dom_10,psk''))) || (use_psk_c  true && psk'' = NoPSK)) && event(SanityClientHRR(id_c)) && event(SanityServerHRR(id_s,s_dom_10)))) is true.
23.687s (user 23.371s + system 0.316s), max rss 266500K
END *)
!>)dnl
!>)dnl
ifdef(<!tls_C_ech_S!>,<!
ifdef(<!NOHRR!>,<!!>,<!
(* EXPECTPV FILENAME: ./sanity_checks.m4.pv TAG: 2
RESULT not (event(SanityClient(id_c,false,false,false,true)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,false,true)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,false,true)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,false,false)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,false,false)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,false,false)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,true,false)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,true,false)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,true,false)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,true,true)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,true,true)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,true,true)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1))) is false.
RESULT event(SanityClient(id_c,false,false,use_psk_c,send_kex_2)) && event(SanityServer(id_s,use_ech_s,use_psk_s,cert_req_6)) && event(SanityClientCH(id_c,first_sent,cr_13,c_dom_6,s_dom_10,psk_23,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_13,s_dom_10,psk'_1,cur_log_9)) && event(SanityClientCFIN(id_c,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_13,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_11,rms_2,cur_log1)) ==> is_backend_2  true && ((use_psk_c = true && event(GenPsk(c_dom_6,s_dom_10,psk_23))) || (use_psk_c  true && psk_23 = psk'_1 && psk_23 = NoPSK)) && ((use_psk_c = true && use_psk_s = true && s_pkey_6 = NoPubKey && c_pkey_4 = NoPubKey) || ((use_psk_c  true || use_psk_s  true) && event(GenCert(s_dom_10,s_pkey_6)) && ((cert_req_6 = true && event(GenCert(c_dom_6,c_pkey_4))) || (cert_req_6  true && c_pkey_4 = NoPubKey)))) && ((use_psk_s = true && psk_23 = psk'_1) || (use_psk_s  true && psk'_1 = NoPSK)) && ((send_kex_2 = true && first_sent = true) || (send_kex_2  true && first_sent  true && event(SanityClientCH(id_c,true,cr'_6,c_dom_6,s_dom_10,psk'',cur_log2_9)) && ((use_psk_c = true && event(GenPsk(c_dom_6,s_dom_10,psk''))) || (use_psk_c  true && psk'' = NoPSK)) && event(SanityClientHRR(id_c)) && event(SanityServerHRR(id_s,s_dom_10)))) is true.
352.639s (user 350.051s + system 2.588s), max rss 1225888K
END *)
!>)dnl
!>)dnl
ifdef(<!ech_C_tls_S!>,<!
ifdef(<!NOHRR!>,<!!>,<!
(* EXPECTPV FILENAME: ./sanity_checks.m4.pv TAG: 3
RESULT not (event(SanityClient(id_c,true,false,false,true)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,false,true)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,false,true)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,false,false)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,false,false)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,false,false)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,true,false)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,true,false)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,true,false)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,true,true)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,true,true)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,true,true)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT event(SanityClient(id_c,true,use_grease_1,use_psk_c,send_kex_2)) && event(SanityServer(id_s,use_ech_s,use_psk_s,cert_req_6)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) ==> event(SanityClientCH_ECH(id_c,first_sent',i_cr'_1,o_cr'_1,c_dom_6,o_dom_6,i_dom_2,psk'',o_cur_log',i_cur_log')) && ((is_backend_2 = true && use_ech_s = true && use_grease_1  true && i_cr'_1 = cr_12 && s_dom_11 = i_dom_2 && cur_log_11 = i_cur_log') || (is_backend_2  true && (use_ech_s  true || use_grease_1 = true) && o_cr'_1 = cr_12 && s_dom_11 = o_dom_6 && cur_log_11 = o_cur_log')) && ((use_psk_c = true && use_grease_1 = true && event(GenPsk(c_dom_6,o_dom_6,psk''))) || (use_psk_c = true && use_grease_1  true && event(GenPsk(c_dom_6,i_dom_2,psk''))) || (use_psk_c  true && psk'' = psk'_1 && psk'' = NoPSK)) && ((use_psk_c = true && use_psk_s = true && (use_ech_s = true || use_grease_1 = true) && s_pkey_6 = NoPubKey && c_pkey_4 = NoPubKey && psk'' = psk'_1) || ((use_psk_c  true || use_psk_s  true || (use_ech_s  true && use_grease_1  true)) && psk'_1 = NoPSK && event(GenCert(s_dom_11,s_pkey_6)) && ((cert_req_6 = true && event(GenCert(c_dom_6,c_pkey_4))) || (cert_req_6  true && c_pkey_4 = NoPubKey)))) && ((send_kex_2 = true && first_sent = true && first_sent = first_sent' && i_cr_3 = i_cr'_1 && o_cr_3 = o_cr'_1 && psk_25 = psk'' && o_cur_log_2 = o_cur_log' && i_cur_log_2 = i_cur_log') || (send_kex_2  true && event(SanityClientHRR(id_c)) && event(SanityServerHRR(id_s,s_dom_11)) && first_sent = true && first_sent'  true) || (first_sent  true && first_sent = first_sent' && i_cr_3 = i_cr'_1 && o_cr_3 = o_cr'_1 && psk_25 = psk'' && o_cur_log_2 = o_cur_log' && i_cur_log_2 = i_cur_log')) is true.
225.773s (user 224.545s + system 1.228s), max rss 822196K
END *)
!>)dnl
!>)dnl
ifdef(<!ech_C_ech_S!>,<!
ifdef(<!NOHRR!>,<!!>,<!
(* EXPECTPV FILENAME: ./sanity_checks.m4.pv TAG: 4
RESULT not (event(SanityClient(id_c,true,false,false,true)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,false,true)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,false,true)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,false,false)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,false,false)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,false,false)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,true,false)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,true,false)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,true,false)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,true,true)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,true,true)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,true,true)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT event(SanityClient(id_c,true,use_grease_1,use_psk_c,send_kex_2)) && event(SanityServer(id_s,use_ech_s,use_psk_s,cert_req_6)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) ==> event(SanityClientCH_ECH(id_c,first_sent',i_cr'_1,o_cr'_1,c_dom_6,o_dom_6,i_dom_2,psk'',o_cur_log',i_cur_log')) && ((is_backend_2 = true && use_ech_s = true && use_grease_1  true && i_cr'_1 = cr_12 && s_dom_11 = i_dom_2 && cur_log_11 = i_cur_log') || (is_backend_2  true && (use_ech_s  true || use_grease_1 = true) && o_cr'_1 = cr_12 && s_dom_11 = o_dom_6 && cur_log_11 = o_cur_log')) && ((use_psk_c = true && use_grease_1 = true && event(GenPsk(c_dom_6,o_dom_6,psk''))) || (use_psk_c = true && use_grease_1  true && event(GenPsk(c_dom_6,i_dom_2,psk''))) || (use_psk_c  true && psk'' = psk'_1 && psk'' = NoPSK)) && ((use_psk_c = true && use_psk_s = true && (use_ech_s = true || use_grease_1 = true) && s_pkey_6 = NoPubKey && c_pkey_4 = NoPubKey && psk'' = psk'_1) || ((use_psk_c  true || use_psk_s  true || (use_ech_s  true && use_grease_1  true)) && psk'_1 = NoPSK && event(GenCert(s_dom_11,s_pkey_6)) && ((cert_req_6 = true && event(GenCert(c_dom_6,c_pkey_4))) || (cert_req_6  true && c_pkey_4 = NoPubKey)))) && ((send_kex_2 = true && first_sent = true && first_sent = first_sent' && i_cr_3 = i_cr'_1 && o_cr_3 = o_cr'_1 && psk_25 = psk'' && o_cur_log_2 = o_cur_log' && i_cur_log_2 = i_cur_log') || (send_kex_2  true && event(SanityClientHRR(id_c)) && event(SanityServerHRR(id_s,s_dom_11)) && first_sent = true && first_sent'  true) || (first_sent  true && first_sent = first_sent' && i_cr_3 = i_cr'_1 && o_cr_3 = o_cr'_1 && psk_25 = psk'' && o_cur_log_2 = o_cur_log' && i_cur_log_2 = i_cur_log')) is true.
838.113s (user 833.033s + system 5.080s), max rss 3099360K
END *)
!>)dnl
!>)dnl
ifdef(<!grease_C_tls_S!>,<!
ifdef(<!NOHRR!>,<!!>,<!
(* EXPECTPV FILENAME: ./sanity_checks.m4.pv TAG: 5
RESULT not (event(SanityClient(id_c,true,true,false,true)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,false,true)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,false,true)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,false,false)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,false,false)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,false,false)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,true,false)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,true,false)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,true,false)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,true,true)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,true,true)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,true,true)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT event(SanityClient(id_c,true,use_grease_1,use_psk_c,send_kex_2)) && event(SanityServer(id_s,use_ech_s,use_psk_s,cert_req_6)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) ==> event(SanityClientCH_ECH(id_c,first_sent',i_cr'_1,o_cr'_1,c_dom_6,o_dom_6,i_dom_2,psk'',o_cur_log',i_cur_log')) && ((is_backend_2 = true && use_ech_s = true && use_grease_1  true && i_cr'_1 = cr_12 && s_dom_11 = i_dom_2 && cur_log_11 = i_cur_log') || (is_backend_2  true && (use_ech_s  true || use_grease_1 = true) && o_cr'_1 = cr_12 && s_dom_11 = o_dom_6 && cur_log_11 = o_cur_log')) && ((use_psk_c = true && use_grease_1 = true && event(GenPsk(c_dom_6,o_dom_6,psk''))) || (use_psk_c = true && use_grease_1  true && event(GenPsk(c_dom_6,i_dom_2,psk''))) || (use_psk_c  true && psk'' = psk'_1 && psk'' = NoPSK)) && ((use_psk_c = true && use_psk_s = true && (use_ech_s = true || use_grease_1 = true) && s_pkey_6 = NoPubKey && c_pkey_4 = NoPubKey && psk'' = psk'_1) || ((use_psk_c  true || use_psk_s  true || (use_ech_s  true && use_grease_1  true)) && psk'_1 = NoPSK && event(GenCert(s_dom_11,s_pkey_6)) && ((cert_req_6 = true && event(GenCert(c_dom_6,c_pkey_4))) || (cert_req_6  true && c_pkey_4 = NoPubKey)))) && ((send_kex_2 = true && first_sent = true && first_sent = first_sent' && i_cr_3 = i_cr'_1 && o_cr_3 = o_cr'_1 && psk_25 = psk'' && o_cur_log_2 = o_cur_log' && i_cur_log_2 = i_cur_log') || (send_kex_2  true && event(SanityClientHRR(id_c)) && event(SanityServerHRR(id_s,s_dom_11)) && first_sent = true && first_sent'  true) || (first_sent  true && first_sent = first_sent' && i_cr_3 = i_cr'_1 && o_cr_3 = o_cr'_1 && psk_25 = psk'' && o_cur_log_2 = o_cur_log' && i_cur_log_2 = i_cur_log')) is true.
94.410s (user 93.650s + system 0.760s), max rss 551860K
END *)
!>)dnl
!>)dnl
ifdef(<!grease_C_ech_S!>,<!
ifdef(<!NOHRR!>,<!!>,<!
(* EXPECTPV FILENAME: ./sanity_checks.m4.pv TAG: 6
RESULT not (event(SanityClient(id_c,true,true,false,true)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,false,true)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,false,true)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,false,false)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,false,false)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,false,false)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,true,false)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,true,false)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,true,false)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,true,true)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,true,true)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,true,true)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1))) is false.
RESULT event(SanityClient(id_c,true,use_grease_1,use_psk_c,send_kex_2)) && event(SanityServer(id_s,use_ech_s,use_psk_s,cert_req_6)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_3,o_cr_3,c_dom_6,o_dom_6,i_dom_2,psk_25,o_cur_log_2,i_cur_log_2)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_11,psk'_1,cur_log_11)) && event(SanityClientCFIN(id_c,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_11,psk'_1,master_secret_13,chk_10,shk_10,cfin_10,sfin_10,s_pkey_6,c_pkey_4,cak_2,sak_2,es_13,rms_2,cur_log1)) ==> event(SanityClientCH_ECH(id_c,first_sent',i_cr'_1,o_cr'_1,c_dom_6,o_dom_6,i_dom_2,psk'',o_cur_log',i_cur_log')) && ((is_backend_2 = true && use_ech_s = true && use_grease_1  true && i_cr'_1 = cr_12 && s_dom_11 = i_dom_2 && cur_log_11 = i_cur_log') || (is_backend_2  true && (use_ech_s  true || use_grease_1 = true) && o_cr'_1 = cr_12 && s_dom_11 = o_dom_6 && cur_log_11 = o_cur_log')) && ((use_psk_c = true && use_grease_1 = true && event(GenPsk(c_dom_6,o_dom_6,psk''))) || (use_psk_c = true && use_grease_1  true && event(GenPsk(c_dom_6,i_dom_2,psk''))) || (use_psk_c  true && psk'' = psk'_1 && psk'' = NoPSK)) && ((use_psk_c = true && use_psk_s = true && (use_ech_s = true || use_grease_1 = true) && s_pkey_6 = NoPubKey && c_pkey_4 = NoPubKey && psk'' = psk'_1) || ((use_psk_c  true || use_psk_s  true || (use_ech_s  true && use_grease_1  true)) && psk'_1 = NoPSK && event(GenCert(s_dom_11,s_pkey_6)) && ((cert_req_6 = true && event(GenCert(c_dom_6,c_pkey_4))) || (cert_req_6  true && c_pkey_4 = NoPubKey)))) && ((send_kex_2 = true && first_sent = true && first_sent = first_sent' && i_cr_3 = i_cr'_1 && o_cr_3 = o_cr'_1 && psk_25 = psk'' && o_cur_log_2 = o_cur_log' && i_cur_log_2 = i_cur_log') || (send_kex_2  true && event(SanityClientHRR(id_c)) && event(SanityServerHRR(id_s,s_dom_11)) && first_sent = true && first_sent'  true) || (first_sent  true && first_sent = first_sent' && i_cr_3 = i_cr'_1 && o_cr_3 = o_cr'_1 && psk_25 = psk'' && o_cur_log_2 = o_cur_log' && i_cur_log_2 = i_cur_log')) is true.
1102.119s (user 1095.147s + system 6.972s), max rss 3141780K
END *)
!>)dnl
!>)dnl
ifdef(<!tls_C_tls_S!>,<!
ifdef(<!NOHRR!>,<!
(* EXPECTPV FILENAME: ./sanity_checks.m4.pv TAG: 7
RESULT not (event(SanityClient(id_c,false,false,false,true)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,false,true)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,false,true)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,false,false)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,false,false,false,false)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,false,false,false,false)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,false,false,true,false)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,false,false,true,false)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,false,false,true,false)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,false,false,true,true)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,true,true)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,true,true)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is false.
RESULT event(SanityClient(id_c,false,false,use_psk_c,send_kex_1)) && event(SanityServer(id_s,use_ech_s,use_psk_s,cert_req_6)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) ==> is_backend_2  true && ((use_psk_c = true && event(GenPsk(c_dom_6,s_dom_10,psk_18))) || (use_psk_c  true && psk_18 = psk' && psk_18 = NoPSK)) && ((use_psk_c = true && use_psk_s = true && s_pkey_6 = NoPubKey && c_pkey_4 = NoPubKey) || ((use_psk_c  true || use_psk_s  true) && event(GenCert(s_dom_10,s_pkey_6)) && ((cert_req_6 = true && event(GenCert(c_dom_6,c_pkey_4))) || (cert_req_6  true && c_pkey_4 = NoPubKey)))) && ((use_psk_s = true && psk_18 = psk') || (use_psk_s  true && psk' = NoPSK)) && ((send_kex_1 = true && first_sent = true) || (send_kex_1  true && first_sent  true && event(SanityClientCH(id_c,true,cr'_1,c_dom_6,s_dom_10,psk'',cur_log2_7)) && ((use_psk_c = true && event(GenPsk(c_dom_6,s_dom_10,psk''))) || (use_psk_c  true && psk'' = NoPSK)) && event(SanityClientHRR(id_c)) && event(SanityServerHRR(id_s,s_dom_10)))) is true.
6.253s (user 6.185s + system 0.068s), max rss 121436K
END *)
!>)dnl
!>)dnl
ifdef(<!tls_C_ech_S!>,<!
ifdef(<!NOHRR!>,<!
(* EXPECTPV FILENAME: ./sanity_checks.m4.pv TAG: 8
RESULT not (event(SanityClient(id_c,false,false,false,true)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,false,true)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,false,true)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,false,false)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,false,false,false,false)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,false,false,false,false)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,false,false,true,false)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,false,false,true,false)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,false,false,true,false)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,false,false,true,true)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,true,true)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,false,false,true,true)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1))) is false.
RESULT event(SanityClient(id_c,false,false,use_psk_c,send_kex_1)) && event(SanityServer(id_s,use_ech_s,use_psk_s,cert_req_6)) && event(SanityClientCH(id_c,first_sent,cr_12,c_dom_6,s_dom_10,psk_18,cur_log_9)) && event(SanityServerCH(id_s,is_backend_2,cr_12,s_dom_10,psk',cur_log_9)) && event(SanityClientCFIN(id_c,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_12,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_7,rms_2,cur_log1)) ==> is_backend_2  true && ((use_psk_c = true && event(GenPsk(c_dom_6,s_dom_10,psk_18))) || (use_psk_c  true && psk_18 = psk' && psk_18 = NoPSK)) && ((use_psk_c = true && use_psk_s = true && s_pkey_6 = NoPubKey && c_pkey_4 = NoPubKey) || ((use_psk_c  true || use_psk_s  true) && event(GenCert(s_dom_10,s_pkey_6)) && ((cert_req_6 = true && event(GenCert(c_dom_6,c_pkey_4))) || (cert_req_6  true && c_pkey_4 = NoPubKey)))) && ((use_psk_s = true && psk_18 = psk') || (use_psk_s  true && psk' = NoPSK)) && ((send_kex_1 = true && first_sent = true) || (send_kex_1  true && first_sent  true && event(SanityClientCH(id_c,true,cr'_1,c_dom_6,s_dom_10,psk'',cur_log2_7)) && ((use_psk_c = true && event(GenPsk(c_dom_6,s_dom_10,psk''))) || (use_psk_c  true && psk'' = NoPSK)) && event(SanityClientHRR(id_c)) && event(SanityServerHRR(id_s,s_dom_10)))) is true.
105.089s (user 104.685s + system 0.404s), max rss 612684K
END *)
!>)dnl
!>)dnl
ifdef(<!ech_C_tls_S!>,<!
ifdef(<!NOHRR!>,<!
(* EXPECTPV FILENAME: ./sanity_checks.m4.pv TAG: 9
RESULT not (event(SanityClient(id_c,true,false,false,true)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,false,true)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,false,true)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,false,false)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,false,false,false)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,false,false,false)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,false,true,false)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,false,true,false)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,false,true,false)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,false,true,true)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,true,true)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,true,true)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT event(SanityClient(id_c,true,use_grease_1,use_psk_c,send_kex_1)) && event(SanityServer(id_s,use_ech_s,use_psk_s,cert_req_6)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) ==> event(SanityClientCH_ECH(id_c,first_sent',i_cr',o_cr',c_dom_6,o_dom_4,i_dom_1,psk'',o_cur_log',i_cur_log')) && ((is_backend_2 = true && use_ech_s = true && use_grease_1  true && i_cr' = cr_11 && s_dom_10 = i_dom_1 && cur_log_10 = i_cur_log') || (is_backend_2  true && (use_ech_s  true || use_grease_1 = true) && o_cr' = cr_11 && s_dom_10 = o_dom_4 && cur_log_10 = o_cur_log')) && ((use_psk_c = true && use_grease_1 = true && event(GenPsk(c_dom_6,o_dom_4,psk''))) || (use_psk_c = true && use_grease_1  true && event(GenPsk(c_dom_6,i_dom_1,psk''))) || (use_psk_c  true && psk'' = psk' && psk'' = NoPSK)) && ((use_psk_c = true && use_psk_s = true && (use_ech_s = true || use_grease_1 = true) && s_pkey_6 = NoPubKey && c_pkey_4 = NoPubKey && psk'' = psk') || ((use_psk_c  true || use_psk_s  true || (use_ech_s  true && use_grease_1  true)) && psk' = NoPSK && event(GenCert(s_dom_10,s_pkey_6)) && ((cert_req_6 = true && event(GenCert(c_dom_6,c_pkey_4))) || (cert_req_6  true && c_pkey_4 = NoPubKey)))) && ((send_kex_1 = true && first_sent = true && first_sent = first_sent' && i_cr_2 = i_cr' && o_cr_2 = o_cr' && psk_19 = psk'' && o_cur_log_1 = o_cur_log' && i_cur_log_1 = i_cur_log') || (send_kex_1  true && event(SanityClientHRR(id_c)) && event(SanityServerHRR(id_s,s_dom_10)) && first_sent = true && first_sent'  true) || (first_sent  true && first_sent = first_sent' && i_cr_2 = i_cr' && o_cr_2 = o_cr' && psk_19 = psk'' && o_cur_log_1 = o_cur_log' && i_cur_log_1 = i_cur_log')) is true.
40.884s (user 40.616s + system 0.268s), max rss 279660K
END *)
!>)dnl
!>)dnl
ifdef(<!ech_C_ech_S!>,<!
ifdef(<!NOHRR!>,<!
(* EXPECTPV FILENAME: ./sanity_checks.m4.pv TAG: 10
RESULT not (event(SanityClient(id_c,true,false,false,true)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,false,true)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,false,true)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,false,false)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,false,false,false)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,false,false,false)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,false,true,false)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,false,true,false)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,false,true,false)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,false,true,true)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,true,true)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,false,true,true)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT event(SanityClient(id_c,true,use_grease_1,use_psk_c,send_kex_1)) && event(SanityServer(id_s,use_ech_s,use_psk_s,cert_req_6)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) ==> event(SanityClientCH_ECH(id_c,first_sent',i_cr',o_cr',c_dom_6,o_dom_4,i_dom_1,psk'',o_cur_log',i_cur_log')) && ((is_backend_2 = true && use_ech_s = true && use_grease_1  true && i_cr' = cr_11 && s_dom_10 = i_dom_1 && cur_log_10 = i_cur_log') || (is_backend_2  true && (use_ech_s  true || use_grease_1 = true) && o_cr' = cr_11 && s_dom_10 = o_dom_4 && cur_log_10 = o_cur_log')) && ((use_psk_c = true && use_grease_1 = true && event(GenPsk(c_dom_6,o_dom_4,psk''))) || (use_psk_c = true && use_grease_1  true && event(GenPsk(c_dom_6,i_dom_1,psk''))) || (use_psk_c  true && psk'' = psk' && psk'' = NoPSK)) && ((use_psk_c = true && use_psk_s = true && (use_ech_s = true || use_grease_1 = true) && s_pkey_6 = NoPubKey && c_pkey_4 = NoPubKey && psk'' = psk') || ((use_psk_c  true || use_psk_s  true || (use_ech_s  true && use_grease_1  true)) && psk' = NoPSK && event(GenCert(s_dom_10,s_pkey_6)) && ((cert_req_6 = true && event(GenCert(c_dom_6,c_pkey_4))) || (cert_req_6  true && c_pkey_4 = NoPubKey)))) && ((send_kex_1 = true && first_sent = true && first_sent = first_sent' && i_cr_2 = i_cr' && o_cr_2 = o_cr' && psk_19 = psk'' && o_cur_log_1 = o_cur_log' && i_cur_log_1 = i_cur_log') || (send_kex_1  true && event(SanityClientHRR(id_c)) && event(SanityServerHRR(id_s,s_dom_10)) && first_sent = true && first_sent'  true) || (first_sent  true && first_sent = first_sent' && i_cr_2 = i_cr' && o_cr_2 = o_cr' && psk_19 = psk'' && o_cur_log_1 = o_cur_log' && i_cur_log_1 = i_cur_log')) is true.
145.903s (user 144.887s + system 1.016s), max rss 692540K
END *)
!>)dnl
!>)dnl
ifdef(<!grease_C_tls_S!>,<!
ifdef(<!NOHRR!>,<!
(* EXPECTPV FILENAME: ./sanity_checks.m4.pv TAG: 11
RESULT not (event(SanityClient(id_c,true,true,false,true)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,false,true)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,false,true)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,false,false)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,true,false,false)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,true,false,false)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,true,true,false)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,true,true,false)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,true,true,false)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,true,true,true)) && event(SanityServer(id_s,false,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,true,true)) && event(SanityServer(id_s,false,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,true,true)) && event(SanityServer(id_s,false,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT event(SanityClient(id_c,true,use_grease_1,use_psk_c,send_kex_1)) && event(SanityServer(id_s,use_ech_s,use_psk_s,cert_req_6)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) ==> event(SanityClientCH_ECH(id_c,first_sent',i_cr',o_cr',c_dom_6,o_dom_4,i_dom_1,psk'',o_cur_log',i_cur_log')) && ((is_backend_2 = true && use_ech_s = true && use_grease_1  true && i_cr' = cr_11 && s_dom_10 = i_dom_1 && cur_log_10 = i_cur_log') || (is_backend_2  true && (use_ech_s  true || use_grease_1 = true) && o_cr' = cr_11 && s_dom_10 = o_dom_4 && cur_log_10 = o_cur_log')) && ((use_psk_c = true && use_grease_1 = true && event(GenPsk(c_dom_6,o_dom_4,psk''))) || (use_psk_c = true && use_grease_1  true && event(GenPsk(c_dom_6,i_dom_1,psk''))) || (use_psk_c  true && psk'' = psk' && psk'' = NoPSK)) && ((use_psk_c = true && use_psk_s = true && (use_ech_s = true || use_grease_1 = true) && s_pkey_6 = NoPubKey && c_pkey_4 = NoPubKey && psk'' = psk') || ((use_psk_c  true || use_psk_s  true || (use_ech_s  true && use_grease_1  true)) && psk' = NoPSK && event(GenCert(s_dom_10,s_pkey_6)) && ((cert_req_6 = true && event(GenCert(c_dom_6,c_pkey_4))) || (cert_req_6  true && c_pkey_4 = NoPubKey)))) && ((send_kex_1 = true && first_sent = true && first_sent = first_sent' && i_cr_2 = i_cr' && o_cr_2 = o_cr' && psk_19 = psk'' && o_cur_log_1 = o_cur_log' && i_cur_log_1 = i_cur_log') || (send_kex_1  true && event(SanityClientHRR(id_c)) && event(SanityServerHRR(id_s,s_dom_10)) && first_sent = true && first_sent'  true) || (first_sent  true && first_sent = first_sent' && i_cr_2 = i_cr' && o_cr_2 = o_cr' && psk_19 = psk'' && o_cur_log_1 = o_cur_log' && i_cur_log_1 = i_cur_log')) is true.
15.010s (user 14.866s + system 0.144s), max rss 213236K
END *)
!>)dnl
!>)dnl
ifdef(<!grease_C_ech_S!>,<!
ifdef(<!NOHRR!>,<!
(* EXPECTPV FILENAME: ./sanity_checks.m4.pv TAG: 12
RESULT not (event(SanityClient(id_c,true,true,false,true)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,false,true)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,false,true)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,false,false)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,true,false,false)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,true,false,false)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,true,true,false)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,true,true,false)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,true,true,false)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is true.
RESULT not (event(SanityClient(id_c,true,true,true,true)) && event(SanityServer(id_s,true,true,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,true,true)) && event(SanityServer(id_s,true,false,true)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT not (event(SanityClient(id_c,true,true,true,true)) && event(SanityServer(id_s,true,false,false)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1))) is false.
RESULT event(SanityClient(id_c,true,use_grease_1,use_psk_c,send_kex_1)) && event(SanityServer(id_s,use_ech_s,use_psk_s,cert_req_6)) && event(SanityClientCH_ECH(id_c,first_sent,i_cr_2,o_cr_2,c_dom_6,o_dom_4,i_dom_1,psk_19,o_cur_log_1,i_cur_log_1)) && event(SanityServerCH(id_s,is_backend_2,cr_11,s_dom_10,psk',cur_log_10)) && event(SanityClientCFIN(id_c,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) && event(SanityServerCFIN(id_s,cr_11,sr_10,psk',master_secret_11,chk_9,shk_9,cfin_9,sfin_9,s_pkey_6,c_pkey_4,cak_2,sak_2,es_8,rms_2,cur_log1)) ==> event(SanityClientCH_ECH(id_c,first_sent',i_cr',o_cr',c_dom_6,o_dom_4,i_dom_1,psk'',o_cur_log',i_cur_log')) && ((is_backend_2 = true && use_ech_s = true && use_grease_1  true && i_cr' = cr_11 && s_dom_10 = i_dom_1 && cur_log_10 = i_cur_log') || (is_backend_2  true && (use_ech_s  true || use_grease_1 = true) && o_cr' = cr_11 && s_dom_10 = o_dom_4 && cur_log_10 = o_cur_log')) && ((use_psk_c = true && use_grease_1 = true && event(GenPsk(c_dom_6,o_dom_4,psk''))) || (use_psk_c = true && use_grease_1  true && event(GenPsk(c_dom_6,i_dom_1,psk''))) || (use_psk_c  true && psk'' = psk' && psk'' = NoPSK)) && ((use_psk_c = true && use_psk_s = true && (use_ech_s = true || use_grease_1 = true) && s_pkey_6 = NoPubKey && c_pkey_4 = NoPubKey && psk'' = psk') || ((use_psk_c  true || use_psk_s  true || (use_ech_s  true && use_grease_1  true)) && psk' = NoPSK && event(GenCert(s_dom_10,s_pkey_6)) && ((cert_req_6 = true && event(GenCert(c_dom_6,c_pkey_4))) || (cert_req_6  true && c_pkey_4 = NoPubKey)))) && ((send_kex_1 = true && first_sent = true && first_sent = first_sent' && i_cr_2 = i_cr' && o_cr_2 = o_cr' && psk_19 = psk'' && o_cur_log_1 = o_cur_log' && i_cur_log_1 = i_cur_log') || (send_kex_1  true && event(SanityClientHRR(id_c)) && event(SanityServerHRR(id_s,s_dom_10)) && first_sent = true && first_sent'  true) || (first_sent  true && first_sent = first_sent' && i_cr_2 = i_cr' && o_cr_2 = o_cr' && psk_19 = psk'' && o_cur_log_1 = o_cur_log' && i_cur_log_1 = i_cur_log')) is true.
213.499s (user 212.639s + system 0.860s), max rss 831720K
END *)
!>)dnl
!>)dnl
